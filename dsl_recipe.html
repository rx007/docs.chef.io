<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    
    <title>About the Recipe DSL &mdash; Chef Docs</title>
    <link rel="stylesheet" href="_static/chefv2.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
    URL_ROOT:    './',
    VERSION:     '',
    COLLAPSE_INDEX: false,
    FILE_SUFFIX: '.html',
    HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="_static/jquery.js"></script>
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/script.js"></script>

    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="next" title="Authentication for Elasticsearch and Kibana" href="elasticsearch_and_kibana_auth.html" />
    <link rel="prev" title="About the Handler DSL" href="dsl_handler.html" /> 
  </head>
  <body role="document">
    <div class="body-wrap">

  <nav class="nav-main" role="navigation" data-topbar>
    <div class="nav-inner">
      <div class="left">
        <h1>
          <a href="https://learn.chef.io">
            <span>Learn Chef</span>
          </a>
        </h1>
      </div>

      <i id="nav-icon" class="fa fa-bars"></i>
      <a href="https://www.chef.io/">
        <img id="logo" src="_static/chef_logo_v2.svg" onerror="_static/chef_logo_v2.png"/>
      </a>

      <ul class="nav-links links-main">
        <li class="nav-link">
          <a href="https://learn.chef.io/tutorials">Tutorials</a>
        </li>
        <li class="nav-link">
          <a href="https://learn.chef.io/skills/">Skills Library</a>
        </li>
        <li class="nav-link is-active">
          <a href="https://docs.chef.io/">Docs</a>
        </li>
        <li class="nav-link">
          <a href="https://www.chef.io/training/">Training</a>
        </li>
      </ul>
    </div>
  </nav>





    <div class="document chef-docs">
    <nav class="nav-docs">
  <ul class="nav-docs-items" id="nav-docs-list">
    <li class="main-item dark-item docs-search">
      <form action="/search.html" method="get">
        <input type="text" placeholder="Search" id="docs-search" name="q">
        <input type="submit" class="submit-button" value="">
        <i class="fa fa-search icon-search"></i>
      </form>
   

    </li>
    
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Overview"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-home icon-left"></i> Overview <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/platform_overview.html" title="Platform Overview">
            Platform Overview
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Community">
            Community
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/community.html" title="About the Community">
                About the Community
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/community_contributions.html" title="Contributing">
                Contributing
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/community_guidelines.html" title="Guidelines">
                Guidelines
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/style_guide.html" title="Docs Style Guide">
                Docs Style Guide
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Packages &amp; Platforms">
            Packages &amp; Platforms
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/packages.html" title="Packages">
                Packages
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/platforms.html" title="Platforms">
                Platforms
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_omnitruck.html" title="Omnitruck API">
                Omnitruck API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_license.html" title="Licensing">
                Licensing
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Chef"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-tasks icon-left"></i> Chef <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items">

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Getting Started">
            Getting Started
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_overview.html" title="Chef Overview">
                Chef Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/quick_start.html" title="Quick Start">
                Quick Start
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_system_requirements.html" title="System Requirements">
                System Requirements
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Release Notes">
                Release Notes
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/release_notes.html" title="Chef Client">
                    Chef Client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_chefdk.html" title="Chef Development Kit">
                    Chef Development Kit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_server.html" title="Chef Server">
                    Chef Server
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_push_jobs.html" title="Chef Push Jobs">
                    Chef Push Jobs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_ohai.html" title="Ohai">
                    Ohai
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_deprecations_client.html" title="Deprecations">
                Deprecations
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Tutorials">
            Tutorials
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/learn-the-basics/" title="Learn the Basics">
                Learn the Basics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/manage-a-node/" title="Manage a Node">
                Manage a Node
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/local-development/" title="Get started with Test Kitchen">
                Get started with Test Kitchen
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/manage-a-web-app/" title="Develop a web app cookbook">
                Develop a web app cookbook
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/inspec/" title="Verify with InSpec">
                Verify with InSpec
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/chefspec/" title="Unit test with ChefSpec">
                Unit test with ChefSpec
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/verify-style/" title="Verify code style">
                Verify code style
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/refactor-web-app-cookbook/" title="Refactor the web app cookbook">
                Refactor the web app cookbook
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Concepts">
            Concepts
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/workstation.html" title="Workstation">
                Workstation
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_repo.html" title="chef-repo">
                chef-repo
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/nodes.html" title="Nodes">
                Nodes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_client.html" title="chef-client">
                chef-client
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_components.html" title="Server">
                Server
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_search.html" title="Search">
                Search
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbooks.html" title="Cookbooks">
                Cookbooks
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/handlers.html" title="Handlers">
                Handlers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/manage.html" title="Management Console">
                Management Console
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Policy">
                Policy
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/policy.html" title="About Policy">
                    About Policy
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/data_bags.html" title="Data Bags">
                    Data Bags
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/environments.html" title="Environments">
                    Environments
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/roles.html" title="Roles">
                    Roles
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/push_jobs.html" title="Push Jobs">
                Push Jobs
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/run_lists.html" title="Run-lists">
                Run-lists
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Security">
                Security
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/auth.html#authentication" title="Authentication">
                    Authentication
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/auth.html#authorization" title="Authorization">
                    Authorization
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/chef_private_keys.html" title="Private Keys">
                    Private Keys
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef_client.html#run-in-fips-mode" title="FIPS-mode">
                    FIPS-mode
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Supermarket">
                Supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/supermarket.html#public-supermarket" title="Public Supermarket">
                    Public Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/supermarket.html#private-supermarket" title="Private Supermarket">
                    Private Supermarket
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/windows.html" title="Microsoft Windows">
                Microsoft Windows
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Appendix">
                Appendix
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/environment_variables.html" title="Env Variables">
                    Env Variables
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/errors.html" title="Troubleshooting">
                    Troubleshooting
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/glossary.html" title="Glossary">
                    Glossary
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Setup">
            Setup
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/proxies.html" title="Proxies">
                Proxies
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_dk.html" title="Workstation">
                Workstation
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Nodes">
                Nodes
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/install_bootstrap.html" title="Install via Bootstrap">
                    Install via Bootstrap
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_omnibus.html" title="Install via URL">
                    Install via URL
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_windows.html" title="Install on Windows">
                    Install on Windows
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/junos.html" title="Install on Junos OS">
                    Install on Junos OS
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef_client.html" title="chef-client (executable)">
                    chef-client (executable)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_client.html" title="client.rb">
                    client.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/upgrade_client.html" title="Upgrades">
                    Upgrades
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/chef_client_security.html" title="Security">
                    Security
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Server">
                Server
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="https://manage.chef.io/signup" title="Hosted Chef Server">
                    Hosted Chef Server
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_server.html#standalone" title="Install Standalone">
                    Install Standalone
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_server_ha.html" title="Install High Availability">
                    Install High Availability
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/aws_marketplace.html" title="AWS Marketplace">
                    AWS Marketplace
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/azure_portal.html" title="Microsoft Azure">
                    Microsoft Azure
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/openstack.html" title="Openstack">
                    Openstack
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Supermarket">
                Supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="https://supermarket.chef.io" title="Public Supermarket">
                    Public Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_supermarket.html" title="Install Private Supermarket">
                    Install Private Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_supermarket.html#customize-supermarket" title="Customize Supermarket">
                    Customize Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_supermarket.html#run-supermarket-in-kitchen" title="Run in Test Kitchen">
                    Run in Test Kitchen
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_server.html#install" title="Management Console">
                Management Console
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_push_jobs.html" title="Push Jobs">
                Push Jobs
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Integrations">
                Integrations
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/integrate_compliance_chef_server.html" title="w/Chef Compliance">
                    w/Chef Compliance
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/uninstall.html" title="Uninstall">
                Uninstall
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Cookbook Reference">
            Cookbook Reference
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbooks.html" title="About Cookbooks">
                About Cookbooks
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/attributes.html" title="Attributes">
                Attributes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/definitions.html" title="Definitions">
                Definitions
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/files.html" title="Files">
                Files
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/libraries.html" title="Libraries">
                Libraries
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Recipes">
                Recipes
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/recipes.html" title="About Recipes">
                    About Recipes
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/debug.html" title="Debug Recipes, Client Runs">
                    Debug Recipes, Client Runs
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Recipe DSL">
                Recipe DSL
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#attribute" title="attribute?">
                    attribute?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#control" title="control">
                    control
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#control-group" title="control_group">
                    control_group
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#cookbook-name" title="cookbook_name">
                    cookbook_name
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#data-bag" title="data_bag">
                    data_bag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#data-bag-item" title="data_bag_item">
                    data_bag_item
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#platform" title="platform?">
                    platform?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#platform-family" title="platform_family?">
                    platform_family?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#reboot-pending" title="reboot_pending?">
                    reboot_pending?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#recipe-name" title="recipe_name">
                    recipe_name
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-data-exists" title="registry_data_exists?">
                    registry_data_exists?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-get-subkeys" title="registry_get_subkeys">
                    registry_get_subkeys
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-get-values" title="registry_get_values">
                    registry_get_values
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-has-subkeys" title="registry_has_subkeys?">
                    registry_has_subkeys?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-key-exists" title="registry_key_exists?">
                    registry_key_exists?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-value-exists" title="registry_value_exists?">
                    registry_value_exists?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#resources" title="resources">
                    resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#search" title="search">
                    search
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#shell-out" title="shell_out">
                    shell_out
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#shell-out-bang" title="shell_out!">
                    shell_out!
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#shell-out-with-systems-locale" title="shell_out_with_systems_locale">
                    shell_out_with_systems_locale
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#tag-tagged-untag" title="tag">
                    tag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#tag-tagged-untag" title="tagged?">
                    tagged?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#tag-tagged-untag" title="untag">
                    untag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#value-for-platform" title="value_for_platform">
                    value_for_platform
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#value-for-platform-family" title="value_for_platform_family">
                    value_for_platform_family
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#helpers" title="Windows Platform Helpers">
                    Windows Platform Helpers
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Resources">
                Resources
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/resource.html" title="About Resources">
                    About Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_common.html" title="Common Functionality">
                    Common Functionality
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/custom_resources.html" title="Custom Resources">
                    Custom Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resources.html" title="All Resources (Single Page)">
                    All Resources (Single Page)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_apt_package.html" title="apt_package">
                    apt_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_apt_repository.html" title="apt_repository">
                    apt_repository
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_apt_update.html" title="apt_update">
                    apt_update
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_bash.html" title="bash">
                    bash
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_batch.html" title="batch">
                    batch
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_bff_package.html" title="bff_package">
                    bff_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_breakpoint.html" title="breakpoint">
                    breakpoint
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_cab_package.html" title="cab_package">
                    cab_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_gem.html" title="chef_gem">
                    chef_gem
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_acl.html" title="chef_acl">
                    chef_acl
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_client.html" title="chef_client">
                    chef_client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_container.html" title="chef_container">
                    chef_container
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_data_bag_item.html" title="chef_data_bag_item">
                    chef_data_bag_item
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_data_bag.html" title="chef_data_bag">
                    chef_data_bag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_environment.html" title="chef_environment">
                    chef_environment
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_group.html" title="chef_group">
                    chef_group
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_handler.html" title="chef_handler">
                    chef_handler
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_mirror.html" title="chef_mirror">
                    chef_mirror
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_node.html" title="chef_node">
                    chef_node
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_organization.html" title="chef_organization">
                    chef_organization
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_role.html" title="chef_role">
                    chef_role
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_user.html" title="chef_user">
                    chef_user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chocolatey_package.html" title="chocolatey_package">
                    chocolatey_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_cookbook_file.html" title="cookbook_file">
                    cookbook_file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_cron.html" title="cron">
                    cron
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_csh.html" title="csh">
                    csh
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_deploy.html" title="deploy">
                    deploy
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_directory.html" title="directory">
                    directory
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_dpkg_package.html" title="dpkg_package">
                    dpkg_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_dsc_resource.html" title="dsc_resource">
                    dsc_resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_dsc_script.html" title="dsc_script">
                    dsc_script
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_easy_install_package.html" title="easy_install_package">
                    easy_install_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_env.html" title="env">
                    env
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_erlang_call.html" title="erl_call">
                    erl_call
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_execute.html" title="execute">
                    execute
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_file.html" title="file">
                    file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_freebsd_package.html" title="freebsd_package">
                    freebsd_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_gem_package.html" title="gem_package">
                    gem_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_git.html" title="git">
                    git
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_group.html" title="group">
                    group
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_homebrew_package.html" title="homebrew_package">
                    homebrew_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_http_request.html" title="http_request">
                    http_request
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ifconfig.html" title="ifconfig">
                    ifconfig
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ips_package.html" title="ips_package">
                    ips_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ksh.html" title="ksh">
                    ksh
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_launchd.html" title="launchd">
                    launchd
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_link.html" title="link">
                    link
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_log.html" title="log">
                    log
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_macports_package.html" title="macports_package">
                    macports_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_mdadm.html" title="mdadm">
                    mdadm
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_mount.html" title="mount">
                    mount
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_msu_package.html" title="msu_package">
                    msu_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ohai.html" title="ohai">
                    ohai
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_openbsd_package.html" title="openbsd_package">
                    openbsd_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_osx_profile.html" title="osx_profile">
                    osx_profile
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_package.html" title="package">
                    package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_pacman_package.html" title="pacman_package">
                    pacman_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_paludis_package.html" title="paludis_package">
                    paludis_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_perl.html" title="perl">
                    perl
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_portage_package.html" title="portage_package">
                    portage_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_powershell_script.html" title="powershell_script">
                    powershell_script
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_private_key.html" title="private_key">
                    private_key
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_public_key.html" title="public_key">
                    public_key
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_python.html" title="python">
                    python
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_reboot.html" title="reboot">
                    reboot
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_registry_key.html" title="registry_key">
                    registry_key
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_remote_directory.html" title="remote_directory">
                    remote_directory
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_remote_file.html" title="remote_file">
                    remote_file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_route.html" title="route">
                    route
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_rpm_package.html" title="rpm_package">
                    rpm_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ruby.html" title="ruby">
                    ruby
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ruby_block.html" title="ruby_block">
                    ruby_block
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_script.html" title="script">
                    script
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_service.html" title="service">
                    service
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_smartos_package.html" title="smartos_package">
                    smartos_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_solaris_package.html" title="solaris_package">
                    solaris_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_subversion.html" title="subversion">
                    subversion
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_systemd_unit.html" title="systemd_unit">
                    systemd_unit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_template.html" title="template">
                    template
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_user.html" title="user">
                    user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_windows_package.html" title="windows_package">
                    windows_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_windows_service.html" title="windows_service">
                    windows_service
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_yum.html" title="yum_package">
                    yum_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_yum_repository.html" title="yum_repository">
                    yum_repository
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_examples.html" title="Examples (by Resource)">
                    Examples (by Resource)
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/templates.html" title="Templates">
                Templates
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbook_repo.html" title="Cookbook Repo">
                Cookbook Repo
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_metadata.html" title="metadata.rb">
                metadata.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbook_versions.html" title="Cookbook Versions">
                Cookbook Versions
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ruby.html" title="Ruby">
                Ruby
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Chef DK">
            Chef DK
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/about_chefdk.html" title="About the ChefDK">
                About the ChefDK
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/berkshelf.html" title="Berkshelf">
                Berkshelf
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_apply.html" title="chef-apply (executable)">
                chef-apply (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_shell.html" title="chef-shell (executable)">
                chef-shell (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="chef (executable)">
                chef (executable)
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-env" title="chef env">
                    chef env
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-exec" title="chef exec">
                    chef exec
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-gem" title="chef gem">
                    chef gem
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-app" title="chef generate app">
                    chef generate app
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-attribute" title="chef generate attribute">
                    chef generate attribute
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-cookbook" title="chef generate cookbook">
                    chef generate cookbook
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-file" title="chef generate file">
                    chef generate file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-lwrp" title="chef generate lwrp">
                    chef generate lwrp
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-recipe" title="chef generate recipe">
                    chef generate recipe
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-repo" title="chef generate repo">
                    chef generate repo
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-template" title="chef generate template">
                    chef generate template
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-provision" title="chef provision">
                    chef provision
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-shell-init" title="chef shell-init">
                    chef shell-init
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-verify" title="chef verify">
                    chef verify
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Chef Solo">
                Chef Solo
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/chef_solo.html" title="About Chef Solo">
                    About Chef Solo
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef_solo.html" title="chef-solo (executable)">
                    chef-solo (executable)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_solo.html" title="solo.rb">
                    solo.rb
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_shell.html" title="chef-shell (executable)">
                chef-shell (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_client.html#run-in-local-mode" title="chef-zero (local mode)">
                chef-zero (local mode)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_vault.html" title="chef-vault">
                chef-vault
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chefspec.html" title="ChefSpec">
                ChefSpec
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Configuration">
                Configuration
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/config_rb.html" title="config.rb">
                    config.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_client.html#d-directories" title="Multiple Config Files">
                    Multiple Config Files
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookstyle.html" title="cookstyle">
                cookstyle
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_delivery.html" title="Delivery CLI">
                Delivery CLI
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/foodcritic.html" title="Foodcritic">
                Foodcritic
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Test Kitchen">
                Test Kitchen
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/kitchen.html" title="About Test Kitchen">
                    About Test Kitchen
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_kitchen.html" title="kitchen (executable)">
                    kitchen (executable)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_yml_kitchen.html" title=".kitchen.yml">
                    .kitchen.yml
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_kitchen_vagrant.html" title="kitchen-vagrant">
                    kitchen-vagrant
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Knife">
                Knife
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/knife.html" title="About Knife">
                    About Knife
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_common_options.html" title="Common Options">
                    Common Options
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_using.html" title="Using Knife">
                    Using Knife
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_knife.html" title="knife.rb">
                    knife.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_bootstrap.html" title="knife bootstrap">
                    knife bootstrap
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_client.html" title="knife client">
                    knife client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_configure.html" title="knife configure">
                    knife configure
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_cookbook.html" title="knife cookbook">
                    knife cookbook
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_cookbook_site.html" title="knife cookbook site">
                    knife cookbook site
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_data_bag.html" title="knife data bag">
                    knife data bag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_delete.html" title="knife delete">
                    knife delete
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_deps.html" title="knife deps">
                    knife deps
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_diff.html" title="knife diff">
                    knife diff
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_download.html" title="knife download">
                    knife download
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_edit.html" title="knife edit">
                    knife edit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_environment.html" title="knife environment">
                    knife environment
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_exec.html" title="knife exec">
                    knife exec
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_list.html" title="knife list">
                    knife list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_node.html" title="knife node">
                    knife node
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_raw.html" title="knife raw">
                    knife raw
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_recipe_list.html" title="knife recipe list">
                    knife recipe list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_role.html" title="knife role">
                    knife role
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_search.html" title="knife search">
                    knife search
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_serve.html" title="knife serve">
                    knife serve
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_show.html" title="knife show">
                    knife show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_ssh.html" title="knife ssh">
                    knife ssh
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_ssl_check.html" title="knife ssl_check">
                    knife ssl_check
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_ssl_fetch.html" title="knife ssl_fetch">
                    knife ssl_fetch
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_status.html" title="knife status">
                    knife status
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_tag.html" title="knife tag">
                    knife tag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_upload.html" title="knife upload">
                    knife upload
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_user.html" title="knife user">
                    knife user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_xargs.html" title="knife xargs">
                    knife xargs
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="knife opc">
                knife opc
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html" title="About knife opc">
                    About knife opc
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#knife-rb-configuration" title="knife.rb Configuration">
                    knife.rb Configuration
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-list" title="opc user list">
                    opc user list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-show" title="opc user show">
                    opc user show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-create" title="opc user create">
                    opc user create
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-delete" title="opc user delete">
                    opc user delete
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-edit" title="opc user edit">
                    opc user edit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-password" title="opc user password">
                    opc user password
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-list" title="opc org list">
                    opc org list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-show" title="opc org show">
                    opc org show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-create" title="opc org create">
                    opc org create
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-delete" title="opc org delete">
                    opc org delete
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-user-add" title="opc org user add">
                    opc org user add
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-user-remove" title="opc org user remove">
                    opc org user remove
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_spork.html" title="knife spork">
                knife spork
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="knife supermarket">
                knife supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html" title="About knife supermarket">
                    About knife supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#download" title="supermarket download">
                    supermarket download
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#install" title="supermarket install">
                    supermarket install
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#list" title="supermarket list">
                    supermarket list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#search" title="supermarket search">
                    supermarket search
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#share" title="supermarket share">
                    supermarket share
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#show" title="supermarket show">
                    supermarket show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#unshare" title="supermarket unshare">
                    supermarket unshare
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Ohai">
                Ohai
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/ohai.html" title="About Ohai">
                    About Ohai
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_ohai.html" title="ohai (executable)">
                    ohai (executable)
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Policyfile">
                Policyfile
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/policyfile.html" title="About Policyfile">
                    About Policyfile
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_policyfile.html" title="Policyfile.rb">
                    Policyfile.rb
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Provisioning">
                Provisioning
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/provisioning.html" title="About Provisioning">
                    About Provisioning
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_load_balancer.html" title="load_balancer resource">
                    load_balancer resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine.html" title="machine resource">
                    machine resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_batch.html" title="machine_batch resource">
                    machine_batch resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_execute.html" title="machine_execute resource">
                    machine_execute resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_file.html" title="machine_file resource">
                    machine_file resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_image.html" title="machine_image resource">
                    machine_image resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/provisioning_aws.html" title="AWS Driver Resources">
                    AWS Driver Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/provisioning_fog.html" title="Fog Driver Resources">
                    Fog Driver Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/provisioning_vagrant.html" title="Vagrant Driver Resources">
                    Vagrant Driver Resources
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_push_jobs_client.html" title="push-jobs-client (executable)">
                push-jobs-client (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/rubocop.html" title="Rubocop">
                Rubocop
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Managing the Server">
            Managing the Server
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/runbook.html" title="Runbook (Single Page)">
                Runbook (Single Page)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_backup_restore.html" title="Backup &amp; Restore">
                Backup &amp; Restore
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_data.html" title="Data Storage">
                Data Storage
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_firewalls_and_ports.html" title="Firewalls &amp; Ports">
                Firewalls &amp; Ports
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_ldap.html" title="Active Directory &amp; LDAP">
                Active Directory &amp; LDAP
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_logs.html" title="Log Files">
                Log Files
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_monitor.html" title="Monitor">
                Monitor
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_orgs.html" title="Organizations &amp; Groups">
                Organizations &amp; Groups
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/secrets.html" title="Secrets">
                Secrets
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_security.html" title="Security">
                Security
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_services.html" title="Services">
                Services
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_tuning.html" title="Tuning">
                Tuning
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_server.html" title="Upgrades">
                Upgrades
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_server_ha_v2.html" title="Upgrade HA Cluster">
                Upgrade HA Cluster
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_users.html" title="Users">
                Users
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_server.html" title="chef-server-ctl">
                chef-server-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_backend.html" title="chef-backend-ctl">
                chef-backend-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_server.html" title="chef-server.rb">
                chef-server.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_opscode_expander.html" title="opscode-expander-ctl">
                opscode-expander-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_chef_server.html" title="Chef Server API">
                Chef Server API
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Push Jobs">
                Push Jobs
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_push_jobs.html" title="knife push jobs">
                    knife push jobs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_push_jobs_client.html" title="push-jobs-client">
                    push-jobs-client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_push_jobs_client.html" title="push-jobs-client.rb">
                    push-jobs-client.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_push_jobs_server.html" title="push-jobs-server.rb">
                    push-jobs-server.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/api_push_jobs.html" title="Push Jobs API">
                    Push Jobs API
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_sent_events.html" title="Server Sent Events">
                    Server Sent Events
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Supermarket">
                Supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/supermarket_logs.html" title="Log Files">
                    Log Files
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/supermarket_monitor.html" title="Monitoring">
                    Monitoring
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_supermarket.html" title="supermarket.rb">
                    supermarket.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html" title="knife supermarket">
                    knife supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_supermarket.html" title="supermarket-ctl">
                    supermarket-ctl
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/supermarket_api.html" title="Supermarket API">
                    Supermarket API
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Management Console">
                Management Console
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/server_configure_saml.html" title="Configure SAML">
                    Configure SAML
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_clients.html" title="Clients">
                    Clients
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_cookbooks.html" title="Cookbooks">
                    Cookbooks
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_data_bags.html" title="Data Bags">
                    Data Bags
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_environments.html" title="Environments">
                    Environments
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_nodes.html" title="Nodes">
                    Nodes
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_roles.html" title="Roles">
                    Roles
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_users.html#chef-manage" title="Users">
                    Users
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_manage.html" title="manage.rb">
                    manage.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_manage.html" title="chef-manage-ctl">
                    chef-manage-ctl
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Habitat"> <!-- if item has custom image -->

        <img class="icon-left" src="./_static/habitat-mark.png"></img> Habitat <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/habitat.html" title="Habitat Overview">
            Habitat Overview
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Tutorials">
            Tutorials
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://www.habitat.sh/tutorials/getting-started-overview" title="Getting started">
                Getting started
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="InSpec"> <!-- if item has custom image -->

        <img class="icon-left" src="./_static/inspec_logo.png"></img> InSpec <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/inspec.html" title="InSpec Overview">
            InSpec Overview
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Chef Automate"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-cogs icon-left"></i> Chef Automate <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items">

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Getting Started">
            Getting Started
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_automate.html" title="Chef Automate Overview">
                Chef Automate Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_chef_automate.html" title="Installation Guide">
                Installation Guide
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Tutorials">
            Tutorials
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/automate/install" title="Get Started">
                Get Started
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/automate/visibility" title="Visibility into Infrastructure">
                Visibility into Infrastructure
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/automate/deploy-cookbook/" title="Deploy with Chef Automate">
                Deploy with Chef Automate
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/compliance-assess" title="Assess for Compliance">
                Assess for Compliance
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/compliance-remediate" title="Remediate Compliance Failures">
                Remediate Compliance Failures
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Setup">
            Setup
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_pipeline.html" title="Configure a Pipeline">
                Configure a Pipeline
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_json_delivery.html" title="Configure a Project">
                Configure a Project
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/setup_visibility_chef_automate.html" title="Configure Data Collection">
                Configure Data Collection
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Concepts">
            Concepts
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2">

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Workflow">
                Workflow
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/workflow.html" title="Workflow Overview">
                    Workflow Overview
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_manage_dependencies.html" title="Manage Dependencies">
                    Manage Dependencies
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/visibility.html" title="Visibility Overview">
                Visibility Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/compliance.html" title="Compliance Overview">
                Compliance Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/ctl_delivery.html" title="Delivery CLI">
            Delivery CLI
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Integrations">
            Integrations
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_bitbucket.html" title="w/Bitbucket">
                w/Bitbucket
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_smtp.html" title="w/Email (SMTP)">
                w/Email (SMTP)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_github.html" title="w/GitHub">
                w/GitHub
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_ldap.html" title="w/LDAP">
                w/LDAP
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_chef_automate_saml.html" title="w/SAML">
                w/SAML
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_slack.html" title="w/Slack">
                w/Slack
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Cookbooks">
            Cookbooks
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_build_cookbook.html" title="build-cookbook (cookbook)">
                build-cookbook (cookbook)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_truck.html" title="delivery-truck (cookbook)">
                delivery-truck (cookbook)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/publish_cookbooks_multiple_servers.html" title="Publish to Multiple Chef Servers">
                Publish to Multiple Chef Servers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/dsl_delivery.html" title="Workflow DSL">
            Workflow DSL
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/job_dispatch.html" title="Job Dispatch">
            Job Dispatch
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Managing the Server">
            Managing the Server
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2">

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Backups">
                Backups
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#configuration" title="Configuration">
                    Configuration
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#create-backups" title="Create Backups">
                    Create Backups
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#list-backups" title="List Backups">
                    List Backups
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#delete-backups" title="Delete Backups">
                    Delete Backups
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#restore-backups" title="Restore Backups">
                    Restore Backups
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/scaling_capacity_planning_chef_automate.html" title="Capacity Planning">
                Capacity Planning
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_delivery.html" title="Chef Automate API">
                Chef Automate API
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="automate-ctl">
                automate-ctl
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#cleanse" title="cleanse">
                    cleanse
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#create-enterprise" title="create-enterprise">
                    create-enterprise
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#create-user" title="create-user">
                    create-user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-application" title="delete-application">
                    delete-application
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-enterprise" title="delete-enterprise">
                    delete-enterprise
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-project" title="delete-project">
                    delete-project
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-user" title="delete-user">
                    delete-user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-visibility-node" title="delete-visibility-node">
                    delete-visibility-node
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-visibility-node-by-id" title="delete-visibility-node-by-id">
                    delete-visibility-node-by-id
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#gather-logs" title="gather-logs">
                    gather-logs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#help" title="help">
                    help
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#install-runner" title="install-runner">
                    install-runner
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#list-applications" title="list-applications">
                    list-applications
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#list-enterprises" title="list-enterprises">
                    list-enterprises
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#list-users" title="list-users">
                    list-users
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#migrate-change-description" title="migrate-change-description">
                    migrate-change-description
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#migrate-patchset-diffs" title="migrate-patchset-diffs">
                    migrate-patchset-diffs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#preflight-check" title="preflight-check">
                    preflight-check
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#reconfigure" title="reconfigure">
                    reconfigure
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#rename-enterprise" title="rename-enterprise">
                    rename-enterprise
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#reset-password" title="reset-password">
                    reset-password
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#restore-backup" title="restore-backup">
                    restore-backup
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#revoke-token" title="revoke-token">
                    revoke-token
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#show-config" title="show-config">
                    show-config
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#uninstall" title="uninstall">
                    uninstall
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#update-project-hooks" title="update-project-hooks">
                    update-project-hooks
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_delivery.html" title="delivery.rb">
                delivery.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_server_disaster_recovery.html" title="Disaster Recovery">
                Disaster Recovery
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/elasticsearch_and_kibana_auth.html" title="Elasticsearch &amp; Kibana Auth">
                Elasticsearch &amp; Kibana Auth
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/manage_indices_chef_automate.html" title="Manage Elasticsearch Indices">
                Manage Elasticsearch Indices
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/search_query_chef_automate.html" title="Node Search Reference">
                Node Search Reference
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_manage_secrets.html" title="Secrets">
                Secrets
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/stream_data_chef_automate.html" title="Stream Data">
                Stream Data
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_server_tuning.html" title="Tuning">
                Tuning
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_chef_automate.html" title="Upgrades">
                Upgrades
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_users_and_roles.html" title="Users &amp; Roles">
                Users &amp; Roles
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Compliance scanner">
            Compliance scanner
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/compliance.html" title="Overview">
                Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/release_notes_compliance.html" title="Release Notes">
                Release Notes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_compliance.html" title="Installation Guide">
                Installation Guide
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_compliance_chef_server.html" title="Integrate w/Chef Server">
                Integrate w/Chef Server
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_compliance_chef_automate.html" title="Integrate w/Chef Automate">
                Integrate w/Chef Automate
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_compliance.html" title="Upgrade Compliance">
                Upgrade Compliance
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_compliance.html" title="chef-compliance.rb">
                chef-compliance.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_compliance.html" title="Chef Compliance API">
                Chef Compliance API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/aws_opsworks_chef_automate.html" title="AWS OpsWorks for Chef Automate">
            AWS OpsWorks for Chef Automate
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/troubleshooting_chef_automate.html" title="Troubleshooting">
            Troubleshooting
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Legacy"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-hdd-o icon-left"></i> Legacy <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items">

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Analytics">
            Analytics
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics.html" title="Overview">
                Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/release_notes_analytics.html" title="Release Notes">
                Release Notes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_analytics.html" title="Install Standalone">
                Install Standalone
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/actions.html" title="Web UI">
                Web UI
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_webui_tasks.html" title="Management Console">
                Management Console
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_nodes_view.html" title="Nodes View">
                Nodes View
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics.html#integrations" title="Integrations">
                Integrations
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_splunk.html" title="Splunk">
                Splunk
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_rules.html" title="Rules">
                Rules
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_monitor.html" title="Monitor">
                Monitor
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_analytics.html" title="Upgrades">
                Upgrades
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_client_analytics.html" title="Chef Client for Analytics">
                Chef Client for Analytics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_analytics.html" title="opscode-analytics-ctl">
                opscode-analytics-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_analytics.html" title="opscode-analytics.rb">
                opscode-analytics.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_analytics.html" title="knife-analytics">
                knife-analytics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_analytics.html" title="Analytics API">
                Analytics API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/dsl_recipe_analytics.html" title="Recipe DSL for Analytics">
                Recipe DSL for Analytics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Reporting">
            Reporting
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/reporting.html" title="Overview">
                Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_reporting.html" title="Install Reporting">
                Install Reporting
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_manage_reports.html" title="View Reports">
                View Reports
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_reporting.html" title="knife reporting">
                knife reporting
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_reporting.html" title="opscode-reporting-ctl">
                opscode-reporting-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_reporting.html" title="opscode-reporting.rb">
                opscode-reporting.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_reporting.html" title="Reporting API">
                Reporting API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Extension APIs"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-clone icon-left"></i> Extension APIs <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/dsl_compliance.html" title="Compliance DSL">
            Compliance DSL
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Handlers">
            Handlers
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/handlers.html#custom-handlers" title="Custom Handlers">
                Custom Handlers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/dsl_handler.html" title="Handler DSL">
                Handler DSL
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_community.html#handlers" title="Community Handlers">
                Community Handlers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Knife Plugins">
            Knife Plugins
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife.html" title="About Cloud Plugins">
                About Cloud Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_custom.html" title="Custom Plugins">
                Custom Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_community.html#knife" title="Community Plugins">
                Community Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Ohai Plugins">
            Ohai Plugins
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ohai_custom.html" title="Custom Plugins">
                Custom Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_community.html#ohai" title="Community Plugins">
                Community Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/plugin_community.html#chef-client" title="Chef Client Plugins">
            Chef Client Plugins
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li> <!-- /for item in navItems -->
    
    <li class="main-item dark-item">
      <a href="https://github.com/chef/chef-web-docs" title="Available on GitHub">
        <i class="fa fa-github icon-left"></i>
        Available on GitHub
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://www.chef.io/chef/get-chef">
        <i class="fa fa-download icon-left"></i>
        Get Chef
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://docs.chef.io/feedback.html">
        <i class="fa fa-commenting icon-left"></i>
        Send Feedback
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://www.chef.io/support/">
        <i class="fa fa-support icon-left"></i>
        Support
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://docs.chef.io/index.html">
        <i class="fa fa-map-o icon-left"></i>
        Site Map
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://docs-archive.chef.io/">
        <i class="fa fa-archive icon-left"></i>
        Archive
      </a>
    </li>
  </ul>
</nav>
      <div class="documentwrapper"><div class="sphinxsidebar" role="navigation" aria-label="main navigation">
  <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">About the Recipe DSL</a><ul>
<li><a class="reference internal" href="#use-ruby">Use Ruby</a><ul>
<li><a class="reference internal" href="#if-statements">if Statements</a></li>
<li><a class="reference internal" href="#case-statements">case Statements</a></li>
<li><a class="reference internal" href="#include-method">include? Method</a></li>
<li><a class="reference internal" href="#array-syntax-shortcut">Array Syntax Shortcut</a></li>
</ul>
</li>
<li><a class="reference internal" href="#include-recipes">Include Recipes</a><ul>
<li><a class="reference internal" href="#reload-attributes">Reload Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recipe-dsl-methods">Recipe DSL Methods</a><ul>
<li><a class="reference internal" href="#attribute">attribute?</a></li>
<li><a class="reference internal" href="#control">control</a><ul>
<li><a class="reference internal" href="#directory-matcher">directory Matcher</a></li>
<li><a class="reference internal" href="#file-matcher">file Matcher</a></li>
<li><a class="reference internal" href="#package-matcher">package Matcher</a></li>
<li><a class="reference internal" href="#port-matcher">port Matcher</a></li>
<li><a class="reference internal" href="#service-matcher">service Matcher</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#control-group">control_group</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cookbook-name">cookbook_name</a></li>
<li><a class="reference internal" href="#data-bag">data_bag</a></li>
<li><a class="reference internal" href="#data-bag-item">data_bag_item</a></li>
<li><a class="reference internal" href="#declare-resource">declare_resource</a></li>
<li><a class="reference internal" href="#delete-resource">delete_resource</a></li>
<li><a class="reference internal" href="#id2">delete_resource!</a></li>
<li><a class="reference internal" href="#edit-resource">edit_resource</a></li>
<li><a class="reference internal" href="#id3">edit_resource!</a></li>
<li><a class="reference internal" href="#find-resource">find_resource</a></li>
<li><a class="reference internal" href="#id4">find_resource!</a></li>
<li><a class="reference internal" href="#platform">platform?</a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#id5">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#platform-family">platform_family?</a><ul>
<li><a class="reference internal" href="#id6">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reboot-pending">reboot_pending?</a></li>
<li><a class="reference internal" href="#recipe-name">recipe_name</a></li>
<li><a class="reference internal" href="#resources">resources</a></li>
<li><a class="reference internal" href="#search">search</a><ul>
<li><a class="reference internal" href="#filter-result">:filter_result</a></li>
<li><a class="reference internal" href="#query-syntax">Query Syntax</a><ul>
<li><a class="reference internal" href="#keys">Keys</a></li>
<li><a class="reference internal" href="#patterns">Patterns</a></li>
<li><a class="reference internal" href="#operators">Operators</a></li>
<li><a class="reference internal" href="#special-characters">Special Characters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shell-out">shell_out</a></li>
<li><a class="reference internal" href="#id8">shell_out!</a></li>
<li><a class="reference internal" href="#shell-out-with-systems-locale">shell_out_with_systems_locale</a></li>
<li><a class="reference internal" href="#tag-tagged-untag">tag, tagged?, untag</a></li>
<li><a class="reference internal" href="#value-for-platform">value_for_platform</a><ul>
<li><a class="reference internal" href="#id9">Operators</a></li>
<li><a class="reference internal" href="#id10">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#value-for-platform-family">value_for_platform_family</a></li>
<li><a class="reference internal" href="#with-run-context">with_run_context</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-handlers">Event Handlers</a><ul>
<li><a class="reference internal" href="#on-method">on Method</a></li>
<li><a class="reference internal" href="#event-types">Event Types</a></li>
<li><a class="reference internal" href="#id11">Examples</a><ul>
<li><a class="reference internal" href="#send-email">Send Email</a></li>
<li><a class="reference internal" href="#etcd-locks">etcd Locks</a></li>
<li><a class="reference internal" href="#hipchat-notifications">HipChat Notifications</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#windows-platform">Windows Platform</a><ul>
<li><a class="reference internal" href="#registry-data-exists">registry_data_exists?</a></li>
<li><a class="reference internal" href="#registry-get-subkeys">registry_get_subkeys</a></li>
<li><a class="reference internal" href="#registry-get-values">registry_get_values</a></li>
<li><a class="reference internal" href="#registry-has-subkeys">registry_has_subkeys?</a></li>
<li><a class="reference internal" href="#registry-key-exists">registry_key_exists?</a></li>
<li><a class="reference internal" href="#registry-value-exists">registry_value_exists?</a></li>
<li><a class="reference internal" href="#helpers">Helpers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
</div>
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="about-the-recipe-dsl">
<h1>About the Recipe DSL<a class="headerlink" href="#about-the-recipe-dsl" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/dsl_recipe.rst">[edit on GitHub]</a></p>
<p>The Recipe DSL is a Ruby DSL that is primarily used to declare resources from within a recipe. The Recipe DSL also helps ensure that recipes interact with nodes (and node properties) in the desired manner. Most of the methods in the Recipe DSL are used to find a specific parameter and then tell the chef-client what action(s) to take, based on whether that parameter is present on a node.</p>
<p>Because the Recipe DSL is a Ruby DSL, then anything that can be done using Ruby can also be done in a recipe, including <tt class="docutils literal"><span class="pre">if</span></tt> and <tt class="docutils literal"><span class="pre">case</span></tt> statements, using the <tt class="docutils literal"><span class="pre">include?</span></tt> Ruby method, including recipes in recipes, and checking for dependencies.</p>
<div class="section" id="use-ruby">
<h2>Use Ruby<a class="headerlink" href="#use-ruby" title="Permalink to this headline">¶</a></h2>
<p>Common Ruby techniques can be used with the Recipe DSL methods.</p>
<div class="section" id="if-statements">
<h3>if Statements<a class="headerlink" href="#if-statements" title="Permalink to this headline">¶</a></h3>
<p>An <tt class="docutils literal"><span class="pre">if</span></tt> statement can be used to specify part of a recipe to be used when certain conditions are met. <tt class="docutils literal"><span class="pre">else</span></tt> and <tt class="docutils literal"><span class="pre">elseif</span></tt> statements can be used to handle situations where either the initial condition is not met or when there are other possible conditions that can be met. Since this behavior is 100% Ruby, do this in a recipe the same way here as anywhere else.</p>
<p>For example, using an <tt class="docutils literal"><span class="pre">if</span></tt> statement with the <tt class="docutils literal"><span class="pre">platform</span></tt> node attribute:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;ubuntu&#39;</span>
  <span class="c1"># do ubuntu things</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="case-statements">
<h3>case Statements<a class="headerlink" href="#case-statements" title="Permalink to this headline">¶</a></h3>
<p>A <tt class="docutils literal"><span class="pre">case</span></tt> statement can be used to handle a situation where there are a lot of conditions. Use the <tt class="docutils literal"><span class="pre">when</span></tt> statement for each condition, as many as are required.</p>
<p>For example, using a <tt class="docutils literal"><span class="pre">case</span></tt> statement with the <tt class="docutils literal"><span class="pre">platform</span></tt> node attribute:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="o">]</span>
<span class="k">when</span> <span class="s1">&#39;debian&#39;</span><span class="p">,</span> <span class="s1">&#39;ubuntu&#39;</span>
  <span class="c1"># do debian/ubuntu things</span>
<span class="k">when</span> <span class="s1">&#39;redhat&#39;</span><span class="p">,</span> <span class="s1">&#39;centos&#39;</span><span class="p">,</span> <span class="s1">&#39;fedora&#39;</span>
  <span class="c1"># do redhat/centos/fedora things</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For example, using a <tt class="docutils literal"><span class="pre">case</span></tt> statement with the <tt class="docutils literal"><span class="pre">platform_family</span></tt> node attribute:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform_family&#39;</span><span class="o">]</span>
<span class="k">when</span> <span class="s1">&#39;debian&#39;</span>
  <span class="c1"># do things on debian-ish platforms (debian, ubuntu, linuxmint)</span>
<span class="k">when</span> <span class="s1">&#39;rhel&#39;</span>
  <span class="c1"># do things on RHEL platforms (redhat, centos, scientific, etc)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="include-method">
<h3>include? Method<a class="headerlink" href="#include-method" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">include?</span></tt> method can be used to ensure that a specific parameter is included before an action is taken. For example, using the <tt class="docutils literal"><span class="pre">include?</span></tt> method to find a specific parameter:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="sx">%w(debian ubuntu)</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="o">]</span><span class="p">)</span>
  <span class="c1"># do debian/ubuntu things</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="sx">%w{rhel}</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform_family&#39;</span><span class="o">]</span><span class="p">)</span>
  <span class="c1"># do RHEL things</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="array-syntax-shortcut">
<h3>Array Syntax Shortcut<a class="headerlink" href="#array-syntax-shortcut" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">%w</span></tt> syntax is a Ruby shortcut for creating an array without requiring quotes and commas around the elements.</p>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="sx">%w(debian ubuntu)</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="o">]</span><span class="p">)</span>
  <span class="c1"># do debian/ubuntu things with the Ruby array %w() shortcut</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="include-recipes">
<h2>Include Recipes<a class="headerlink" href="#include-recipes" title="Permalink to this headline">¶</a></h2>
<p>A recipe can include one (or more) recipes located in external cookbooks by using the <tt class="docutils literal"><span class="pre">include_recipe</span></tt> method. When a recipe is included, the resources found in that recipe will be inserted (in the same exact order) at the point where the <tt class="docutils literal"><span class="pre">include_recipe</span></tt> keyword is located.</p>
<p>The syntax for including a recipe is like this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">include_recipe</span> <span class="s1">&#39;recipe&#39;</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">include_recipe</span> <span class="s1">&#39;apache2::mod_ssl&#39;</span>
</pre></div>
</div>
<p>If the <tt class="docutils literal"><span class="pre">include_recipe</span></tt> method is used more than once to include a recipe, only the first inclusion is processed and any subsequent inclusions are ignored.</p>
<div class="section" id="reload-attributes">
<h3>Reload Attributes<a class="headerlink" href="#reload-attributes" title="Permalink to this headline">¶</a></h3>
<p>Attributes sometimes depend on actions taken from within recipes, so it may be necessary to reload a given attribute from within a recipe. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">ruby_block</span> <span class="s1">&#39;some_code&#39;</span> <span class="k">do</span>
  <span class="n">block</span> <span class="k">do</span>
    <span class="n">node</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">run_context</span><span class="o">.</span><span class="n">resolve_attribute</span><span class="p">(</span><span class="s1">&#39;COOKBOOK_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;ATTR_FILE&#39;</span><span class="p">))</span>
  <span class="k">end</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="recipe-dsl-methods">
<h2>Recipe DSL Methods<a class="headerlink" href="#recipe-dsl-methods" title="Permalink to this headline">¶</a></h2>
<p>The Recipe DSL provides support for using attributes, data bags (and encrypted data), and search results in a recipe, as well as four helper methods that can be used to check for a node&#8217;s platform from the recipe to ensure that specific actions are taken for specific platforms. The helper methods are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">platform?</span></tt></li>
<li><tt class="docutils literal"><span class="pre">platform_family?</span></tt></li>
<li><tt class="docutils literal"><span class="pre">value_for_platform</span></tt></li>
<li><tt class="docutils literal"><span class="pre">value_for_platform_family</span></tt></li>
</ul>
<div class="section" id="attribute">
<h3>attribute?<a class="headerlink" href="#attribute" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">attribute?</span></tt> method to ensure that certain actions only execute in the presence of a particular node attribute. The <tt class="docutils literal"><span class="pre">attribute?</span></tt> method will return true if one of the listed node attributes matches a node attribute that is detected by Ohai during every chef-client run.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">attribute?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">attribute?</span><span class="p">(</span><span class="s1">&#39;name_of_attribute&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">attribute?</span><span class="p">(</span><span class="s1">&#39;ipaddress&#39;</span><span class="p">)</span>
  <span class="c1"># the node has an ipaddress</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="control">
<h3>control<a class="headerlink" href="#control" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">control</span></tt> method to define a specific series of tests that comprise an individual audit. A <tt class="docutils literal"><span class="pre">control</span></tt> method MUST be contained within a <tt class="docutils literal"><span class="pre">control_group</span></tt> block. A <tt class="docutils literal"><span class="pre">control_group</span></tt> block may contain multiple <tt class="docutils literal"><span class="pre">control</span></tt> methods.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">control</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;audit name&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;name&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should do something&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">something</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="o">/.</span><span class="n">to_not</span> <span class="n">be_something</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">control_group</span></tt> groups one (or more) <tt class="docutils literal"><span class="pre">control</span></tt> blocks</li>
<li><tt class="docutils literal"><span class="pre">control</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> defines an individual audit</li>
<li>Each <tt class="docutils literal"><span class="pre">control</span></tt> block must define at least one validation</li>
<li>Each <tt class="docutils literal"><span class="pre">it</span></tt> statement defines a single validation. <tt class="docutils literal"><span class="pre">it</span></tt> statements are processed individually when the chef-client is run in audit-mode</li>
<li>An <tt class="docutils literal"><span class="pre">expect(something).to/.to_not</span> <span class="pre">be_something</span></tt> is a statement that represents the individual test. In other words, this statement tests if something is expected to be (or not be) something. For example, a test that expects the PostgreSQL pacakge to not be installed would be similar to <tt class="docutils literal"><span class="pre">expect(package('postgresql')).to_not</span> <span class="pre">be_installed</span></tt> and a test that ensures a service is enabled would be similar to <tt class="docutils literal"><span class="pre">expect(service('init')).to</span> <span class="pre">be_enabled</span></tt></li>
<li>An <tt class="docutils literal"><span class="pre">it</span></tt> statement may contain multiple <tt class="docutils literal"><span class="pre">expect</span></tt> statements</li>
</ul>
<div class="section" id="directory-matcher">
<h4>directory Matcher<a class="headerlink" href="#directory-matcher" title="Permalink to this headline">¶</a></h4>
<p>Matchers are available for directories. Use this matcher to define audits for directories that test if the directory exists, is mounted, and if it is linked to. This matcher uses the same matching syntax&#8212;<tt class="docutils literal"><span class="pre">expect(file('foo'))</span></tt>&#8212;as the files. The following matchers are available for directories:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Matcher</th>
<th class="head">Description, Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_directory</span></tt></td>
<td><p class="first">Use to test if directory exists. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be a directory&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/var/directory&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_directory</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_linked_to</span></tt></td>
<td><p class="first">Use to test if a subject is linked to the named directory. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be linked to the named directory&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/directory&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_linked_to</span><span class="p">(</span><span class="s1">&#39;/etc/some/other/directory&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_mounted</span></tt></td>
<td><p class="first">Use to test if a directory is mounted. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be mounted&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mounted</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For directories with a single attribute that requires testing:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be mounted with an ext4 partition&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mounted</span><span class="o">.</span><span class="n">with</span><span class="p">(</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s1">&#39;ext4&#39;</span> <span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For directories with multiple attributes that require testing:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be mounted only with certain attributes&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mounted</span><span class="o">.</span><span class="n">only_with</span><span class="p">(</span>
    <span class="ss">:attribute</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="ss">:attribute</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="file-matcher">
<h4>file Matcher<a class="headerlink" href="#file-matcher" title="Permalink to this headline">¶</a></h4>
<p>Matchers are available for files and directories. Use this matcher to define audits for files that test if the file exists, its version, if it is is executable, writable, or readable, who owns it, verify checksums (both MD5 and SHA-256) and so on. The following matchers are available for files:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Matcher</th>
<th class="head">Description, Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_executable</span></tt></td>
<td><p class="first">Use to test if a file is executable. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be executable&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_executable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is executable by its owner:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be executable by owner&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_executable</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is executable by a group:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be executable by group members&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_executable</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is executable by a specific user:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be executable by user foo&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_executable</span><span class="o">.</span><span class="n">by_user</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_file</span></tt></td>
<td><p class="first">Use to test if a file exists. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be a file&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_file</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_grouped_into</span></tt></td>
<td><p class="first">Use to test if a file is grouped into the named group. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be grouped into foo&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_grouped_into</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_linked_to</span></tt></td>
<td><p class="first">Use to test if a subject is linked to the named file. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be linked to the named file&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_linked_to</span><span class="p">(</span><span class="s1">&#39;/etc/some/other/file&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_mode</span></tt></td>
<td><p class="first">Use to test if a file is set to the specified mode. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be mode 440&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mode</span><span class="p">(</span><span class="mi">440</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_owned_by</span></tt></td>
<td><p class="first">Use to test if a file is owned by the named owner. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be owned by the root user&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/sudoers&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_owned_by</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_readable</span></tt></td>
<td><p class="first">Use to test if a file is readable. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be readable&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_readable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is readable by its owner:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be readable by owner&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_readable</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is readable by a group:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be readable by group members&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_readable</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is readable by a specific user:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be readable by user foo&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_readable</span><span class="o">.</span><span class="n">by_user</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_socket</span></tt></td>
<td><p class="first">Use to test if a file exists as a socket. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be a socket&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/var/file.sock&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_socket</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_symlink</span></tt></td>
<td><p class="first">Use to test if a file exists as a symbolic link. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be a symlink&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_symlink</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_version</span></tt></td>
<td><p class="first">Microsoft Windows only. Use to test if a file is the specified version. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be version 1.2&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;C:\\Windows\\path\\to\\file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_version</span><span class="p">(</span><span class="s1">&#39;1.2&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_writable</span></tt></td>
<td><p class="first">Use to test if a file is writable. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be writable&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_writable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is writable by its owner:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be writable by owner&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_writable</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is writable by a group:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be writable by group members&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_writable</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a file that is writable by a specific user:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be writable by user foo&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_writable</span><span class="o">.</span><span class="n">by_user</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">contain</span></tt></td>
<td><p class="first">Use to test if a file contains specific contents. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should contain docs.chef.io&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/file&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">contain</span><span class="p">(</span><span class="s1">&#39;docs.chef.io&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="package-matcher">
<h4>package Matcher<a class="headerlink" href="#package-matcher" title="Permalink to this headline">¶</a></h4>
<p>Matchers are available for packages and may be used to define audits that test if a package or a package version is installed. The following matchers are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Matcher</th>
<th class="head">Description, Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_installed</span></tt></td>
<td><p class="first">Use to test if the named package is installed. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;httpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a specific package version:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;httpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span><span class="o">.</span><span class="n">with_version</span><span class="p">(</span><span class="s1">&#39;0.1.2&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="port-matcher">
<h4>port Matcher<a class="headerlink" href="#port-matcher" title="Permalink to this headline">¶</a></h4>
<p>Matchers are available for ports and may be used to define audits that test if a port is listening. The following matchers are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Matcher</th>
<th class="head">Description, Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_listening</span></tt></td>
<td><p class="first">Use to test if the named port is listening. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be listening&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">port</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_listening</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a named port that is not listening:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should not be listening&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">port</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_listening</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a specific port type use <tt class="docutils literal"><span class="pre">.with('port_type')</span></tt>. For example, UDP:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be listening with UDP&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">port</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_listening</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="s1">&#39;udp&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For UDP, version 6:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be listening with UDP6&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">port</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_listening</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="s1">&#39;udp6&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For TCP/IP:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be listening with TCP&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">port</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_listening</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="s1">&#39;tcp&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For TCP/IP, version 6:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be listening with TCP6&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">port</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_listening</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="s1">&#39;tcp6&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="service-matcher">
<h4>service Matcher<a class="headerlink" href="#service-matcher" title="Permalink to this headline">¶</a></h4>
<p>Matchers are available for services and may be used to define audits that test for conditions related to services, such as if they are enabled, running, have the correct startup mode, and so on. The following matchers are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Matcher</th>
<th class="head">Description, Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_enabled</span></tt></td>
<td><p class="first">Use to test if the named service is enabled (i.e. will start up automatically). For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be enabled&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_enabled</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a service that is enabled at a given run level:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be enabled at the specified run level&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_enabled</span><span class="o">.</span><span class="n">with_level</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_installed</span></tt></td>
<td><p class="first">Microsoft Windows only. Use to test if the named service is installed on the Microsoft Windows platform. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;DNS Client&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">be_running</span></tt></td>
<td><p class="first">Use to test if the named service is running. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be running&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_running</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a service that is running under supervisor:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be running under supervisor&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_running</span><span class="o">.</span><span class="n">under</span><span class="p">(</span><span class="s1">&#39;supervisor&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or daemontools:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be running under daemontools&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_running</span><span class="o">.</span><span class="n">under</span><span class="p">(</span><span class="s1">&#39;daemontools&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or Upstart:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be running under upstart&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_running</span><span class="o">.</span><span class="n">under</span><span class="p">(</span><span class="s1">&#39;upstart&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">be_monitored_by</span></tt></td>
<td><p class="first">Use to test if the named service is being monitored by the named monitoring application. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should be monitored by&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntpd&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_monitored_by</span><span class="p">(</span><span class="s1">&#39;monit&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">have_start_mode</span></tt></td>
<td><p class="first">Microsoft Windows only. Use to test if the named service&#8217;s startup mode is correct on the Microsoft Windows platform. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="s1">&#39;should start manually&#39;</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">service</span><span class="p">(</span><span class="s1">&#39;DNS Client&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">have_start_mode</span><span class="o">.</span><span class="n">Manual</span>
<span class="k">end</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p><strong>A package is installed</strong></p>
<p>For example, a package is installed:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;audit name&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;mysql package&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">control_group</span></tt> block is processed when the chef-client run is run in audit-mode. If the audit was successful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Audit Mode
  mysql package
    should be installed
</pre></div>
</div>
<p>If an audit was unsuccessful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Starting audit phase

Audit Mode
  mysql package
  should be installed <span class="o">(</span>FAILED - 1<span class="o">)</span>

Failures:

1<span class="o">)</span> Audit Mode mysql package should be installed
  Failure/Error: expect<span class="o">(</span>package<span class="o">(</span><span class="s1">&#39;mysql&#39;</span><span class="o">))</span>.to be_installed.with_version<span class="o">(</span><span class="s1">&#39;5.6&#39;</span><span class="o">)</span>
    expected Package <span class="s1">&#39;mysql&#39;</span> to be installed
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:22:in &#39;block (3 levels) in from_file&#39;</span>

Finished in 0.5745 seconds <span class="o">(</span>files took 0.46481 seconds to load<span class="o">)</span>
<span class="m">1</span> examples, <span class="m">1</span> failures

Failed examples:

rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:21 <span class="c1"># Audit Mode mysql package should be installed</span>
</pre></div>
</div>
<p><strong>A package version is installed</strong></p>
<p>A package that is installed with a specific version:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;audit name&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;mysql package&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span><span class="o">.</span><span class="n">with_version</span><span class="p">(</span><span class="s1">&#39;5.6&#39;</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>A package is not installed</strong></p>
<p>A package that is not installed:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;audit name&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;postgres package&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should not be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;postgresql&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_installed</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>If the audit was successful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Audit Mode
  postgres audit
    postgres package
      is not installed
</pre></div>
</div>
<p><strong>A service is enabled</strong></p>
<p>A service that is enabled and running:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;audit name&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;mysql service&#39;</span> <span class="k">do</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:mysql_service</span><span class="p">)</span> <span class="p">{</span> <span class="n">service</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="s1">&#39;should be enabled&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">mysql_service</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_enabled</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should be running&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">mysql_service</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_running</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>If the audit was successful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Audit Mode
  mysql service audit
    mysql service
      is enabled
      is running
</pre></div>
</div>
<p><strong>A configuration file contains specific settings</strong></p>
<p>The following example shows how to verify <tt class="docutils literal"><span class="pre">sshd</span></tt> configration, including whether it&#8217;s installed, what the permissions are, and how it can be accessed:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;check sshd configuration&#39;</span> <span class="k">do</span>

  <span class="n">control</span> <span class="s1">&#39;sshd package&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;openssh-server&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">control</span> <span class="s1">&#39;sshd configuration&#39;</span> <span class="k">do</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:config_file</span><span class="p">)</span> <span class="p">{</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/ssh/sshd_config&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="s1">&#39;should exist with the right permissions&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_file</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mode</span><span class="p">(</span><span class="mi">644</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_owned_by</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_grouped_into</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should not permit RootLogin&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="o">.</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">to_not</span> <span class="n">match</span><span class="p">(</span><span class="sr">/^PermitRootLogin yes/</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should explicitly not permit PasswordAuthentication&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="o">.</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">/^PasswordAuthentication no/</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should force privilege separation&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="o">.</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">/^UsePrivilegeSeparation sandbox/</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">let(:config_file)</span> <span class="pre">{</span> <span class="pre">file('/etc/ssh/sshd_config')</span> <span class="pre">}</span></tt> uses the <tt class="docutils literal"><span class="pre">file</span></tt> matcher to test specific settings within the <tt class="docutils literal"><span class="pre">sshd</span></tt> configuration file</li>
</ul>
<p><strong>A file contains desired permissions and contents</strong></p>
<p>The following example shows how to verify that a file has the desired permissions and contents:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">controls</span> <span class="s1">&#39;mysql config&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;mysql config file&#39;</span> <span class="k">do</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:config_file</span><span class="p">)</span> <span class="p">{</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/mysql/my.cnf&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="s1">&#39;exists with correct permissions&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_file</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mode</span><span class="p">(</span><span class="mo">0400</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;contains required configuration&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">its</span><span class="p">(</span><span class="s1">&#39;contents&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">/default-time-zone=&#39;UTC&#39;/</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>If the audit was successful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Audit Mode
  mysql config
    mysql config file
      exists with correct permissions
      contains required configuration
</pre></div>
</div>
<p><strong>Test an attribute value</strong></p>
<p>To audit attribute values in a <tt class="docutils literal"><span class="pre">control</span></tt> block, first assign the attribute as a variable, and then use the variable within the <tt class="docutils literal"><span class="pre">control</span></tt> block to specify the test:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">memory_mb</span> <span class="o">=</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;memory&#39;</span><span class="o">][</span><span class="s1">&#39;total&#39;</span><span class="o">].</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/kB$/i</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_i</span> <span class="o">/</span> <span class="mi">1024</span>
<span class="n">control</span> <span class="s1">&#39;minimum memory check&#39;</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">&#39;should be at least 400MB free&#39;</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">memory_mb</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be</span> <span class="o">&gt;=</span> <span class="mi">400</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="control-group">
<h3>control_group<a class="headerlink" href="#control-group" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">control_group</span></tt> method to define a group of <tt class="docutils literal"><span class="pre">control</span></tt> methods that comprise a single audit. The name of each <tt class="docutils literal"><span class="pre">control_group</span></tt> must be unique within the organization.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">control_group</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;name&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;name&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should do something&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">something</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="o">/.</span><span class="n">to_not</span> <span class="n">be_something</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="n">control</span> <span class="s1">&#39;name&#39;</span> <span class="k">do</span>
    <span class="o">...</span>
  <span class="k">end</span>
  <span class="o">...</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">control_group</span></tt> groups one (or more) <tt class="docutils literal"><span class="pre">control</span></tt> blocks</li>
<li><tt class="docutils literal"><span class="pre">'name'</span></tt> is the unique name for the <tt class="docutils literal"><span class="pre">control_group</span></tt>; the chef-client will raise an exception if duplicate <tt class="docutils literal"><span class="pre">control_group</span></tt> names are present</li>
<li><tt class="docutils literal"><span class="pre">control</span></tt> defines each individual audit within the <tt class="docutils literal"><span class="pre">control_group</span></tt> block. There is no limit to the number of <tt class="docutils literal"><span class="pre">control</span></tt> blocks that may defined within a <tt class="docutils literal"><span class="pre">control_group</span></tt> block</li>
</ul>
<div class="section" id="id1">
<h4>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p><strong>control_group block with multiple control blocks</strong></p>
<p>The following <tt class="docutils literal"><span class="pre">control_group</span></tt> ensures that MySQL is installed, that PostgreSQL is not installed, and that the services and configuration files associated with MySQL are configured correctly:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;Audit Mode&#39;</span> <span class="k">do</span>

  <span class="n">control</span> <span class="s1">&#39;mysql package&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span><span class="o">.</span><span class="n">with_version</span><span class="p">(</span><span class="s1">&#39;5.6&#39;</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">control</span> <span class="s1">&#39;postgres package&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should not be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;postgresql&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to_not</span> <span class="n">be_installed</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">control</span> <span class="s1">&#39;mysql service&#39;</span> <span class="k">do</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:mysql_service</span><span class="p">)</span> <span class="p">{</span> <span class="n">service</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="s1">&#39;should be enabled&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">mysql_service</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_enabled</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should be running&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">mysql_service</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_running</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">control</span> <span class="s1">&#39;mysql config directory&#39;</span> <span class="k">do</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:config_dir</span><span class="p">)</span> <span class="p">{</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/mysql&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="s1">&#39;should exist with correct permissions&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_dir</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_directory</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_dir</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mode</span><span class="p">(</span><span class="mo">0700</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should be owned by the db user&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_dir</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_owned_by</span><span class="p">(</span><span class="s1">&#39;db_service_user&#39;</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">control</span> <span class="s1">&#39;mysql config file&#39;</span> <span class="k">do</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:config_file</span><span class="p">)</span> <span class="p">{</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/etc/mysql/my.cnf&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="s1">&#39;should exist with correct permissions&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_file</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_mode</span><span class="p">(</span><span class="mo">0400</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s1">&#39;should contain required configuration&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">config_file</span><span class="o">.</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">/default-time-zone=&#39;UTC&#39;/</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

<span class="k">end</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">control_group</span></tt> block is processed when the chef-client is run in audit-mode. If the chef-client run was successful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Audit Mode
  mysql package
    should be installed
  postgres package
    should not be installed
  mysql service
    should be enabled
    should be running
  mysql config directory
    should exist with correct permissions
    should be owned by the db user
  mysql config file
    should exist with correct permissions
    should contain required configuration
</pre></div>
</div>
<p>If an audit was unsuccessful, the chef-client will return output similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Starting audit phase

Audit Mode
  mysql package
  should be installed <span class="o">(</span>FAILED - 1<span class="o">)</span>
postgres package
  should not be installed
mysql service
  should be enabled <span class="o">(</span>FAILED - 2<span class="o">)</span>
  should be running <span class="o">(</span>FAILED - 3<span class="o">)</span>
mysql config directory
  should exist with correct permissions <span class="o">(</span>FAILED - 4<span class="o">)</span>
  should be owned by the db user <span class="o">(</span>FAILED - 5<span class="o">)</span>
mysql config file
  should exist with correct permissions <span class="o">(</span>FAILED - 6<span class="o">)</span>
  should contain required configuration <span class="o">(</span>FAILED - 7<span class="o">)</span>

Failures:

1<span class="o">)</span> Audit Mode mysql package should be installed
  Failure/Error: expect<span class="o">(</span>package<span class="o">(</span><span class="s1">&#39;mysql&#39;</span><span class="o">))</span>.to be_installed.with_version<span class="o">(</span><span class="s1">&#39;5.6&#39;</span><span class="o">)</span>
    expected Package <span class="s1">&#39;mysql&#39;</span> to be installed
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:22:in &#39;block (3 levels) in from_file&#39;</span>

2<span class="o">)</span> Audit Mode mysql service should be enabled
  Failure/Error: expect<span class="o">(</span>mysql_service<span class="o">)</span>.to be_enabled
    expected Service <span class="s1">&#39;mysql&#39;</span> to be enabled
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:35:in &#39;block (3 levels) in from_file&#39;</span>

3<span class="o">)</span> Audit Mode mysql service should be running
   Failure/Error: expect<span class="o">(</span>mysql_service<span class="o">)</span>.to be_running
    expected Service <span class="s1">&#39;mysql&#39;</span> to be running
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:38:in &#39;block (3 levels) in from_file&#39;</span>

4<span class="o">)</span> Audit Mode mysql config directory should exist with correct permissions
  Failure/Error: expect<span class="o">(</span>config_dir<span class="o">)</span>.to be_directory
    expected <span class="sb">`</span>File <span class="s1">&#39;/etc/mysql&#39;</span>.directory?<span class="sb">`</span> to <span class="k">return</span> true, got <span class="nb">false</span>
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:45:in &#39;block (3 levels) in from_file&#39;</span>

5<span class="o">)</span> Audit Mode mysql config directory should be owned by the db user
  Failure/Error: expect<span class="o">(</span>config_dir<span class="o">)</span>.to be_owned_by<span class="o">(</span><span class="s1">&#39;db_service_user&#39;</span><span class="o">)</span>
    expected <span class="sb">`</span>File <span class="s1">&#39;/etc/mysql&#39;</span>.owned_by?<span class="o">(</span><span class="s1">&#39;db_service_user&#39;</span><span class="o">)</span><span class="sb">`</span> to <span class="k">return</span> true, got <span class="nb">false</span>
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:49:in &#39;block (3 levels) in from_file&#39;</span>

6<span class="o">)</span> Audit Mode mysql config file should exist with correct permissions
  Failure/Error: expect<span class="o">(</span>config_file<span class="o">)</span>.to be_file
    expected <span class="sb">`</span>File <span class="s1">&#39;/etc/mysql/my.cnf&#39;</span>.file?<span class="sb">`</span> to <span class="k">return</span> true, got <span class="nb">false</span>
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:56:in &#39;block (3 levels) in from_file&#39;</span>

7<span class="o">)</span> Audit Mode mysql config file should contain required configuration
  Failure/Error: expect<span class="o">(</span>config_file.content<span class="o">)</span>.to match<span class="o">(</span>/default-time-zone<span class="o">=</span><span class="s1">&#39;UTC&#39;</span>/<span class="o">)</span>
    expected <span class="s1">&#39;-n\n&#39;</span> to match /default-time-zone<span class="o">=</span><span class="s1">&#39;UTC&#39;</span>/
    Diff:
    @@ -1,2 +1,2 @@
    -/default-time-zone<span class="o">=</span><span class="s1">&#39;UTC&#39;</span>/
    +-n
  <span class="c1"># /var/chef/cache/cookbooks/grantmc/recipes/default.rb:60:in &#39;block (3 levels) in from_file&#39;</span>

Finished in 0.5745 seconds <span class="o">(</span>files took 0.46481 seconds to load<span class="o">)</span>
<span class="m">8</span> examples, <span class="m">7</span> failures

Failed examples:

rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:21 <span class="c1"># Audit Mode mysql package should be installed</span>
rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:34 <span class="c1"># Audit Mode mysql service should be enabled</span>
rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:37 <span class="c1"># Audit Mode mysql service should be running</span>
rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:44 <span class="c1"># Audit Mode mysql config directory should exist with correct permissions</span>
rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:48 <span class="c1"># Audit Mode mysql config directory should be owned by the db user</span>
rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:55 <span class="c1"># Audit Mode mysql config file should exist with correct permissions</span>
rspec /var/chef/cache/cookbooks/grantmc/recipes/default.rb:59 <span class="c1"># Audit Mode mysql config file should contain required configuration</span>
Auditing <span class="nb">complete</span>
</pre></div>
</div>
<p><strong>Duplicate control_group names</strong></p>
<p>If two <tt class="docutils literal"><span class="pre">control_group</span></tt> blocks have the same name, the chef-client will raise an exception. For example, the following <tt class="docutils literal"><span class="pre">control_group</span></tt> blocks exist in different cookbooks:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;basic control group&#39;</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">&#39;should pass&#39;</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">control_group</span> <span class="s1">&#39;basic control group&#39;</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">&#39;should pass&#39;</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Because the two <tt class="docutils literal"><span class="pre">control_group</span></tt> block names are identical, the chef-client will return an exception similar to:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Synchronizing</span> <span class="ss">Cookbooks</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">audit_test</span>
<span class="no">Compiling</span> <span class="no">Cookbooks</span><span class="o">...</span>

<span class="o">================================================================================</span>
<span class="no">Recipe</span> <span class="no">Compile</span> <span class="no">Error</span> <span class="k">in</span> <span class="sr">/Users/</span><span class="n">grantmc</span><span class="o">/.</span><span class="n">cache</span><span class="o">/</span><span class="n">chef</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">cookbooks</span>
                        <span class="sr">/audit_test/</span><span class="n">recipes</span><span class="o">/</span><span class="n">error_duplicate_control_groups</span><span class="o">.</span><span class="n">rb</span>
<span class="o">================================================================================</span>

<span class="no">Chef</span><span class="o">::</span><span class="no">Exceptions</span><span class="o">::</span><span class="no">AuditControlGroupDuplicate</span>
<span class="o">--------------------------------------------</span>
<span class="no">Audit</span> <span class="n">control</span> <span class="n">group</span> <span class="n">with</span> <span class="nb">name</span> <span class="s1">&#39;basic control group&#39;</span> <span class="n">has</span> <span class="n">already</span> <span class="n">been</span> <span class="n">defined</span>

<span class="no">Cookbook</span> <span class="ss">Trace</span><span class="p">:</span>
<span class="o">---------------</span>
<span class="sr">/Users/</span><span class="n">grantmc</span><span class="o">/.</span><span class="n">cache</span><span class="o">/</span><span class="n">chef</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">cookbooks</span>
<span class="sr">/audit_test/</span><span class="n">recipes</span><span class="o">/</span><span class="n">error_duplicate_control_groups</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">13</span><span class="ss">:in</span> <span class="s1">&#39;from_file&#39;</span>

<span class="no">Relevant</span> <span class="no">File</span> <span class="ss">Content</span><span class="p">:</span>
<span class="o">----------------------</span>
<span class="sr">/Users/</span><span class="n">grantmc</span><span class="o">/.</span><span class="n">cache</span><span class="o">/</span><span class="n">chef</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">cookbooks</span><span class="o">/</span><span class="n">audit_test</span><span class="o">/</span><span class="n">recipes</span><span class="o">/</span><span class="n">error_duplicate_control_groups</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span>

<span class="n">control_group</span> <span class="s1">&#39;basic control group&#39;</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">&#39;should pass&#39;</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">control_group</span> <span class="s1">&#39;basic control group&#39;</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">&#39;should pass&#39;</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">Running</span> <span class="ss">handlers</span><span class="p">:</span>
<span class="o">[</span><span class="mi">2015</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span><span class="ss">T09</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">14</span><span class="o">-</span><span class="mi">08</span><span class="p">:</span><span class="mo">00</span><span class="o">]</span> <span class="ss">ERROR</span><span class="p">:</span> <span class="no">Running</span> <span class="n">exception</span> <span class="n">handlers</span>
<span class="no">Running</span> <span class="n">handlers</span> <span class="n">complete</span>
</pre></div>
</div>
<p><strong>Verify a package is installed</strong></p>
<p>The following <tt class="docutils literal"><span class="pre">control_group</span></tt> verifies that the <tt class="docutils literal"><span class="pre">git</span></tt> package has been installed:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">package</span> <span class="s1">&#39;git&#39;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>

<span class="n">execute</span> <span class="s1">&#39;list packages&#39;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s1">&#39;dpkg -l&#39;</span>
<span class="k">end</span>

<span class="n">execute</span> <span class="s1">&#39;list directory&#39;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s1">&#39;ls -R ~&#39;</span>
<span class="k">end</span>

<span class="n">control_group</span> <span class="s1">&#39;my audits&#39;</span> <span class="k">do</span>
  <span class="n">control</span> <span class="s1">&#39;check git&#39;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">&#39;should be installed&#39;</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">package</span><span class="p">(</span><span class="s1">&#39;git&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span> <span class="n">be_installed</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cookbook-name">
<h3>cookbook_name<a class="headerlink" href="#cookbook-name" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">cookbook_name</span></tt> method to return the name of a cookbook.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">cookbook_name</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">cookbook_name</span>
</pre></div>
</div>
<p>This method is often used as part of a log entry. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Chef</span><span class="o">::</span><span class="no">Log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;I am a message from the #{recipe_name} recipe in the #{cookbook_name} cookbook.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="data-bag">
<h3>data_bag<a class="headerlink" href="#data-bag" title="Permalink to this headline">¶</a></h3>
<p>A data bag is a global variable that is stored as JSON data and is accessible from a Chef server. A data bag is indexed for searching and can be loaded by a recipe or accessed during a search.</p>
<p>Use the <tt class="docutils literal"><span class="pre">data_bag</span></tt> method to get a list of the contents of a data bag.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">data_bag</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">data_bag</span><span class="p">(</span><span class="n">bag_name</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Examples</strong></p>
<p>The following example shows how the <tt class="docutils literal"><span class="pre">data_bag</span></tt> method can be used in a recipe.</p>
<p><strong>Get a data bag, and then iterate through each data bag item</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">data_bag</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="c1">#=&gt; [&#39;sandy&#39;, &#39;jill&#39;]</span>
</pre></div>
</div>
<p>Iterate over the contents of the data bag to get the associated <tt class="docutils literal"><span class="pre">data_bag_item</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">data_bag</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span>
  <span class="n">data_bag_item</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">id</span></tt> for each data bag item will be returned as a string.</p>
</div>
<div class="section" id="data-bag-item">
<h3>data_bag_item<a class="headerlink" href="#data-bag-item" title="Permalink to this headline">¶</a></h3>
<p>A data bag is a global variable that is stored as JSON data and is accessible from a Chef server. A data bag is indexed for searching and can be loaded by a recipe or accessed during a search.</p>
<p>The <tt class="docutils literal"><span class="pre">data_bag_item</span></tt> method can be used in a recipe to get the contents of a data bag item.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">data_bag_item</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">data_bag_item</span><span class="p">(</span><span class="n">bag_name</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">secret</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">secret</span></tt> is the secret used to load an encrypted data bag. If <tt class="docutils literal"><span class="pre">secret</span></tt> is not specified, the chef-client looks for a secret at the path specified by the <tt class="docutils literal"><span class="pre">encrypted_data_bag_secret</span></tt> setting in the client.rb file.</p>
<p><strong>Examples</strong></p>
<p>The following examples show how the <tt class="docutils literal"><span class="pre">data_bag_item</span></tt> method can be used in a recipe.</p>
<p><strong>Get a data bag, and then iterate through each data bag item</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">data_bag</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="c1">#=&gt; [&#39;sandy&#39;, &#39;jill&#39;]</span>
</pre></div>
</div>
<p>Iterate over the contents of the data bag to get the associated <tt class="docutils literal"><span class="pre">data_bag_item</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">data_bag</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span>
  <span class="n">data_bag_item</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">id</span></tt> for each data bag item will be returned as a string.</p>
<p><strong>Use the contents of a data bag in a recipe</strong></p>
<p>The following example shows how to use the <tt class="docutils literal"><span class="pre">data_bag</span></tt> and <tt class="docutils literal"><span class="pre">data_bag_item</span></tt> methods in a recipe, also using a data bag named <tt class="docutils literal"><span class="pre">sea-power</span></tt>):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">package</span> <span class="s1">&#39;sea-power&#39;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>

<span class="n">directory</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;sea-power&#39;</span><span class="o">][</span><span class="s1">&#39;base_path&#39;</span><span class="o">]</span> <span class="k">do</span>
  <span class="c1"># attributes for owner, group, mode</span>
<span class="k">end</span>

<span class="n">gale_warnings</span> <span class="o">=</span> <span class="n">data_bag</span><span class="p">(</span><span class="s1">&#39;sea-power&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">viking_north</span><span class="o">|</span>
  <span class="n">data_bag_item</span><span class="p">(</span><span class="s1">&#39;sea-power&#39;</span><span class="p">,</span> <span class="n">viking_north</span><span class="p">)</span><span class="o">[</span><span class="s1">&#39;source&#39;</span><span class="o">]</span>
<span class="k">end</span>

<span class="n">template</span> <span class="s1">&#39;/etc/seattle/power.list&#39;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">&#39;seattle-power.erb&#39;</span>
  <span class="c1"># attributes for owner, group, mode</span>
  <span class="n">variables</span><span class="p">(</span>
    <span class="ss">:base_path</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;sea-power&#39;</span><span class="o">][</span><span class="s1">&#39;base_path&#39;</span><span class="o">]</span><span class="p">,</span>
    <span class="c1"># more variables</span>
    <span class="ss">:repo_location</span> <span class="o">=&gt;</span> <span class="n">gale_warnings</span>
  <span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For a more complete version of the previous example, see the default recipe in the <a class="reference external" href="https://github.com/hw-cookbooks/apt-mirror">https://github.com/hw-cookbooks/apt-mirror</a> community cookbook.</p>
</div>
<div class="section" id="declare-resource">
<h3>declare_resource<a class="headerlink" href="#declare-resource" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">declare_resource</span></tt> method to instantiate a resource and then add it to the resource collection.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">declare_resource</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">declare_resource</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">,</span> <span class="n">resource_attrs_block</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
<li><tt class="docutils literal"><span class="pre">resource_attrs_block</span></tt> is a block in which properties of the instantiated resource are declared.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">declare_resource</span><span class="p">(</span><span class="ss">:file</span><span class="p">,</span> <span class="s1">&#39;/x/y.txy&#39;</span><span class="p">,</span> <span class="nb">caller</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
<span class="k">end</span>
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="s1">&#39;/x/y.txt&#39;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-resource">
<h3>delete_resource<a class="headerlink" href="#delete-resource" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">delete_resource</span></tt> method to find a resource in the resource collection, and then delete it.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">delete_resource</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">delete_resource</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">delete_resource</span><span class="p">(</span><span class="ss">:template</span><span class="p">,</span> <span class="s1">&#39;/x/y.erb&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>delete_resource!<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">delete_resource!</span></tt> method to find a resource in the resource collection, and then delete it. If the resource is not found, an exception is returned.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">delete_resource!</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">delete_resource!</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">delete_resource!</span><span class="p">(</span><span class="ss">:file</span><span class="p">,</span> <span class="s1">&#39;/x/file.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="edit-resource">
<h3>edit_resource<a class="headerlink" href="#edit-resource" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">edit_resource</span></tt> method to:</p>
<ul class="simple">
<li>Find a resource in the resource collection, and then edit it.</li>
<li>Define a resource block. If a resource block with the same name exists in the resource collection, it will be updated with the contents of the resource block defined by the <tt class="docutils literal"><span class="pre">edit_resource</span></tt> method. If a resource block does not exist in the resource collection, it will be created.</li>
</ul>
<p>The syntax for the <tt class="docutils literal"><span class="pre">edit_resource</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">edit_resource</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">,</span> <span class="n">resource_attrs_block</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
<li><tt class="docutils literal"><span class="pre">resource_attrs_block</span></tt> is a block in which properties of the instantiated resource are declared.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">edit_resource</span><span class="p">(</span><span class="ss">:template</span><span class="p">,</span> <span class="s1">&#39;/x/y.txy&#39;</span><span class="p">)</span> <span class="k">do</span>
  <span class="ss">cookbook_name</span><span class="p">:</span> <span class="n">cookbook_name</span>
<span class="k">end</span>
</pre></div>
</div>
<p>and a resource block:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">edit_resource</span><span class="p">(</span><span class="ss">:template</span><span class="p">,</span> <span class="s1">&#39;/etc/aliases&#39;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">&#39;aliases.erb&#39;</span>
  <span class="n">cookbook</span> <span class="s1">&#39;aliases&#39;</span>
  <span class="n">variables</span><span class="p">({</span><span class="ss">:aliases</span> <span class="o">=&gt;</span> <span class="p">{}</span> <span class="p">})</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s1">&#39;execute[newaliases]&#39;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>edit_resource!<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">edit_resource!</span></tt> method to:</p>
<ul class="simple">
<li>Find a resource in the resource collection, and then edit it.</li>
<li>Define a resource block. If a resource with the same name exists in the resource collection, its properties will be updated with the contents of the resource block defined by the <tt class="docutils literal"><span class="pre">edit_resource</span></tt> method.</li>
</ul>
<p>In both cases, if the resource is not found, an exception is returned.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">edit_resource!</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">edit_resource!</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
<li><tt class="docutils literal"><span class="pre">resource_attrs_block</span></tt> is a block in which properties of the instantiated resource are declared.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">edit_resource!</span><span class="p">(</span><span class="ss">:file</span><span class="p">,</span> <span class="s1">&#39;/x/y.rst&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="find-resource">
<h3>find_resource<a class="headerlink" href="#find-resource" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">find_resource</span></tt> method to:</p>
<ul class="simple">
<li>Find a resource in the resource collection.</li>
<li>Define a resource block. If a resource block with the same name exists in the resource collection, it will be returned. If a resource block does not exist in the resource collection, it will be created.</li>
</ul>
<p>The syntax for the <tt class="docutils literal"><span class="pre">find_resource</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">find_resource</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">find_resource</span><span class="p">(</span><span class="ss">:template</span><span class="p">,</span> <span class="s1">&#39;/x/y.txy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and a resource block:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">find_resource</span><span class="p">(</span><span class="ss">:template</span><span class="p">,</span> <span class="s1">&#39;/etc/seapower&#39;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">&#39;seapower.erb&#39;</span>
  <span class="n">cookbook</span> <span class="s1">&#39;seapower&#39;</span>
  <span class="n">variables</span><span class="p">({</span><span class="ss">:seapower</span> <span class="o">=&gt;</span> <span class="p">{}</span> <span class="p">})</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s1">&#39;execute[newseapower]&#39;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>find_resource!<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">find_resource!</span></tt> method to find a resource in the resource collection. If the resource is not found, an exception is returned.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">find_resource!</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">find_resource!</span><span class="p">(</span><span class="ss">:resource_type</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:resource_type</span></tt> is the resource type, such as <tt class="docutils literal"><span class="pre">:file</span> <span class="pre">``(for</span> <span class="pre">the</span> <span class="pre">**file**</span> <span class="pre">resource),</span> <span class="pre">``:template</span></tt> (for the <strong>template</strong> resource), and so on. Any resource available to Chef may be declared.</li>
<li><tt class="docutils literal"><span class="pre">resource_name</span></tt> the property that is the default name of the resource, typically the string that appears in the <tt class="docutils literal"><span class="pre">resource</span> <span class="pre">'name'</span> <span class="pre">do</span></tt> block of a resource (but not always); see the Syntax section for the resource to be declared to verify the default name property.</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">find_resource!</span><span class="p">(</span><span class="ss">:template</span><span class="p">,</span> <span class="s1">&#39;/x/y.erb&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="platform">
<h3>platform?<a class="headerlink" href="#platform" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">platform?</span></tt> method to ensure that certain actions are run for specific platform. The <tt class="docutils literal"><span class="pre">platform?</span></tt> method will return true if one of the listed parameters matches the <tt class="docutils literal"><span class="pre">node['platform']</span></tt> attribute that is detected by Ohai during every chef-client run.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">platform?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">platform?</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">parameter</span></tt> is a comma-separated list, each specifying a platform, such as Red Hat, CentOS, or Fedora</li>
<li><tt class="docutils literal"><span class="pre">platform?</span></tt> method is typically used with an <tt class="docutils literal"><span class="pre">if</span></tt>, <tt class="docutils literal"><span class="pre">elseif</span></tt>, or <tt class="docutils literal"><span class="pre">case</span></tt> statement that contains Ruby code that is specific for the platform, if detected</li>
</ul>
<div class="section" id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h4>
<p>The following parameters can be used with this method:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Platforms</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">aix</span></tt></td>
<td>AIX. All platform variants of AIX return <tt class="docutils literal"><span class="pre">aix</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">arch</span></tt></td>
<td>Arch Linux</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">debian</span></tt></td>
<td>Debian, Linux Mint, Ubuntu</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">fedora</span></tt></td>
<td>Fedora</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">freebsd</span></tt></td>
<td>FreeBSD. All platform variants of FreeBSD return <tt class="docutils literal"><span class="pre">freebsd</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">gentoo</span></tt></td>
<td>Gentoo</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">hpux</span></tt></td>
<td>HP-UX. All platform variants of HP-UX return <tt class="docutils literal"><span class="pre">hpux</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mac_os_x</span></tt></td>
<td>Mac OS X</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">netbsd</span></tt></td>
<td>NetBSD. All platform variants of NetBSD return <tt class="docutils literal"><span class="pre">netbsd</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">openbsd</span></tt></td>
<td>OpenBSD. All platform variants of OpenBSD return <tt class="docutils literal"><span class="pre">openbsd</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">slackware</span></tt></td>
<td>Slackware</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">solaris</span></tt></td>
<td>Solaris. For Solaris-related platforms, the <tt class="docutils literal"><span class="pre">platform_family</span></tt> method does not support the Solaris platform family and will default back to <tt class="docutils literal"><span class="pre">platform_family</span> <span class="pre">=</span> <span class="pre">platform</span></tt>. For example, if the platform is OmniOS, the <tt class="docutils literal"><span class="pre">platform_family</span></tt> is <tt class="docutils literal"><span class="pre">omnios</span></tt>, if the platform is SmartOS, the <tt class="docutils literal"><span class="pre">platform_family</span></tt> is <tt class="docutils literal"><span class="pre">smartos</span></tt>, and so on. All platform variants of Solaris return <tt class="docutils literal"><span class="pre">solaris</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">suse</span></tt></td>
<td>openSUSE, SUSE Enterprise Linux Server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows</span></tt></td>
<td>Microsoft Windows. All platform variants of Microsoft Windows return <tt class="docutils literal"><span class="pre">windows</span></tt>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ohai collects platform information at the start of the chef-client run and stores that information in the <tt class="docutils literal"><span class="pre">node['platform']</span></tt> attribute.</p>
</div>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">platform?</span><span class="p">(</span><span class="s1">&#39;debian&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">platform?</span><span class="p">(</span><span class="s1">&#39;rhel&#39;</span><span class="p">,</span> <span class="s1">&#39;debian&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h4>Examples<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>The following example shows how the <tt class="docutils literal"><span class="pre">platform?</span></tt> method can be used in a recipe.</p>
<p><strong>Use an if statement with the platform recipe DSL method</strong></p>
<p>The following example shows how an if statement can be used with the <tt class="docutils literal"><span class="pre">platform?</span></tt> method in the Recipe DSL to run code specific to Microsoft Windows. The code is defined using the <strong>ruby_block</strong> resource:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="c1"># the following code sample comes from the ``client`` recipe</span>
<span class="c1"># in the following cookbook: https://github.com/chef-cookbooks/mysql</span>

<span class="k">if</span> <span class="n">platform?</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">)</span>
  <span class="n">ruby_block</span> <span class="s1">&#39;copy libmysql.dll into ruby path&#39;</span> <span class="k">do</span>
    <span class="n">block</span> <span class="k">do</span>
      <span class="nb">require</span> <span class="s1">&#39;fileutils&#39;</span>
      <span class="no">FileUtils</span><span class="o">.</span><span class="n">cp</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;mysql&#39;</span><span class="o">][</span><span class="s1">&#39;client&#39;</span><span class="o">][</span><span class="s1">&#39;lib_dir&#39;</span><span class="o">]</span><span class="si">}</span><span class="se">\\</span><span class="s2">libmysql.dll&quot;</span><span class="p">,</span>
        <span class="n">node</span><span class="o">[</span><span class="s1">&#39;mysql&#39;</span><span class="o">][</span><span class="s1">&#39;client&#39;</span><span class="o">][</span><span class="s1">&#39;ruby_dir&#39;</span><span class="o">]</span>
    <span class="k">end</span>
    <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;mysql&#39;</span><span class="o">][</span><span class="s1">&#39;client&#39;</span><span class="o">][</span><span class="s1">&#39;ruby_dir&#39;</span><span class="o">]</span><span class="si">}</span><span class="se">\\</span><span class="s2">libmysql.dll&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="platform-family">
<h3>platform_family?<a class="headerlink" href="#platform-family" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">platform_family?</span></tt> method to ensure that certain actions are run for specific platform family. The <tt class="docutils literal"><span class="pre">platform_family?</span></tt> method will return true if one of the listed parameters matches the <tt class="docutils literal"><span class="pre">node['platform_family']</span></tt> attribute that is detected by Ohai during every chef-client run.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">platform_family?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">platform_family?</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'parameter'</span></tt> is a comma-separated list, each specifying a platform family, such as Debian, or Red Hat Enterprise Linux</li>
<li><tt class="docutils literal"><span class="pre">platform_family?</span></tt> method is typically used with an <tt class="docutils literal"><span class="pre">if</span></tt>, <tt class="docutils literal"><span class="pre">elseif</span></tt>, or <tt class="docutils literal"><span class="pre">case</span></tt> statement that contains Ruby code that is specific for the platform family, if detected</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">&#39;rhel&#39;</span><span class="p">)</span>
  <span class="c1"># do RHEL things</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">&#39;debian&#39;</span><span class="p">,</span> <span class="s1">&#39;rhel&#39;</span><span class="p">)</span>
  <span class="c1"># do things on debian and rhel families</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">platform_family?</span><span class="p">(</span><span class="s1">&#39;gentoo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">platform_family?</span><span class="p">(</span><span class="s1">&#39;slackware&#39;</span><span class="p">,</span> <span class="s1">&#39;suse&#39;</span><span class="p">,</span> <span class="s1">&#39;arch&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">platform_family?</span></tt> will default to <tt class="docutils literal"><span class="pre">platform?</span></tt> when <tt class="docutils literal"><span class="pre">platform_family?</span></tt> is not explicitly defined.</p>
</div>
<div class="section" id="id6">
<h4>Examples<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The following examples show how the <tt class="docutils literal"><span class="pre">platform_family?</span></tt> method can be used in a recipe.</p>
<p><strong>Use a specific binary for a specific platform</strong></p>
<p>The following is an example of using the <tt class="docutils literal"><span class="pre">platform_family?</span></tt> method in the Recipe DSL to create a variable that can be used with other resources in the same recipe. In this example, <tt class="docutils literal"><span class="pre">platform_family?</span></tt> is being used to ensure that a specific binary is used for a specific platform before using the <strong>remote_file</strong> resource to download a file from a remote location, and then using the <strong>execute</strong> resource to install that file by running a command.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">&#39;rhel&#39;</span><span class="p">)</span>
  <span class="n">pip_binary</span> <span class="o">=</span> <span class="s1">&#39;/usr/bin/pip&#39;</span>
<span class="k">else</span>
  <span class="n">pip_binary</span> <span class="o">=</span> <span class="s1">&#39;/usr/local/bin/pip&#39;</span>
<span class="k">end</span>

<span class="n">remote_file</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span><span class="si">}</span><span class="s2">/distribute_setup.py&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">&#39;http://python-distribute.org/distribute_setup.py&#39;</span>
  <span class="n">mode</span> <span class="s1">&#39;0755&#39;</span>
  <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">pip_binary</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>

<span class="n">execute</span> <span class="s1">&#39;install-pip&#39;</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span>
  <span class="n">command</span> <span class="o">&lt;&lt;-</span><span class="no">EOF</span>
<span class="sh">    # command for installing Python goes here</span>
<span class="no">    EOF</span>
  <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">pip_binary</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where a command for installing Python might look something like:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="c1">#{node[&#39;python&#39;][&#39;binary&#39;]} distribute_setup.py</span>
<span class="c1">#{::File.dirname(pip_binary)}/easy_install pip</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reboot-pending">
<h3>reboot_pending?<a class="headerlink" href="#reboot-pending" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">reboot_pending?</span></tt> method to test if a node needs a reboot, or is expected to reboot. <tt class="docutils literal"><span class="pre">reboot_pending?</span></tt> returns <tt class="docutils literal"><span class="pre">true</span></tt> when the node needs a reboot.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">reboot_pending?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">reboot_pending?</span>
</pre></div>
</div>
</div>
<div class="section" id="recipe-name">
<h3>recipe_name<a class="headerlink" href="#recipe-name" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">recipe_name</span></tt> method to return the name of a recipe.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">recipe_name</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">recipe_name</span>
</pre></div>
</div>
<p>This method is often used as part of a log entry. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Chef</span><span class="o">::</span><span class="no">Log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;I am a message from the #{recipe_name} recipe in the #{cookbook_name} cookbook.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="resources">
<h3>resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">resources</span></tt> method to look up a resource in the resource collection. The <tt class="docutils literal"><span class="pre">resources</span></tt> method returns the value for the resource that it finds in the resource collection. The preferred syntax for the <tt class="docutils literal"><span class="pre">resources</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">resources</span><span class="p">(</span><span class="s1">&#39;resource_type[resource_name]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>but the following syntax can also be used:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">resources</span><span class="p">(</span><span class="ss">:resource_type</span> <span class="o">=&gt;</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where in either approach <tt class="docutils literal"><span class="pre">resource_type</span></tt> is the name of a resource and <tt class="docutils literal"><span class="pre">resource_name</span></tt> is the name of a resource that can be configured by the chef-client.</p>
<p>The <tt class="docutils literal"><span class="pre">resources</span></tt> method can be used to modify a resource later on in a recipe. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="s1">&#39;/etc/hosts&#39;</span> <span class="k">do</span>
  <span class="n">content</span> <span class="s1">&#39;127.0.0.1 localhost.localdomain localhost&#39;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>and then later in the same recipe, or elsewhere:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">resources</span><span class="p">(</span><span class="s1">&#39;file[/etc/hosts]&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">mode</span> <span class="s1">&#39;0644&#39;</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">file</span></tt> is the type of resource, <tt class="docutils literal"><span class="pre">/etc/hosts</span></tt> is the name, and <tt class="docutils literal"><span class="pre">f.mode</span></tt> is used to set the <tt class="docutils literal"><span class="pre">mode</span></tt> property on the <strong>file</strong> resource.</p>
</div>
<div class="section" id="search">
<h3>search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h3>
<p>Search indexes allow queries to be made for any type of data that is indexed by the Chef server, including data bags (and data bag items), environments, nodes, and roles. A defined query syntax is used to support search patterns like exact, wildcard, range, and fuzzy. A search is a full-text query that can be done from several locations, including from within a recipe, by using the <tt class="docutils literal"><span class="pre">search</span></tt> subcommand in knife, the <tt class="docutils literal"><span class="pre">search</span></tt> method in the Recipe DSL, the search box in the Chef management console, and by using the <tt class="docutils literal"><span class="pre">/search</span></tt> or <tt class="docutils literal"><span class="pre">/search/INDEX</span></tt> endpoints in the Chef server API. The search engine is based on Apache Solr and is run from the Chef server.</p>
<p>Use the <tt class="docutils literal"><span class="pre">search</span></tt> method to perform a search query against the Chef server from within a recipe.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">search</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">search</span><span class="p">(</span><span class="ss">:index</span><span class="p">,</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:index</span></tt> is of name of the index on the Chef server against which the search query will run: <tt class="docutils literal"><span class="pre">:client</span></tt>, <tt class="docutils literal"><span class="pre">:data_bag_name</span></tt>, <tt class="docutils literal"><span class="pre">:environment</span></tt>, <tt class="docutils literal"><span class="pre">:node</span></tt>, and <tt class="docutils literal"><span class="pre">:role</span></tt></li>
<li><tt class="docutils literal"><span class="pre">'query'</span></tt> is a valid search query against an object on the Chef server (see below for more information about how to build the query)</li>
</ul>
<p>For example, using the results of a search query within a variable:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">webservers</span> <span class="o">=</span> <span class="n">search</span><span class="p">(</span><span class="ss">:node</span><span class="p">,</span> <span class="s1">&#39;role:webserver&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and then using the results of that query to populate a template:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="s1">&#39;/tmp/list_of_webservers&#39;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">&#39;list_of_webservers.erb&#39;</span>
  <span class="n">variables</span><span class="p">(</span><span class="ss">:webservers</span> <span class="o">=&gt;</span> <span class="n">webservers</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="section" id="filter-result">
<h4>:filter_result<a class="headerlink" href="#filter-result" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">:filter_result</span></tt> as part of a search query to filter the search output based on the pattern specified by a Hash. Only attributes in the Hash will be returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prior to chef-client 12.0, this functionality was available from the <tt class="docutils literal"><span class="pre">partial_search</span></tt> cookbook and was referred to as &#8220;partial search&#8221;.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">search</span></tt> method that uses <tt class="docutils literal"><span class="pre">:filter_result</span></tt> is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">search</span><span class="p">(</span><span class="ss">:index</span><span class="p">,</span> <span class="s1">&#39;query&#39;</span><span class="p">,</span>
  <span class="ss">:filter_result</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;abc&#39;</span> <span class="o">]</span><span class="p">,</span>
                      <span class="s1">&#39;bar&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;123&#39;</span> <span class="o">]</span><span class="p">,</span>
                      <span class="s1">&#39;baz&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;sea&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span> <span class="o">]</span>
                    <span class="p">}</span>
      <span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;foo&#39;</span><span class="o">]</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;bar&#39;</span><span class="o">]</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;baz&#39;</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:index</span></tt> is of name of the index on the Chef server against which the search query will run: <tt class="docutils literal"><span class="pre">:client</span></tt>, <tt class="docutils literal"><span class="pre">:data_bag_name</span></tt>, <tt class="docutils literal"><span class="pre">:environment</span></tt>, <tt class="docutils literal"><span class="pre">:node</span></tt>, and <tt class="docutils literal"><span class="pre">:role</span></tt></li>
<li><tt class="docutils literal"><span class="pre">'query'</span></tt> is a valid search query against an object on the Chef server</li>
<li><tt class="docutils literal"><span class="pre">:filter_result</span></tt> defines a Hash of values to be returned</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">search</span><span class="p">(</span><span class="ss">:node</span><span class="p">,</span> <span class="s1">&#39;role:web&#39;</span><span class="p">,</span>
  <span class="ss">:filter_result</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;name&#39;</span> <span class="o">]</span><span class="p">,</span>
                      <span class="s1">&#39;ip&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;ipaddress&#39;</span> <span class="o">]</span><span class="p">,</span>
                      <span class="s1">&#39;kernel_version&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span> <span class="o">]</span>
                    <span class="p">}</span>
      <span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">]</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;ip&#39;</span><span class="o">]</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;kernel_version&#39;</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="query-syntax">
<h4>Query Syntax<a class="headerlink" href="#query-syntax" title="Permalink to this headline">¶</a></h4>
<p>A search query is comprised of two parts: the key and the search pattern. A search query has the following syntax:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="ss">key</span><span class="p">:</span><span class="n">search_pattern</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">key</span></tt> is a field name that is found in the JSON description of an indexable object on the Chef server (a role, node, client, environment, or data bag) and <tt class="docutils literal"><span class="pre">search_pattern</span></tt> defines what will be searched for, using one of the following search patterns: exact, wildcard, range, or fuzzy matching. Both <tt class="docutils literal"><span class="pre">key</span></tt> and <tt class="docutils literal"><span class="pre">search_pattern</span></tt> are case-sensitive; <tt class="docutils literal"><span class="pre">key</span></tt> has limited support for multiple character wildcard matching using an asterisk (&#8220;*&#8221;) (and as long as it is not the first character).</p>
<div class="section" id="keys">
<h5>Keys<a class="headerlink" href="#keys" title="Permalink to this headline">¶</a></h5>
<p>A field name/description pair is available in the JSON object. Use the field name when searching for this information in the JSON object. Any field that exists in any JSON description for any role, node, chef-client, environment, or data bag can be searched.</p>
<p><strong>Nested Fields</strong></p>
<p>A nested field appears deeper in the JSON data structure. For example, information about a network interface might be several layers deep: <tt class="docutils literal"><span class="pre">node[:network][:interfaces][:en1]</span></tt>. When nested fields are present in a JSON structure, the chef-client will extract those nested fields to the top-level, flattening them into compound fields that support wildcard search patterns.</p>
<p>By combining wildcards with range-matching patterns and wildcard queries, it is possible to perform very powerful searches, such as using the vendor part of the MAC address to find every node that has a network card made by the specified vendor.</p>
<p>Consider the following snippet of JSON data:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;network&quot;</span><span class="o">:</span>
  <span class="p">[</span>
  <span class="c1">//snipped...</span>
    <span class="s2">&quot;interfaces&quot;</span><span class="p">,</span>
      <span class="p">{</span><span class="s2">&quot;en1&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;number&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flags&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;UP&quot;</span><span class="p">,</span>
          <span class="s2">&quot;BROADCAST&quot;</span><span class="p">,</span>
          <span class="s2">&quot;SMART&quot;</span><span class="p">,</span>
          <span class="s2">&quot;RUNNING&quot;</span><span class="p">,</span>
          <span class="s2">&quot;SIMPLEX&quot;</span><span class="p">,</span>
          <span class="s2">&quot;MULTICAST&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;addresses&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;fe80::fa1e:dfff:fed8:63a2&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;scope&quot;</span><span class="o">:</span> <span class="s2">&quot;Link&quot;</span><span class="p">,</span>
            <span class="s2">&quot;prefixlen&quot;</span><span class="o">:</span> <span class="s2">&quot;64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;family&quot;</span><span class="o">:</span> <span class="s2">&quot;inet6&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;f8:1e:df:d8:63:a2&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;family&quot;</span><span class="o">:</span> <span class="s2">&quot;lladdr&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;192.168.0.195&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;netmask&quot;</span><span class="o">:</span> <span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;broadcast&quot;</span><span class="o">:</span> <span class="s2">&quot;192.168.0.255&quot;</span><span class="p">,</span>
            <span class="s2">&quot;family&quot;</span><span class="o">:</span> <span class="s2">&quot;inet&quot;</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;mtu&quot;</span><span class="o">:</span> <span class="s2">&quot;1500&quot;</span><span class="p">,</span>
        <span class="s2">&quot;media&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;supported&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;autoselect&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;options&quot;</span><span class="o">:</span> <span class="p">[</span>

              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;selected&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;autoselect&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;options&quot;</span><span class="o">:</span> <span class="p">[</span>

              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;en&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
        <span class="s2">&quot;encapsulation&quot;</span><span class="o">:</span> <span class="s2">&quot;Ethernet&quot;</span>
      <span class="p">},</span>
  <span class="c1">//snipped...</span>
</pre></div>
</div>
<p>Before this data is indexed on the Chef server, the nested fields are extracted into the top level, similar to:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&quot;broadcast&quot; =&gt; &quot;192.168.0.255&quot;,
&quot;flags&quot;     =&gt; [&quot;UP&quot;, &quot;BROADCAST&quot;, &quot;SMART&quot;, &quot;RUNNING&quot;, &quot;SIMPLEX&quot;, &quot;MULTICAST&quot;]
&quot;mtu&quot;       =&gt; &quot;1500&quot;
</pre></div>
</div>
<p>which allows searches like the following to find data that is present in this node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="s2">&quot;broadcast:192.168.0.*&quot;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="s2">&quot;mtu:1500&quot;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="s2">&quot;flags:UP&quot;</span>
</pre></div>
</div>
<p>This data is also flattened into various compound fields, which follow the same pattern as the JSON hierarchy and use underscores (<tt class="docutils literal"><span class="pre">_</span></tt>) to separate the levels of data, similar to:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span># ...snip...
&quot;network_interfaces_en1_addresses_192.168.0.195_broadcast&quot; =&gt; &quot;192.168.0.255&quot;,
&quot;network_interfaces_en1_addresses_fe80::fa1e:tldr_family&quot;  =&gt; &quot;inet6&quot;,
&quot;network_interfaces_en1_addresses&quot;                         =&gt; [&quot;fe80::fa1e:tldr&quot;,&quot;f8:1e:df:tldr&quot;,&quot;192.168.0.195&quot;]
# ...snip...
</pre></div>
</div>
<p>which allows searches like the following to find data that is present in this node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="s2">&quot;network_interfaces_en1_addresses:192.168.0.195&quot;</span>
</pre></div>
</div>
<p>This flattened data structure also supports using wildcard compound fields, which allow searches to omit levels within the JSON data structure that are not important to the search query. In the following example, an asterisk (<tt class="docutils literal"><span class="pre">*</span></tt>) is used to show where the wildcard can exist when searching for a nested field:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="s2">&quot;network_interfaces_*_flags&quot;</span>     <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;UP&quot;</span><span class="p">,</span> <span class="s2">&quot;BROADCAST&quot;</span><span class="p">,</span> <span class="s2">&quot;SMART&quot;</span><span class="p">,</span> <span class="s2">&quot;RUNNING&quot;</span><span class="p">,</span> <span class="s2">&quot;SIMPLEX&quot;</span><span class="p">,</span> <span class="s2">&quot;MULTICAST&quot;</span><span class="o">]</span>
<span class="s2">&quot;network_interfaces_*_addresses&quot;</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;fe80::fa1e:dfff:fed8:63a2&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.0.195&quot;</span><span class="p">,</span> <span class="s2">&quot;f8:1e:df:d8:63:a2&quot;</span><span class="o">]</span>
<span class="s2">&quot;network_interfaces_en0_media_*&quot;</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;autoselect&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;1000baseT&quot;</span><span class="p">,</span> <span class="s2">&quot;10baseT/UTP&quot;</span><span class="p">,</span> <span class="s2">&quot;100baseTX&quot;</span><span class="o">]</span>
<span class="s2">&quot;network_interfaces_en1_*&quot;</span>       <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;UP&quot;</span><span class="p">,</span> <span class="s2">&quot;BROADCAST&quot;</span><span class="p">,</span> <span class="s2">&quot;SMART&quot;</span><span class="p">,</span> <span class="s2">&quot;RUNNING&quot;</span><span class="p">,</span> <span class="s2">&quot;SIMPLEX&quot;</span><span class="p">,</span> <span class="s2">&quot;MULTICAST&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;fe80::fa1e:dfff:fed8:63a2&quot;</span><span class="p">,</span> <span class="s2">&quot;f8:1e:df:d8:63:a2&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.0.195&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;1500&quot;</span><span class="p">,</span> <span class="s2">&quot;supported&quot;</span><span class="p">,</span> <span class="s2">&quot;selected&quot;</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="s2">&quot;Ethernet&quot;</span><span class="o">]</span>
</pre></div>
</div>
<p>For each of the wildcard examples above, the possible values are shown contained within the brackets. When running a search query, the query syntax for wildcards is to simply omit the name of the node (while preserving the underscores), similar to:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">network_interfaces__flags</span>
</pre></div>
</div>
<p>This query will search within the <tt class="docutils literal"><span class="pre">flags</span></tt> node, within the JSON structure, for each of <tt class="docutils literal"><span class="pre">UP</span></tt>, <tt class="docutils literal"><span class="pre">BROADCAST</span></tt>, <tt class="docutils literal"><span class="pre">SMART</span></tt>, <tt class="docutils literal"><span class="pre">RUNNING</span></tt>, <tt class="docutils literal"><span class="pre">SIMPLEX</span></tt>, and <tt class="docutils literal"><span class="pre">MULTICAST</span></tt>.</p>
</div>
<div class="section" id="patterns">
<h5>Patterns<a class="headerlink" href="#patterns" title="Permalink to this headline">¶</a></h5>
<p>A search pattern is a way to fine-tune search results by returning anything that matches some type of incomplete search query. There are four types of search patterns that can be used when searching the search indexes on the Chef server: exact, wildcard, range, and fuzzy.</p>
<p><strong>Exact Match</strong></p>
<p>An exact matching search pattern is used to search for a key with a name that exactly matches a search query. If the name of the key contains spaces, quotes must be used in the search pattern to ensure the search query finds the key. The entire query must also be contained within quotes, so as to prevent it from being interpreted by Ruby or a command shell. The best way to ensure that quotes are used consistently is to quote the entire query using single quotes (&#8216; &#8216;) and a search pattern with double quotes (&#8221; &#8221;).</p>
<p><strong>Wildcard Match</strong></p>
<p>A wildcard matching search pattern is used to query for substring matches that replace zero (or more) characters in the search pattern with anything that could match the replaced character. There are two types of wildcard searches:</p>
<ul class="simple">
<li>A question mark (<tt class="docutils literal"><span class="pre">?</span></tt>) can be used to replace exactly one character (as long as that character is not the first character in the search pattern)</li>
<li>An asterisk (<tt class="docutils literal"><span class="pre">*</span></tt>) can be used to replace any number of characters (including zero)</li>
</ul>
<p><strong>Range Match</strong></p>
<p>A range matching search pattern is used to query for values that are within a range defined by upper and lower boundaries. A range matching search pattern can be inclusive or exclusive of the boundaries. Use square brackets (&#8220;[ ]&#8221;) to denote inclusive boundaries and curly braces (&#8220;{ }&#8221;) to denote exclusive boundaries and with the following syntax:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">boundary</span> <span class="no">TO</span> <span class="n">boundary</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">TO</span></tt> is required (and must be capitalized).</p>
<p><strong>Fuzzy Match</strong></p>
<p>A fuzzy matching search pattern is used to search based on the proximity of two strings of characters. An (optional) integer may be used as part of the search query to more closely define the proximity. A fuzzy matching search pattern has the following syntax:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="s2">&quot;search_query&quot;</span><span class="o">~</span><span class="n">edit_distance</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">search_query</span></tt> is the string that will be used during the search and <tt class="docutils literal"><span class="pre">edit_distance</span></tt> is the proximity. A tilde (&#8220;~&#8221;) is used to separate the edit distance from the search query.</p>
</div>
<div class="section" id="operators">
<h5>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h5>
<p>An operator can be used to ensure that certain terms are included in the results, are excluded from the results, or are not included even when other aspects of the query match. Searches can use the following operators:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">AND</span></tt></td>
<td>Use to find a match when both terms exist.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">OR</span></tt></td>
<td>Use to find a match if either term exists.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">NOT</span></tt></td>
<td>Use to exclude the term after <tt class="docutils literal"><span class="pre">NOT</span></tt> from the search results.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="special-characters">
<h5>Special Characters<a class="headerlink" href="#special-characters" title="Permalink to this headline">¶</a></h5>
<p>A special character can be used to fine-tune a search query and to increase the accuracy of the search results. The following characters can be included within the search query syntax, but each occurrence of a special character must be escaped with a backslash (<tt class="docutils literal"><span class="pre">\</span></tt>):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="o">+</span>  <span class="o">-</span>  <span class="o">&amp;&amp;</span>  <span class="o">|</span> <span class="o">|</span>  <span class="o">!</span>  <span class="p">(</span> <span class="p">)</span>  <span class="p">{</span> <span class="p">}</span>  <span class="o">[</span> <span class="o">]</span>  <span class="o">^</span>  <span class="s2">&quot;  ~  *  ?  :  \</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="p">\(</span><span class="mi">1</span><span class="p">\</span><span class="o">+</span><span class="mi">1</span><span class="p">\)\:</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id7">
<h4>Examples<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>The following examples show how the <tt class="docutils literal"><span class="pre">search</span></tt> method can be used in a recipe.</p>
<p><strong>Use the search recipe DSL method to find users</strong></p>
<p>The following example shows how to use the <tt class="docutils literal"><span class="pre">search</span></tt> method in the Recipe DSL to search for users:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="c1">#  the following code sample comes from the openvpn cookbook: https://github.com/chef-cookbooks/openvpn</span>

<span class="n">search</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;*:*&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">u</span><span class="o">|</span>
  <span class="n">execute</span> <span class="s2">&quot;generate-openvpn-</span><span class="si">#{</span><span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
    <span class="n">command</span> <span class="s2">&quot;./pkitool </span><span class="si">#{</span><span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cwd</span> <span class="s1">&#39;/etc/openvpn/easy-rsa&#39;</span>
    <span class="n">environment</span><span class="p">(</span>
      <span class="s1">&#39;EASY_RSA&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc/openvpn/easy-rsa&#39;</span><span class="p">,</span>
      <span class="s1">&#39;KEY_CONFIG&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc/openvpn/easy-rsa/openssl.cnf&#39;</span><span class="p">,</span>
      <span class="s1">&#39;KEY_DIR&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key_dir&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;CA_EXPIRE&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;ca_expire&#39;</span><span class="o">].</span><span class="n">to_s</span><span class="p">,</span>
      <span class="s1">&#39;KEY_EXPIRE&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;expire&#39;</span><span class="o">].</span><span class="n">to_s</span><span class="p">,</span>
      <span class="s1">&#39;KEY_SIZE&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;size&#39;</span><span class="o">].</span><span class="n">to_s</span><span class="p">,</span>
      <span class="s1">&#39;KEY_COUNTRY&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;country&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;KEY_PROVINCE&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;province&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;KEY_CITY&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;city&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;KEY_ORG&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;org&#39;</span><span class="o">]</span><span class="p">,</span>
      <span class="s1">&#39;KEY_EMAIL&#39;</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key&#39;</span><span class="o">][</span><span class="s1">&#39;email&#39;</span><span class="o">]</span>
    <span class="p">)</span>
    <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key_dir&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">.crt&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="sx">%w{ conf ovpn }</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ext</span><span class="o">|</span>
    <span class="n">template</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key_dir&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
      <span class="n">source</span> <span class="s1">&#39;client.conf.erb&#39;</span>
      <span class="n">variables</span> <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">execute</span> <span class="s2">&quot;create-openvpn-tar-</span><span class="si">#{</span><span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
    <span class="n">cwd</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key_dir&#39;</span><span class="o">]</span>
    <span class="n">command</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">      tar zcf #{u[&#39;id&#39;]}.tar.gz \</span>
<span class="sh">      ca.crt #{u[&#39;id&#39;]}.crt #{u[&#39;id&#39;]}.key \</span>
<span class="sh">      #{u[&#39;id&#39;]}.conf #{u[&#39;id&#39;]}.ovpn \</span>
<span class="no">    EOH</span>
    <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;openvpn&#39;</span><span class="o">][</span><span class="s1">&#39;key_dir&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">u</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">.tar.gz&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li>the search will use both of the <strong>execute</strong> resources, unless the condition specified by the <tt class="docutils literal"><span class="pre">not_if</span></tt> commands are met</li>
<li>the <tt class="docutils literal"><span class="pre">environments</span></tt> property in the first <strong>execute</strong> resource is being used to define values that appear as variables in the OpenVPN configuration</li>
<li>the <strong>template</strong> resource tells the chef-client which template to use</li>
</ul>
</div>
</div>
<div class="section" id="shell-out">
<h3>shell_out<a class="headerlink" href="#shell-out" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">shell_out</span></tt> method can be used to run a command against the node, and then display the output to the console when the log level is set to <tt class="docutils literal"><span class="pre">debug</span></tt>.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">shell_out</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">shell_out</span><span class="p">(</span><span class="n">command_args</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">command_args</span></tt> is the command that is run against the node.</p>
</div>
<div class="section" id="id8">
<h3>shell_out!<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">shell_out!</span></tt> method can be used to run a command against the node, display the output to the console when the log level is set to <tt class="docutils literal"><span class="pre">debug</span></tt>, and then raise an error when the method returns <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">shell_out!</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">shell_out!</span><span class="p">(</span><span class="n">command_args</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">command_args</span></tt> is the command that is run against the node. This method will return <tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
</div>
<div class="section" id="shell-out-with-systems-locale">
<h3>shell_out_with_systems_locale<a class="headerlink" href="#shell-out-with-systems-locale" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">shell_out_with_systems_locale</span></tt> method can be used to run a command against the node (via the <tt class="docutils literal"><span class="pre">shell_out</span></tt> method), but using the <tt class="docutils literal"><span class="pre">LC_ALL</span></tt> environment variable.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">shell_out_with_systems_locale</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">shell_out_with_systems_locale</span><span class="p">(</span><span class="n">command_args</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">command_args</span></tt> is the command that is run against the node.</p>
</div>
<div class="section" id="tag-tagged-untag">
<h3>tag, tagged?, untag<a class="headerlink" href="#tag-tagged-untag" title="Permalink to this headline">¶</a></h3>
<p>A tag is a custom description that is applied to a node. A tag, once applied, can be helpful when managing nodes using knife or when building recipes by providing alternate methods of grouping similar types of information.</p>
<p>Tags can be added and removed. Machines can be checked to see if they already have a specific tag. To use tags in your recipe simply add the following:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">tag</span><span class="p">(</span><span class="s1">&#39;mytag&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To test if a machine is tagged, add the following:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">tagged?</span><span class="p">(</span><span class="s1">&#39;mytag&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>to return <tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>. <tt class="docutils literal"><span class="pre">tagged?</span></tt> can also use an array as an argument.</p>
<p>To remove a tag:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">untag</span><span class="p">(</span><span class="s1">&#39;mytag&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">tag</span><span class="p">(</span><span class="s1">&#39;machine&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">tagged?</span><span class="p">(</span><span class="s1">&#39;machine&#39;</span><span class="p">)</span>
   <span class="no">Chef</span><span class="o">::</span><span class="no">Log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Hey I&#39;</span><span class="n">m</span> <span class="c1">#{node[:tags]}&#39;)</span>
<span class="k">end</span>

<span class="n">untag</span><span class="p">(</span><span class="s1">&#39;machine&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">tagged?</span><span class="p">(</span><span class="s1">&#39;machine&#39;</span><span class="p">)</span>
   <span class="no">Chef</span><span class="o">::</span><span class="no">Log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;I has no tagz&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Will return something like this:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[Thu, 22 Jul 2010 18:01:45 +0000] INFO: Hey I&#39;m machine
[Thu, 22 Jul 2010 18:01:45 +0000] INFO: I has no tagz
</pre></div>
</div>
</div>
<div class="section" id="value-for-platform">
<h3>value_for_platform<a class="headerlink" href="#value-for-platform" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">value_for_platform</span></tt> method in a recipe to select a value based on the <tt class="docutils literal"><span class="pre">node['platform']</span></tt> and <tt class="docutils literal"><span class="pre">node['platform_version']</span></tt> attributes. These values are detected by Ohai during every chef-client run.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">value_for_platform</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform</span><span class="p">(</span> <span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span> <span class="o">...]</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'platform',</span> <span class="pre">...</span></tt> is a comma-separated list of platforms, such as Red Hat, openSUSE, or Fedora</li>
<li><tt class="docutils literal"><span class="pre">version</span></tt> specifies the version of that platform</li>
<li>Version constraints&#8212;<tt class="docutils literal"><span class="pre">&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;</span></tt>, <tt class="docutils literal"><span class="pre">&gt;=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;=</span></tt>, <tt class="docutils literal"><span class="pre">~&gt;</span></tt>&#8212;may be used with <tt class="docutils literal"><span class="pre">version</span></tt>; an exception is raised if two version constraints match; an exact match will always take precedence over a match made from a version constraint</li>
<li><tt class="docutils literal"><span class="pre">value</span></tt> specifies the value that will be used if the node&#8217;s platform matches the <tt class="docutils literal"><span class="pre">value_for_platform</span></tt> method</li>
</ul>
<p>When each value only has a single platform, use the following syntax:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform</span><span class="p">(</span>
  <span class="s1">&#39;platform&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span> <span class="p">},</span>
  <span class="s1">&#39;platform&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span> <span class="p">},</span>
  <span class="s1">&#39;platform&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>When each value has more than one platform, the syntax changes to:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform</span><span class="p">(</span>
  <span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span> <span class="s1">&#39;platform&#39;</span><span class="p">,</span> <span class="o">...</span> <span class="o">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span>
  <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id9">
<h4>Operators<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>The following operators may be used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">=</span></tt></td>
<td>equal to</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&gt;</span></tt></td>
<td>greater than</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&lt;</span></tt></td>
<td>less than</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&gt;=</span></tt></td>
<td>greater than or equal to; also known as &#8220;optimistically greater than&#8221;, or &#8220;optimistic&#8221;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&lt;=</span></tt></td>
<td>less than or equal to</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">~&gt;</span></tt></td>
<td>approximately greater than; also known as &#8220;pessimistically greater than&#8221;, or &#8220;pessimistic&#8221;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id10">
<h4>Examples<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>The following example will set <tt class="docutils literal"><span class="pre">package_name</span></tt> to <tt class="docutils literal"><span class="pre">httpd</span></tt> for the Red Hat platform and to <tt class="docutils literal"><span class="pre">apache2</span></tt> for the Debian platform:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">package_name</span> <span class="o">=</span> <span class="n">value_for_platform</span><span class="p">(</span>
  <span class="o">[</span><span class="s1">&#39;centos&#39;</span><span class="p">,</span> <span class="s1">&#39;redhat&#39;</span><span class="p">,</span> <span class="s1">&#39;suse&#39;</span><span class="p">,</span> <span class="s1">&#39;fedora&#39;</span> <span class="o">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;httpd&#39;</span>
  <span class="p">},</span>
  <span class="o">[</span><span class="s1">&#39;ubuntu&#39;</span><span class="p">,</span> <span class="s1">&#39;debian&#39;</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;apache2&#39;</span>
  <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The following example will set <tt class="docutils literal"><span class="pre">package</span></tt> to <tt class="docutils literal"><span class="pre">apache-couchdb</span></tt> for OpenBSD platforms, <tt class="docutils literal"><span class="pre">dev-db/couchdb</span></tt> for Gentoo platforms, and <tt class="docutils literal"><span class="pre">couchdb</span></tt> for all other platforms:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">package</span> <span class="o">=</span> <span class="n">value_for_platform</span><span class="p">(</span>
  <span class="s1">&#39;openbsd&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;apache-couchdb&#39;</span> <span class="p">},</span>
  <span class="s1">&#39;gentoo&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dev-db/couchdb&#39;</span> <span class="p">},</span>
  <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;couchdb&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The following example shows using version constraints to specify a value based on the version:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform</span><span class="p">(</span>
  <span class="s1">&#39;os1&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;&lt; 1.0&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;less than 1.0&#39;</span><span class="p">,</span>
             <span class="s1">&#39;~&gt; 2.0&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;version 2.x&#39;</span><span class="p">,</span>
             <span class="s1">&#39;&gt;= 3.0&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;version 3.0&#39;</span><span class="p">,</span>
             <span class="s1">&#39;3.0.1&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;3.0.1 will always use this value&#39;</span> <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="value-for-platform-family">
<h3>value_for_platform_family<a class="headerlink" href="#value-for-platform-family" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">value_for_platform_family</span></tt> method in a recipe to select a value based on the <tt class="docutils literal"><span class="pre">node['platform_family']</span></tt> attribute. This value is detected by Ohai during every chef-client run.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">value_for_platform_family</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform_family</span><span class="p">(</span> <span class="s1">&#39;platform_family&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span> <span class="p">},</span> <span class="o">...</span> <span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'platform_family'</span> <span class="pre">=&gt;</span> <span class="pre">{</span> <span class="pre">'version'</span> <span class="pre">=&gt;</span> <span class="pre">'value'</span> <span class="pre">},</span> <span class="pre">...</span></tt> is a comma-separated list of platforms, such as Fedora, openSUSE, or Red Hat Enterprise Linux</li>
<li><tt class="docutils literal"><span class="pre">value</span></tt> specifies the value that will be used if the node&#8217;s platform family matches the <tt class="docutils literal"><span class="pre">value_for_platform_family</span></tt> method</li>
</ul>
<p>When each value only has a single platform, use the following syntax:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform_family</span><span class="p">(</span>
  <span class="s1">&#39;platform_family&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span> <span class="p">},</span>
  <span class="s1">&#39;platform_family&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span> <span class="p">},</span>
  <span class="s1">&#39;platform_family&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>When each value has more than one platform, the syntax changes to:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">value_for_platform_family</span><span class="p">(</span>
  <span class="o">[</span><span class="s1">&#39;platform_family&#39;</span><span class="p">,</span> <span class="s1">&#39;platform_family&#39;</span><span class="p">,</span> <span class="s1">&#39;platform_family&#39;</span><span class="p">,</span> <span class="s1">&#39;platform_family&#39;</span> <span class="o">]</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
  <span class="o">[</span><span class="s1">&#39;platform_family&#39;</span><span class="p">,</span> <span class="s1">&#39;platform_family&#39;</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
  <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;value&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The following example will set <tt class="docutils literal"><span class="pre">package</span></tt> to <tt class="docutils literal"><span class="pre">httpd-devel</span></tt> for the Red Hat Enterprise Linux, Fedora, and openSUSE platforms and to <tt class="docutils literal"><span class="pre">apache2-dev</span></tt> for the Debian platform:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">package</span> <span class="o">=</span> <span class="n">value_for_platform_family</span><span class="p">(</span>
  <span class="o">[</span><span class="s1">&#39;rhel&#39;</span><span class="p">,</span> <span class="s1">&#39;fedora&#39;</span><span class="p">,</span> <span class="s1">&#39;suse&#39;</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="s1">&#39;httpd-devel&#39;</span><span class="p">,</span>
    <span class="s1">&#39;debian&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;apache2-dev&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="with-run-context">
<h3>with_run_context<a class="headerlink" href="#with-run-context" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">with_run_context</span></tt> method to define a block that has a pointer to a location in the <tt class="docutils literal"><span class="pre">run_context</span></tt> hierarchy. Resources in recipes always run at the root of the <tt class="docutils literal"><span class="pre">run_context</span></tt> hierarchy, whereas custom resources and notification blocks always build a child <tt class="docutils literal"><span class="pre">run_context</span></tt> which contains their sub-resources.</p>
<p>The syntax for the <tt class="docutils literal"><span class="pre">with_run_context</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">with_run_context</span> <span class="ss">:type</span> <span class="k">do</span>
  <span class="c1"># some arbitrary pure Ruby stuff goes here</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">:type</span></tt> may be one of the following:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:root</span></tt> runs the block as part of the root <tt class="docutils literal"><span class="pre">run_context</span></tt> hierarchy</li>
<li><tt class="docutils literal"><span class="pre">:parent</span></tt> runs the block as part of the parent process in the <tt class="docutils literal"><span class="pre">run_context</span></tt> hierarchy</li>
</ul>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">action</span> <span class="ss">:run</span> <span class="k">do</span>
  <span class="n">with_run_context</span> <span class="ss">:root</span> <span class="k">do</span>
    <span class="n">edit_resource</span><span class="p">(</span><span class="ss">:my_thing</span><span class="p">,</span> <span class="s2">&quot;accumulated state&quot;</span><span class="p">)</span> <span class="k">do</span>
      <span class="n">action</span> <span class="ss">:nothing</span>
      <span class="n">my_array_property</span> <span class="o">&lt;&lt;</span> <span class="n">accumulate_some_stuff</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="n">log</span> <span class="s2">&quot;kick it off&quot;</span> <span class="k">do</span>
    <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s2">&quot;my_thing[accumulated state], :delayed</span>
<span class="s2">  end</span>
<span class="s2">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="event-handlers">
<h2>Event Handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Event handlers are not specifically part of the Recipe DSL. An event handler is declared using the <tt class="docutils literal"><span class="pre">Chef.event_hander</span></tt> method, which declares the event handler within recipes in a similar manner to other Recipe DSL methods.</p>
</div>
<p>Use the Handler DSL to attach a callback to an event. If the event occurs during the chef-client run, the associated callback is executed. For example:</p>
<ul class="simple">
<li>Sending email if a chef-client run fails</li>
<li>Sending a notification to chat application if an audit run fails</li>
<li>Aggregating statistics about resources updated during a chef-client runs to StatsD</li>
</ul>
<div class="section" id="on-method">
<h3>on Method<a class="headerlink" href="#on-method" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">on</span></tt> method to associate an event type with a callback. The callback defines what steps are taken if the event occurs during the chef-client run and is defined using arbitrary Ruby code. The syntax is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Chef</span><span class="o">.</span><span class="n">event_handler</span> <span class="k">do</span>
  <span class="n">on</span> <span class="ss">:event_type</span> <span class="k">do</span>
    <span class="c1"># some Ruby</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">Chef.event_handler</span></tt> declares a block of code within a recipe that is processed when the named event occurs during a chef-client run</li>
<li><tt class="docutils literal"><span class="pre">on</span></tt> defines the block of code that will tell the chef-client how to handle the event</li>
<li><tt class="docutils literal"><span class="pre">:event_type</span></tt> is a valid exception event type, such as <tt class="docutils literal"><span class="pre">:run_start</span></tt>, <tt class="docutils literal"><span class="pre">:run_failed</span></tt>, <tt class="docutils literal"><span class="pre">:converge_failed</span></tt>, <tt class="docutils literal"><span class="pre">:resource_failed</span></tt>, or <tt class="docutils literal"><span class="pre">:recipe_not_found</span></tt></li>
</ul>
<p>For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Chef.event_handler <span class="k">do</span>
  on :converge_start <span class="k">do</span>
    puts <span class="s2">&quot;Ohai! I have started a converge.&quot;</span>
  end
end
</pre></div>
</div>
</div>
<div class="section" id="event-types">
<h3>Event Types<a class="headerlink" href="#event-types" title="Permalink to this headline">¶</a></h3>
<p>The following table describes the events that may occur during a chef-client run. Each of these events may be referenced in an <tt class="docutils literal"><span class="pre">on</span></tt> method block by declaring it as the event type.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Event</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:run_start</span></tt></td>
<td>The start of the chef-client run.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:run_started</span></tt></td>
<td>The chef-client run has started.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:ohai_completed</span></tt></td>
<td>The Ohai run has completed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:skipping_registration</span></tt></td>
<td>The chef-client is not registering with the Chef server because it already has a private key or because it does not need one.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:registration_start</span></tt></td>
<td>The chef-client is attempting to create a private key with which to register to the Chef server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:registration_completed</span></tt></td>
<td>The chef-client created its private key successfully.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:registration_failed</span></tt></td>
<td>The chef-client encountered an error and was unable to register with the Chef server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:node_load_start</span></tt></td>
<td>The chef-client is attempting to load node data from the Chef server.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:node_load_failed</span></tt></td>
<td>The chef-client encountered an error and was unable to load node data from the Chef server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:run_list_expand_failed</span></tt></td>
<td>The chef-client failed to expand the run-list.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:node_load_completed</span></tt></td>
<td>The chef-client successfully loaded node data from the Chef server. Default and override attributes for roles have been computed, but are not yet applied.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:policyfile_loaded</span></tt></td>
<td>The policy file was loaded.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:cookbook_resolution_start</span></tt></td>
<td>The chef-client is attempting to pull down the cookbook collection from the Chef server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:cookbook_resolution_failed</span></tt></td>
<td>The chef-client failed to pull down the cookbook collection from the Chef server.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:cookbook_resolution_complete</span></tt></td>
<td>The chef-client successfully pulled down the cookbook collection from the Chef server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:cookbook_clean_start</span></tt></td>
<td>The chef-client is attempting to remove unneeded cookbooks.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:removed_cookbook_file</span></tt></td>
<td>The chef-client removed a file from a cookbook.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:cookbook_clean_complete</span></tt></td>
<td>The chef-client is done removing cookbooks and/or cookbook files.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:cookbook_sync_start</span></tt></td>
<td>The chef-client is attempting to synchronize cookbooks.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:synchronized_cookbook</span></tt></td>
<td>The chef-client is attempting to synchronize the named cookbook.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:updated_cookbook_file</span></tt></td>
<td>The chef-client updated the named file in the named cookbook.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:cookbook_sync_failed</span></tt></td>
<td>The chef-client was unable to synchronize cookbooks.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:cookbook_sync_complete</span></tt></td>
<td>The chef-client is finished synchronizing cookbooks.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:library_load_start</span></tt></td>
<td>The chef-client is loading library files.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:library_file_loaded</span></tt></td>
<td>The chef-client successfully loaded the named library file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:library_file_load_failed</span></tt></td>
<td>The chef-client was unable to load the named library file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:library_load_complete</span></tt></td>
<td>The chef-client is finished loading library files.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:lwrp_load_start</span></tt></td>
<td>The chef-client is loading custom resources.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:lwrp_file_loaded</span></tt></td>
<td>The chef-client successfully loaded the named custom resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:lwrp_file_load_failed</span></tt></td>
<td>The chef-client was unable to load the named custom resource.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:lwrp_load_complete</span></tt></td>
<td>The chef-client is finished loading custom resources.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:attribute_load_start</span></tt></td>
<td>The chef-client is loading attribute files.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:attribute_file_loaded</span></tt></td>
<td>The chef-client successfully loaded the named attribute file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:attribute_file_load_failed</span></tt></td>
<td>The chef-client was unable to load the named attribute file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:attribute_load_complete</span></tt></td>
<td>The chef-client is finished loading attribute files.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:definition_load_start</span></tt></td>
<td>The chef-client is loading definitions.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:definition_file_loaded</span></tt></td>
<td>The chef-client successfully loaded the named definition.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:definition_file_load_failed</span></tt></td>
<td>The chef-client was unable to load the named definition.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:definition_load_complete</span></tt></td>
<td>The chef-client is finished loading definitions.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:recipe_load_start</span></tt></td>
<td>The chef-client is loading recipes.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:recipe_file_loaded</span></tt></td>
<td>The chef-client successfully loaded the named recipe.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:recipe_file_load_failed</span></tt></td>
<td>The chef-client was unable to load the named recipe.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:recipe_not_found</span></tt></td>
<td>The chef-client was unable to find the named recipe.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:recipe_load_complete</span></tt></td>
<td>The chef-client is finished loading recipes.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:converge_start</span></tt></td>
<td>The chef-client run converge phase has started.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:converge_complete</span></tt></td>
<td>The chef-client run converge phase is complete.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:converge_failed</span></tt></td>
<td>The chef-client run converge phase has failed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:audit_phase_start</span></tt></td>
<td>The chef-client run audit phase has started.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:audit_phase_complete</span></tt></td>
<td>The chef-client run audit phase is finished.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:audit_phase_failed</span></tt></td>
<td>The chef-client run audit phase has failed.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:control_group_started</span></tt></td>
<td>The named control group is being processed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:control_example_success</span></tt></td>
<td>The named control group has been processed.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:control_example_failure</span></tt></td>
<td>The named control group&#8217;s processing has failed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:resource_action_start</span></tt></td>
<td>A resource action is starting.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:resource_skipped</span></tt></td>
<td>A resource action was skipped.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:resource_current_state_loaded</span></tt></td>
<td>A resource&#8217;s current state was loaded.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:resource_current_state_load_bypassed</span></tt></td>
<td>A resource&#8217;s current state was not loaded because the resource does not support why-run mode.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:resource_bypassed</span></tt></td>
<td>A resource action was skipped because the resource does not support why-run mode.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:resource_update_applied</span></tt></td>
<td>A change has been made to a resource. (This event occurs for each change made to a resource.)</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:resource_failed_retriable</span></tt></td>
<td>A resource action has failed and will be retried.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:resource_failed</span></tt></td>
<td>A resource action has failed and will not be retried.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:resource_updated</span></tt></td>
<td>A resource requires modification.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:resource_up_to_date</span></tt></td>
<td>A resource is already correct.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:resource_completed</span></tt></td>
<td>All actions for the resource are complete.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:stream_opened</span></tt></td>
<td>A stream has opened.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:stream_closed</span></tt></td>
<td>A stream has closed.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:stream_output</span></tt></td>
<td>A chunk of data from a single named stream.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:handlers_start</span></tt></td>
<td>The handler processing phase of the chef-client run has started.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:handler_executed</span></tt></td>
<td>The named handler was processed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:handlers_completed</span></tt></td>
<td>The handler processing phase of the chef-client run is complete.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:provider_requirement_failed</span></tt></td>
<td>An assertion declared by a provider has failed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:whyrun_assumption</span></tt></td>
<td>An assertion declared by a provider has failed, but execution is allowed to continue because the chef-client is running in why-run mode.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:run_completed</span></tt></td>
<td>The chef-client run has completed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:run_failed</span></tt></td>
<td>The chef-client run has failed.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id11">
<h3>Examples<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>The following examples show ways to use the Handler DSL.</p>
<div class="section" id="send-email">
<h4>Send Email<a class="headerlink" href="#send-email" title="Permalink to this headline">¶</a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">on</span></tt> method to create an event handler that sends email when the chef-client run fails. This will require:</p>
<ul class="simple">
<li>A way to tell the chef-client how to send email</li>
<li>An event handler that describes what to do when the <tt class="docutils literal"><span class="pre">:run_failed</span></tt> event is triggered</li>
<li>A way to trigger the exception and test the behavior of the event handler</li>
</ul>
<p><strong>Define How Email is Sent</strong></p>
<p>Use a library to define the code that sends email when a chef-client run fails. Name the file <tt class="docutils literal"><span class="pre">helper.rb</span></tt> and add it to a cookbook&#8217;s <tt class="docutils literal"><span class="pre">/libraries</span></tt> directory:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">&#39;net/smtp&#39;</span>

<span class="k">module</span> <span class="nn">HandlerSendEmail</span>
  <span class="k">class</span> <span class="nc">Helper</span>

    <span class="k">def</span> <span class="nf">send_email_on_run_failure</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>

      <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;From: Chef &lt;chef@chef.io&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">message</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;To: Grant &lt;grantmc@chef.io&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">message</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Subject: Chef run failed</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">message</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Date: </span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">rfc2822</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
      <span class="n">message</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Chef run failed on </span><span class="si">#{</span><span class="n">node_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="no">Net</span><span class="o">::</span><span class="no">SMTP</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">smtp</span><span class="o">|</span>
        <span class="n">smtp</span><span class="o">.</span><span class="n">send_message</span> <span class="n">message</span><span class="p">,</span> <span class="s1">&#39;chef@chef.io&#39;</span><span class="p">,</span> <span class="s1">&#39;grantmc@chef.io&#39;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Add the Handler</strong></p>
<p>Invoke the library helper in a recipe:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Chef</span><span class="o">.</span><span class="n">event_handler</span> <span class="k">do</span>
  <span class="n">on</span> <span class="ss">:run_failed</span> <span class="k">do</span>
    <span class="no">HandlerSendEmail</span><span class="o">::</span><span class="no">Helper</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">send_email_on_run_failure</span><span class="p">(</span>
      <span class="no">Chef</span><span class="o">.</span><span class="n">run_context</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">name</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<ul class="simple">
<li>Use <tt class="docutils literal"><span class="pre">Chef.event_handler</span></tt> to define the event handler</li>
<li>Use the <tt class="docutils literal"><span class="pre">on</span></tt> method to specify the event type</li>
</ul>
<p>Within the <tt class="docutils literal"><span class="pre">on</span></tt> block, tell the chef-client how to handle the event when it&#8217;s triggered.</p>
<p><strong>Test the Handler</strong></p>
<p>Use the following code block to trigger the exception and have the chef-client send email to the specified email address:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">ruby_block</span> <span class="s1">&#39;fail the run&#39;</span> <span class="k">do</span>
  <span class="n">block</span> <span class="k">do</span>
    <span class="nb">fail</span> <span class="s1">&#39;deliberately fail the run&#39;</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="etcd-locks">
<h4>etcd Locks<a class="headerlink" href="#etcd-locks" title="Permalink to this headline">¶</a></h4>
<p>The following example shows how to prevent concurrent chef-client runs from both holding a lock on etcd:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">lock_key</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">.</span><span class="n">chef_environment</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="no">Chef</span><span class="o">.</span><span class="n">event_handler</span> <span class="k">do</span>
  <span class="n">on</span> <span class="ss">:converge_start</span> <span class="k">do</span> <span class="o">|</span><span class="n">run_context</span><span class="o">|</span>
    <span class="no">Etcd</span><span class="o">.</span><span class="n">lock_acquire</span><span class="p">(</span><span class="n">lock_key</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">Chef</span><span class="o">.</span><span class="n">event_handler</span> <span class="k">do</span>
  <span class="n">on</span> <span class="ss">:converge_complete</span> <span class="k">do</span>
    <span class="no">Etcd</span><span class="o">.</span><span class="n">lock_release</span><span class="p">(</span><span class="n">lock_key</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="hipchat-notifications">
<h4>HipChat Notifications<a class="headerlink" href="#hipchat-notifications" title="Permalink to this headline">¶</a></h4>
<p>Event messages can be sent to a team communication tool like HipChat. For example, if a chef-client run fails:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Chef</span><span class="o">.</span><span class="n">event_handler</span> <span class="k">do</span>
  <span class="n">on</span> <span class="ss">:run_failed</span> <span class="k">do</span> <span class="o">|</span><span class="n">exception</span><span class="o">|</span>
    <span class="n">hipchat_notify</span> <span class="n">exception</span><span class="o">.</span><span class="n">message</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or send an alert on a configuration change:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Chef</span><span class="o">.</span><span class="n">event_handler</span> <span class="k">do</span>
  <span class="n">on</span> <span class="ss">:resource_updated</span> <span class="k">do</span> <span class="o">|</span><span class="n">resource</span><span class="p">,</span> <span class="n">action</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">resource</span><span class="o">.</span><span class="n">to_s</span> <span class="o">==</span> <span class="s1">&#39;template[/etc/nginx/nginx.conf]&#39;</span>
      <span class="no">Helper</span><span class="o">.</span><span class="n">hipchat_message</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">resource</span><span class="si">}</span><span class="s2"> was updated by chef&quot;</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="windows-platform">
<h2>Windows Platform<a class="headerlink" href="#windows-platform" title="Permalink to this headline">¶</a></h2>
<p>Six methods are present in the Recipe DSL to help verify the registry during a chef-client run on the Microsoft Windows platform&#8212;<tt class="docutils literal"><span class="pre">registry_data_exists?</span></tt>, <tt class="docutils literal"><span class="pre">registry_get_subkeys</span></tt>, <tt class="docutils literal"><span class="pre">registry_get_values</span></tt>, <tt class="docutils literal"><span class="pre">registry_has_subkeys?</span></tt>, <tt class="docutils literal"><span class="pre">registry_key_exists?</span></tt>, and <tt class="docutils literal"><span class="pre">registry_value_exists?</span></tt>&#8212;these helpers ensure the <strong>powershell_script</strong> resource is idempotent.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The recommended order in which registry key-specific methods should be used within a recipe is: <tt class="docutils literal"><span class="pre">key_exists?</span></tt>, <tt class="docutils literal"><span class="pre">value_exists?</span></tt>, <tt class="docutils literal"><span class="pre">data_exists?</span></tt>, <tt class="docutils literal"><span class="pre">get_values</span></tt>, <tt class="docutils literal"><span class="pre">has_subkeys?</span></tt>, and then <tt class="docutils literal"><span class="pre">get_subkeys</span></tt>.</p>
</div>
<div class="section" id="registry-data-exists">
<h3>registry_data_exists?<a class="headerlink" href="#registry-data-exists" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">registry_data_exists?</span></tt> method to find out if a Microsoft Windows registry key contains the specified data of the specified type under the value.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method can be used in recipes and from within the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">registry_data_exists?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">registry_data_exists?</span><span class="p">(</span>
  <span class="no">KEY_PATH</span><span class="p">,</span>
  <span class="p">{</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="no">TYPE</span><span class="p">,</span> <span class="ss">:data</span> <span class="o">=&gt;</span> <span class="no">DATA</span> <span class="p">},</span>
  <span class="no">ARCHITECTURE</span>
<span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">KEY_PATH</span></tt> is the path to the registry key value. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <tt class="docutils literal"><span class="pre">HKLM\SECURITY</span></tt> and <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\SECURITY</span></tt> are both valid and equivalent. The following hives are valid: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE</span></tt>, <tt class="docutils literal"><span class="pre">HKLM</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_CONFIG</span></tt>, <tt class="docutils literal"><span class="pre">HKCC</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CLASSES_ROOT</span></tt>, <tt class="docutils literal"><span class="pre">HKCR</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_USERS</span></tt>, <tt class="docutils literal"><span class="pre">HKU</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER</span></tt>, and <tt class="docutils literal"><span class="pre">HKCU</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">{</span> <span class="pre">:name</span> <span class="pre">=&gt;</span> <span class="pre">'NAME',</span> <span class="pre">:type</span> <span class="pre">=&gt;</span> <span class="pre">TYPE,</span> <span class="pre">:data</span> <span class="pre">=&gt;</span> <span class="pre">DATA</span> <span class="pre">}</span></tt> is a hash that contains the expected name, type, and data of the registry key value</li>
<li><tt class="docutils literal"><span class="pre">:type</span></tt> represents the values available for registry keys in Microsoft Windows. Use <tt class="docutils literal"><span class="pre">:binary</span></tt> for REG_BINARY, <tt class="docutils literal"><span class="pre">:string</span></tt> for REG_SZ, <tt class="docutils literal"><span class="pre">:multi_string</span></tt> for REG_MULTI_SZ, <tt class="docutils literal"><span class="pre">:expand_string</span></tt> for REG_EXPAND_SZ, <tt class="docutils literal"><span class="pre">:dword</span></tt> for REG_DWORD, <tt class="docutils literal"><span class="pre">:dword_big_endian</span></tt> for REG_DWORD_BIG_ENDIAN, or <tt class="docutils literal"><span class="pre">:qword</span></tt> for REG_QWORD.</li>
<li><tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> is one of the following values: <tt class="docutils literal"><span class="pre">:x86_64</span></tt>, <tt class="docutils literal"><span class="pre">:i386</span></tt>, or <tt class="docutils literal"><span class="pre">:machine</span></tt>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <tt class="docutils literal"><span class="pre">architecture</span></tt> property must be set to <tt class="docutils literal"><span class="pre">:i386</span></tt>. The <tt class="docutils literal"><span class="pre">:x86_64</span></tt> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<tt class="docutils literal"><span class="pre">:machine</span></tt>) because the chef-client returns an exception if <tt class="docutils literal"><span class="pre">:x86_64</span></tt> is used and the machine turns out to be a 32-bit machine (whereas with <tt class="docutils literal"><span class="pre">:machine</span></tt>, the chef-client is able to access the registry key on the 32-bit machine).</li>
</ul>
<p>This method will return <tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> attribute should only specify <tt class="docutils literal"><span class="pre">:x86_64</span></tt> or <tt class="docutils literal"><span class="pre">:i386</span></tt> when it is necessary to write 32-bit (<tt class="docutils literal"><span class="pre">:i386</span></tt>) or 64-bit (<tt class="docutils literal"><span class="pre">:x86_64</span></tt>) values on a 64-bit machine. <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> will default to <tt class="docutils literal"><span class="pre">:machine</span></tt> unless a specific value is given.</p>
</div>
</div>
<div class="section" id="registry-get-subkeys">
<h3>registry_get_subkeys<a class="headerlink" href="#registry-get-subkeys" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">registry_get_subkeys</span></tt> method to get a list of registry key values that are present for a Microsoft Windows registry key.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method can be used in recipes and from within the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">registry_get_subkeys</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">subkey_array</span> <span class="o">=</span> <span class="n">registry_get_subkeys</span><span class="p">(</span><span class="no">KEY_PATH</span><span class="p">,</span> <span class="no">ARCHITECTURE</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">KEY_PATH</span></tt> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <tt class="docutils literal"><span class="pre">HKLM\SECURITY</span></tt> and <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\SECURITY</span></tt> are both valid and equivalent. The following hives are valid: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE</span></tt>, <tt class="docutils literal"><span class="pre">HKLM</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_CONFIG</span></tt>, <tt class="docutils literal"><span class="pre">HKCC</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CLASSES_ROOT</span></tt>, <tt class="docutils literal"><span class="pre">HKCR</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_USERS</span></tt>, <tt class="docutils literal"><span class="pre">HKU</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER</span></tt>, and <tt class="docutils literal"><span class="pre">HKCU</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> is one of the following values: <tt class="docutils literal"><span class="pre">:x86_64</span></tt>, <tt class="docutils literal"><span class="pre">:i386</span></tt>, or <tt class="docutils literal"><span class="pre">:machine</span></tt>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <tt class="docutils literal"><span class="pre">architecture</span></tt> property must be set to <tt class="docutils literal"><span class="pre">:i386</span></tt>. The <tt class="docutils literal"><span class="pre">:x86_64</span></tt> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<tt class="docutils literal"><span class="pre">:machine</span></tt>) because the chef-client returns an exception if <tt class="docutils literal"><span class="pre">:x86_64</span></tt> is used and the machine turns out to be a 32-bit machine (whereas with <tt class="docutils literal"><span class="pre">:machine</span></tt>, the chef-client is able to access the registry key on the 32-bit machine).</li>
</ul>
<p>This returns an array of registry key values.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> attribute should only specify <tt class="docutils literal"><span class="pre">:x86_64</span></tt> or <tt class="docutils literal"><span class="pre">:i386</span></tt> when it is necessary to write 32-bit (<tt class="docutils literal"><span class="pre">:i386</span></tt>) or 64-bit (<tt class="docutils literal"><span class="pre">:x86_64</span></tt>) values on a 64-bit machine. <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> will default to <tt class="docutils literal"><span class="pre">:machine</span></tt> unless a specific value is given.</p>
</div>
</div>
<div class="section" id="registry-get-values">
<h3>registry_get_values<a class="headerlink" href="#registry-get-values" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">registry_get_values</span></tt> method to get the registry key values (name, type, and data) for a Microsoft Windows registry key.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method can be used in recipes and from within the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">registry_get_values</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">subkey_array</span> <span class="o">=</span> <span class="n">registry_get_values</span><span class="p">(</span><span class="no">KEY_PATH</span><span class="p">,</span> <span class="no">ARCHITECTURE</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">KEY_PATH</span></tt> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <tt class="docutils literal"><span class="pre">HKLM\SECURITY</span></tt> and <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\SECURITY</span></tt> are both valid and equivalent. The following hives are valid: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE</span></tt>, <tt class="docutils literal"><span class="pre">HKLM</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_CONFIG</span></tt>, <tt class="docutils literal"><span class="pre">HKCC</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CLASSES_ROOT</span></tt>, <tt class="docutils literal"><span class="pre">HKCR</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_USERS</span></tt>, <tt class="docutils literal"><span class="pre">HKU</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER</span></tt>, and <tt class="docutils literal"><span class="pre">HKCU</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> is one of the following values: <tt class="docutils literal"><span class="pre">:x86_64</span></tt>, <tt class="docutils literal"><span class="pre">:i386</span></tt>, or <tt class="docutils literal"><span class="pre">:machine</span></tt>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <tt class="docutils literal"><span class="pre">architecture</span></tt> property must be set to <tt class="docutils literal"><span class="pre">:i386</span></tt>. The <tt class="docutils literal"><span class="pre">:x86_64</span></tt> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<tt class="docutils literal"><span class="pre">:machine</span></tt>) because the chef-client returns an exception if <tt class="docutils literal"><span class="pre">:x86_64</span></tt> is used and the machine turns out to be a 32-bit machine (whereas with <tt class="docutils literal"><span class="pre">:machine</span></tt>, the chef-client is able to access the registry key on the 32-bit machine).</li>
</ul>
<p>This returns an array of registry key values.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> attribute should only specify <tt class="docutils literal"><span class="pre">:x86_64</span></tt> or <tt class="docutils literal"><span class="pre">:i386</span></tt> when it is necessary to write 32-bit (<tt class="docutils literal"><span class="pre">:i386</span></tt>) or 64-bit (<tt class="docutils literal"><span class="pre">:x86_64</span></tt>) values on a 64-bit machine. <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> will default to <tt class="docutils literal"><span class="pre">:machine</span></tt> unless a specific value is given.</p>
</div>
</div>
<div class="section" id="registry-has-subkeys">
<h3>registry_has_subkeys?<a class="headerlink" href="#registry-has-subkeys" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">registry_has_subkeys?</span></tt> method to find out if a Microsoft Windows registry key has one (or more) values.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method can be used in recipes and from within the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">registry_has_subkeys?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">registry_has_subkeys?</span><span class="p">(</span><span class="no">KEY_PATH</span><span class="p">,</span> <span class="no">ARCHITECTURE</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">KEY_PATH</span></tt> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <tt class="docutils literal"><span class="pre">HKLM\SECURITY</span></tt> and <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\SECURITY</span></tt> are both valid and equivalent. The following hives are valid: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE</span></tt>, <tt class="docutils literal"><span class="pre">HKLM</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_CONFIG</span></tt>, <tt class="docutils literal"><span class="pre">HKCC</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CLASSES_ROOT</span></tt>, <tt class="docutils literal"><span class="pre">HKCR</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_USERS</span></tt>, <tt class="docutils literal"><span class="pre">HKU</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER</span></tt>, and <tt class="docutils literal"><span class="pre">HKCU</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> is one of the following values: <tt class="docutils literal"><span class="pre">:x86_64</span></tt>, <tt class="docutils literal"><span class="pre">:i386</span></tt>, or <tt class="docutils literal"><span class="pre">:machine</span></tt>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <tt class="docutils literal"><span class="pre">architecture</span></tt> property must be set to <tt class="docutils literal"><span class="pre">:i386</span></tt>. The <tt class="docutils literal"><span class="pre">:x86_64</span></tt> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<tt class="docutils literal"><span class="pre">:machine</span></tt>) because the chef-client returns an exception if <tt class="docutils literal"><span class="pre">:x86_64</span></tt> is used and the machine turns out to be a 32-bit machine (whereas with <tt class="docutils literal"><span class="pre">:machine</span></tt>, the chef-client is able to access the registry key on the 32-bit machine).</li>
</ul>
<p>This method will return <tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> attribute should only specify <tt class="docutils literal"><span class="pre">:x86_64</span></tt> or <tt class="docutils literal"><span class="pre">:i386</span></tt> when it is necessary to write 32-bit (<tt class="docutils literal"><span class="pre">:i386</span></tt>) or 64-bit (<tt class="docutils literal"><span class="pre">:x86_64</span></tt>) values on a 64-bit machine. <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> will default to <tt class="docutils literal"><span class="pre">:machine</span></tt> unless a specific value is given.</p>
</div>
</div>
<div class="section" id="registry-key-exists">
<h3>registry_key_exists?<a class="headerlink" href="#registry-key-exists" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">registry_key_exists?</span></tt> method to find out if a Microsoft Windows registry key exists at the specified path.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method can be used in recipes and from within the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">registry_key_exists?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">registry_key_exists?</span><span class="p">(</span><span class="no">KEY_PATH</span><span class="p">,</span> <span class="no">ARCHITECTURE</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">KEY_PATH</span></tt> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <tt class="docutils literal"><span class="pre">HKLM\SECURITY</span></tt> and <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\SECURITY</span></tt> are both valid and equivalent. The following hives are valid: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE</span></tt>, <tt class="docutils literal"><span class="pre">HKLM</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_CONFIG</span></tt>, <tt class="docutils literal"><span class="pre">HKCC</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CLASSES_ROOT</span></tt>, <tt class="docutils literal"><span class="pre">HKCR</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_USERS</span></tt>, <tt class="docutils literal"><span class="pre">HKU</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER</span></tt>, and <tt class="docutils literal"><span class="pre">HKCU</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> is one of the following values: <tt class="docutils literal"><span class="pre">:x86_64</span></tt>, <tt class="docutils literal"><span class="pre">:i386</span></tt>, or <tt class="docutils literal"><span class="pre">:machine</span></tt>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <tt class="docutils literal"><span class="pre">architecture</span></tt> property must be set to <tt class="docutils literal"><span class="pre">:i386</span></tt>. The <tt class="docutils literal"><span class="pre">:x86_64</span></tt> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<tt class="docutils literal"><span class="pre">:machine</span></tt>) because the chef-client returns an exception if <tt class="docutils literal"><span class="pre">:x86_64</span></tt> is used and the machine turns out to be a 32-bit machine (whereas with <tt class="docutils literal"><span class="pre">:machine</span></tt>, the chef-client is able to access the registry key on the 32-bit machine).</li>
</ul>
<p>This method will return <tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>. (Any registry key values that are associated with this registry key are ignored.)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> attribute should only specify <tt class="docutils literal"><span class="pre">:x86_64</span></tt> or <tt class="docutils literal"><span class="pre">:i386</span></tt> when it is necessary to write 32-bit (<tt class="docutils literal"><span class="pre">:i386</span></tt>) or 64-bit (<tt class="docutils literal"><span class="pre">:x86_64</span></tt>) values on a 64-bit machine. <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> will default to <tt class="docutils literal"><span class="pre">:machine</span></tt> unless a specific value is given.</p>
</div>
</div>
<div class="section" id="registry-value-exists">
<h3>registry_value_exists?<a class="headerlink" href="#registry-value-exists" title="Permalink to this headline">¶</a></h3>
<p>Use the <tt class="docutils literal"><span class="pre">registry_value_exists?</span></tt> method to find out if a registry key value exists. Use <tt class="docutils literal"><span class="pre">registry_data_exists?</span></tt> to test for the type and data of a registry key value.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method can be used in recipes and from within the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p>
</div>
<p>The syntax for the <tt class="docutils literal"><span class="pre">registry_value_exists?</span></tt> method is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">registry_value_exists?</span><span class="p">(</span>
  <span class="no">KEY_PATH</span><span class="p">,</span>
  <span class="p">{</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;NAME&#39;</span> <span class="p">},</span>
  <span class="no">ARCHITECTURE</span>
<span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">KEY_PATH</span></tt> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <tt class="docutils literal"><span class="pre">HKLM\SECURITY</span></tt> and <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\SECURITY</span></tt> are both valid and equivalent. The following hives are valid: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE</span></tt>, <tt class="docutils literal"><span class="pre">HKLM</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_CONFIG</span></tt>, <tt class="docutils literal"><span class="pre">HKCC</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CLASSES_ROOT</span></tt>, <tt class="docutils literal"><span class="pre">HKCR</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_USERS</span></tt>, <tt class="docutils literal"><span class="pre">HKU</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER</span></tt>, and <tt class="docutils literal"><span class="pre">HKCU</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">{</span> <span class="pre">:name</span> <span class="pre">=&gt;</span> <span class="pre">'NAME'</span> <span class="pre">}</span></tt> is a hash that contains the name of the registry key value; if either <tt class="docutils literal"><span class="pre">:type</span></tt> or <tt class="docutils literal"><span class="pre">:value</span></tt> are specified in the hash, they are ignored</li>
<li><tt class="docutils literal"><span class="pre">:type</span></tt> represents the values available for registry keys in Microsoft Windows. Use <tt class="docutils literal"><span class="pre">:binary</span></tt> for REG_BINARY, <tt class="docutils literal"><span class="pre">:string</span></tt> for REG_SZ, <tt class="docutils literal"><span class="pre">:multi_string</span></tt> for REG_MULTI_SZ, <tt class="docutils literal"><span class="pre">:expand_string</span></tt> for REG_EXPAND_SZ, <tt class="docutils literal"><span class="pre">:dword</span></tt> for REG_DWORD, <tt class="docutils literal"><span class="pre">:dword_big_endian</span></tt> for REG_DWORD_BIG_ENDIAN, or <tt class="docutils literal"><span class="pre">:qword</span></tt> for REG_QWORD.</li>
<li><tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> is one of the following values: <tt class="docutils literal"><span class="pre">:x86_64</span></tt>, <tt class="docutils literal"><span class="pre">:i386</span></tt>, or <tt class="docutils literal"><span class="pre">:machine</span></tt>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <tt class="docutils literal"><span class="pre">architecture</span></tt> property must be set to <tt class="docutils literal"><span class="pre">:i386</span></tt>. The <tt class="docutils literal"><span class="pre">:x86_64</span></tt> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<tt class="docutils literal"><span class="pre">:machine</span></tt>) because the chef-client returns an exception if <tt class="docutils literal"><span class="pre">:x86_64</span></tt> is used and the machine turns out to be a 32-bit machine (whereas with <tt class="docutils literal"><span class="pre">:machine</span></tt>, the chef-client is able to access the registry key on the 32-bit machine).</li>
</ul>
<p>This method will return <tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> attribute should only specify <tt class="docutils literal"><span class="pre">:x86_64</span></tt> or <tt class="docutils literal"><span class="pre">:i386</span></tt> when it is necessary to write 32-bit (<tt class="docutils literal"><span class="pre">:i386</span></tt>) or 64-bit (<tt class="docutils literal"><span class="pre">:x86_64</span></tt>) values on a 64-bit machine. <tt class="docutils literal"><span class="pre">ARCHITECTURE</span></tt> will default to <tt class="docutils literal"><span class="pre">:machine</span></tt> unless a specific value is given.</p>
</div>
</div>
<div class="section" id="helpers">
<h3>Helpers<a class="headerlink" href="#helpers" title="Permalink to this headline">¶</a></h3>
<p>A recipe can define specific behaviors for specific Microsoft Windows platform versions by using a series of helper methods. To enable these helper methods, add the following to a recipe:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">&#39;chef/win32/version&#39;</span>
</pre></div>
</div>
<p>Then declare a variable using the <tt class="docutils literal"><span class="pre">Chef::ReservedNames::Win32::Version</span></tt> class:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">variable_name</span> <span class="o">=</span> <span class="no">Chef</span><span class="o">::</span><span class="no">ReservedNames</span><span class="o">::</span><span class="no">Win32</span><span class="o">::</span><span class="no">Version</span><span class="o">.</span><span class="n">new</span>
</pre></div>
</div>
<p>And then use this variable to define specific behaviors for specific Microsoft Windows platform versions. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">variable_name</span><span class="o">.</span><span class="n">helper_name?</span>
  <span class="c1"># Ruby code goes here, such as</span>
  <span class="n">resource_name</span> <span class="k">do</span>
    <span class="c1"># resource block</span>
  <span class="k">end</span>

<span class="k">elsif</span> <span class="n">variable_name</span><span class="o">.</span><span class="n">helper_name?</span>
  <span class="c1"># Ruby code goes here</span>
  <span class="n">resource_name</span> <span class="k">do</span>
    <span class="c1"># resource block for something else</span>
  <span class="k">end</span>

<span class="k">else</span> <span class="n">variable_name</span><span class="o">.</span><span class="n">helper_name?</span>
  <span class="c1"># Ruby code goes here, such as</span>
  <span class="n">log</span> <span class="s1">&#39;log entry&#39;</span> <span class="k">do</span>
    <span class="n">level</span> <span class="ss">:level</span>
  <span class="k">end</span>

<span class="k">end</span>
</pre></div>
</div>
<p>The following Microsoft Windows platform-specific helpers can be used in recipes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Helper</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cluster?</span></tt></td>
<td>Use to test for a Cluster SKU (Windows Server 2003 and later).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">core?</span></tt></td>
<td>Use to test for a Core SKU (Windows Server 2003 and later).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">datacenter?</span></tt></td>
<td>Use to test for a Datacenter SKU.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">marketing_name</span></tt></td>
<td>Use to display the marketing name for a Microsoft Windows platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_7?</span></tt></td>
<td>Use to test for Windows 7.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows_8?</span></tt></td>
<td>Use to test for Windows 8.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_8_1?</span></tt></td>
<td>Use to test for Windows 8.1.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows_2000?</span></tt></td>
<td>Use to test for Windows 2000.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_home_server?</span></tt></td>
<td>Use to test for Windows Home Server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows_server_2003?</span></tt></td>
<td>Use to test for Windows Server 2003.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_server_2003_r2?</span></tt></td>
<td>Use to test for Windows Server 2003 R2.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows_server_2008?</span></tt></td>
<td>Use to test for Windows Server 2008.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_server_2008_r2?</span></tt></td>
<td>Use to test for Windows Server 2008 R2.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows_server_2012?</span></tt></td>
<td>Use to test for Windows Server 2012.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_server_2012_r2?</span></tt></td>
<td>Use to test for Windows Server 2012 R2.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">windows_vista?</span></tt></td>
<td>Use to test for Windows Vista.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">windows_xp?</span></tt></td>
<td>Use to test for Windows XP.</td>
</tr>
</tbody>
</table>
<p>The following example installs Windows PowerShell 2.0 on systems that do not already have it installed. Microsoft Windows platform helper methods are used to define specific behaviors for specific platform versions:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;platform&#39;</span><span class="o">]</span>
<span class="k">when</span> <span class="s1">&#39;windows&#39;</span>

  <span class="nb">require</span> <span class="s1">&#39;chef/win32/version&#39;</span>
  <span class="n">windows_version</span> <span class="o">=</span> <span class="no">Chef</span><span class="o">::</span><span class="no">ReservedNames</span><span class="o">::</span><span class="no">Win32</span><span class="o">::</span><span class="no">Version</span><span class="o">.</span><span class="n">new</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">windows_version</span><span class="o">.</span><span class="n">windows_server_2008_r2?</span> <span class="o">||</span> <span class="n">windows_version</span><span class="o">.</span><span class="n">windows_7?</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">windows_version</span><span class="o">.</span><span class="n">core?</span>

    <span class="n">windows_feature</span> <span class="s1">&#39;NetFx2-ServerCore&#39;</span> <span class="k">do</span>
      <span class="n">action</span> <span class="ss">:install</span>
    <span class="k">end</span>
    <span class="n">windows_feature</span> <span class="s1">&#39;NetFx2-ServerCore-WOW64&#39;</span> <span class="k">do</span>
      <span class="n">action</span> <span class="ss">:install</span>
      <span class="n">only_if</span> <span class="p">{</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;kernel&#39;</span><span class="o">][</span><span class="s1">&#39;machine&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;x86_64&#39;</span> <span class="p">}</span>
    <span class="k">end</span>

  <span class="k">elsif</span> <span class="n">windows_version</span><span class="o">.</span><span class="n">windows_server_2008?</span> <span class="o">||</span> <span class="n">windows_version</span><span class="o">.</span><span class="n">windows_server_2003_r2?</span> <span class="o">||</span>
      <span class="n">windows_version</span><span class="o">.</span><span class="n">windows_server_2003?</span> <span class="o">||</span> <span class="n">windows_version</span><span class="o">.</span><span class="n">windows_xp?</span>

    <span class="k">if</span> <span class="n">windows_version</span><span class="o">.</span><span class="n">windows_server_2008?</span>
      <span class="n">windows_feature</span> <span class="s1">&#39;NET-Framework-Core&#39;</span> <span class="k">do</span>
        <span class="n">action</span> <span class="ss">:install</span>
      <span class="k">end</span>

    <span class="k">else</span>
      <span class="n">windows_package</span> <span class="s1">&#39;Microsoft .NET Framework 2.0 Service Pack 2&#39;</span> <span class="k">do</span>
        <span class="n">source</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;ms_dotnet2&#39;</span><span class="o">][</span><span class="s1">&#39;url&#39;</span><span class="o">]</span>
        <span class="n">checksum</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;ms_dotnet2&#39;</span><span class="o">][</span><span class="s1">&#39;checksum&#39;</span><span class="o">]</span>
        <span class="n">installer_type</span> <span class="ss">:custom</span>
        <span class="n">options</span> <span class="s1">&#39;/quiet /norestart&#39;</span>
        <span class="n">action</span> <span class="ss">:install</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">else</span>
    <span class="n">log</span> <span class="s1">&#39;.NET Framework 2.0 is already enabled on this version of Windows&#39;</span> <span class="k">do</span>
      <span class="n">level</span> <span class="ss">:warn</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">else</span>
  <span class="n">log</span> <span class="s1">&#39;.NET Framework 2.0 cannot be installed on platforms other than Windows&#39;</span> <span class="k">do</span>
    <span class="n">level</span> <span class="ss">:warn</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The previous example is from the <a class="reference external" href="https://github.com/juliandunn/ms_dotnet2">ms_dotnet2 cookbook</a>, created by community member <tt class="docutils literal"><span class="pre">juliandunn</span></tt>.</p>
</div>
</div>
</div>


          </div>


          <div class="footer" role="contentinfo">
                &copy; Copyright: This work is licensed under a Creative Commons Attribution 3.0 Unported License.
              This page is about: current version of Chef.
            <a href="/feedback.html">Provide feedback on Chef documentation</a>.
            </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6369228-7', 'auto', {'legacyCookieDomain': '.chef.io', 'allowLinker': true});
  ga('send', 'pageview');

  var trackOutboundLink = function(url) {
    if (ga.q) {
     document.location = url;
    } else {
      ga('send', 'event', 'outbound', 'click', url, {'hitCallback':
        function () {
          document.location = url;
        }
      });
    }
  };
</script>
<!-- End of Async Google Analytics Code -->

<!-- Start of Marketo Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Marketo Analytics Code -->

<!-- Start of DemandBase Analytics Code -->
<script type="text/javascript">
	(function(d,b,a,s,e){ var t = b.createElement(a),
		fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e;
		t.src=('https:'==document.location.protocol ? 'https://' : 'http://') + s;
		fs.parentNode.insertBefore(t, fs); })
	(window,document,'script','scripts.demandbase.com/zH7sZrWR.min.js','demandbase_js_lib');
</script>
<!-- End of DemandBase Analytics Code -->

<!-- Start of Segment Analytics Code -->
<script type="text/javascript">
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
  analytics.load("RtyoRfLf1ZETiJcIfkKND3Wq1K1LhYHx");
  analytics.page();
  }}();
</script>
<!-- End of Segment Analytics Code -->


        </div>
      </div>

      <div class="clearer"></div>
    </div>

  </div>
  </body>
</html>