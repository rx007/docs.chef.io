<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    
    <title>Runbook &mdash; Chef Docs</title>
    <link rel="stylesheet" href="_static/chefv2.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
    URL_ROOT:    './',
    VERSION:     '',
    COLLAPSE_INDEX: false,
    FILE_SUFFIX: '.html',
    HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="_static/jquery.js"></script>
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/script.js"></script>

    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="next" title="Node Search Query Reference" href="search_query_chef_automate.html" />
    <link rel="prev" title="About Run-lists" href="run_lists.html" /> 
  </head>
  <body role="document">
    <div class="body-wrap">

  <nav class="nav-main" role="navigation" data-topbar>
    <div class="nav-inner">
      <div class="left">
        <h1>
          <a href="https://learn.chef.io">
            <span>Learn Chef</span>
          </a>
        </h1>
      </div>

      <i id="nav-icon" class="fa fa-bars"></i>
      <a href="https://www.chef.io/">
        <img id="logo" src="_static/chef_logo_v2.svg" onerror="_static/chef_logo_v2.png"/>
      </a>

      <ul class="nav-links links-main">
        <li class="nav-link">
          <a href="https://learn.chef.io/tutorials">Tutorials</a>
        </li>
        <li class="nav-link">
          <a href="https://learn.chef.io/skills/">Skills Library</a>
        </li>
        <li class="nav-link is-active">
          <a href="https://docs.chef.io/">Docs</a>
        </li>
        <li class="nav-link">
          <a href="https://www.chef.io/training/">Training</a>
        </li>
      </ul>
    </div>
  </nav>





    <div class="document chef-docs">
    <nav class="nav-docs">
  <ul class="nav-docs-items" id="nav-docs-list">
    <li class="main-item dark-item docs-search">
      <form action="/search.html" method="get">
        <input type="text" placeholder="Search" id="docs-search" name="q">
        <input type="submit" class="submit-button" value="">
        <i class="fa fa-search icon-search"></i>
      </form>
   

    </li>
    
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Overview"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-home icon-left"></i> Overview <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/platform_overview.html" title="Platform Overview">
            Platform Overview
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Community">
            Community
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/community.html" title="About the Community">
                About the Community
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/community_contributions.html" title="Contributing">
                Contributing
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/community_guidelines.html" title="Guidelines">
                Guidelines
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/style_guide.html" title="Docs Style Guide">
                Docs Style Guide
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Packages &amp; Platforms">
            Packages &amp; Platforms
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/packages.html" title="Packages">
                Packages
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/platforms.html" title="Platforms">
                Platforms
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_omnitruck.html" title="Omnitruck API">
                Omnitruck API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_license.html" title="Licensing">
                Licensing
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Chef"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-tasks icon-left"></i> Chef <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items">

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Getting Started">
            Getting Started
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_overview.html" title="Chef Overview">
                Chef Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/quick_start.html" title="Quick Start">
                Quick Start
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_system_requirements.html" title="System Requirements">
                System Requirements
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Release Notes">
                Release Notes
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/release_notes.html" title="Chef Client">
                    Chef Client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_chefdk.html" title="Chef Development Kit">
                    Chef Development Kit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_server.html" title="Chef Server">
                    Chef Server
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_push_jobs.html" title="Chef Push Jobs">
                    Chef Push Jobs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/release_notes_ohai.html" title="Ohai">
                    Ohai
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_deprecations_client.html" title="Deprecations">
                Deprecations
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Tutorials">
            Tutorials
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/learn-the-basics/" title="Learn the Basics">
                Learn the Basics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/manage-a-node/" title="Manage a Node">
                Manage a Node
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/local-development/" title="Get started with Test Kitchen">
                Get started with Test Kitchen
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/manage-a-web-app/" title="Develop a web app cookbook">
                Develop a web app cookbook
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/inspec/" title="Verify with InSpec">
                Verify with InSpec
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/chefspec/" title="Unit test with ChefSpec">
                Unit test with ChefSpec
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/verify-style/" title="Verify code style">
                Verify code style
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/refactor-web-app-cookbook/" title="Refactor the web app cookbook">
                Refactor the web app cookbook
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Concepts">
            Concepts
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/workstation.html" title="Workstation">
                Workstation
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_repo.html" title="chef-repo">
                chef-repo
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/nodes.html" title="Nodes">
                Nodes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_client.html" title="chef-client">
                chef-client
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_components.html" title="Server">
                Server
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_search.html" title="Search">
                Search
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbooks.html" title="Cookbooks">
                Cookbooks
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/handlers.html" title="Handlers">
                Handlers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/manage.html" title="Management Console">
                Management Console
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Policy">
                Policy
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/policy.html" title="About Policy">
                    About Policy
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/data_bags.html" title="Data Bags">
                    Data Bags
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/environments.html" title="Environments">
                    Environments
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/roles.html" title="Roles">
                    Roles
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/push_jobs.html" title="Push Jobs">
                Push Jobs
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/run_lists.html" title="Run-lists">
                Run-lists
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Security">
                Security
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/auth.html#authentication" title="Authentication">
                    Authentication
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/auth.html#authorization" title="Authorization">
                    Authorization
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/chef_private_keys.html" title="Private Keys">
                    Private Keys
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef_client.html#run-in-fips-mode" title="FIPS-mode">
                    FIPS-mode
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Supermarket">
                Supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/supermarket.html#public-supermarket" title="Public Supermarket">
                    Public Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/supermarket.html#private-supermarket" title="Private Supermarket">
                    Private Supermarket
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/windows.html" title="Microsoft Windows">
                Microsoft Windows
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Appendix">
                Appendix
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/environment_variables.html" title="Env Variables">
                    Env Variables
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/errors.html" title="Troubleshooting">
                    Troubleshooting
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/glossary.html" title="Glossary">
                    Glossary
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Setup">
            Setup
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/proxies.html" title="Proxies">
                Proxies
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_dk.html" title="Workstation">
                Workstation
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Nodes">
                Nodes
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/install_bootstrap.html" title="Install via Bootstrap">
                    Install via Bootstrap
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_omnibus.html" title="Install via URL">
                    Install via URL
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_windows.html" title="Install on Windows">
                    Install on Windows
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/junos.html" title="Install on Junos OS">
                    Install on Junos OS
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef_client.html" title="chef-client (executable)">
                    chef-client (executable)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_client.html" title="client.rb">
                    client.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/upgrade_client.html" title="Upgrades">
                    Upgrades
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/chef_client_security.html" title="Security">
                    Security
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Server">
                Server
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="https://manage.chef.io/signup" title="Hosted Chef Server">
                    Hosted Chef Server
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_server.html#standalone" title="Install Standalone">
                    Install Standalone
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_server_ha.html" title="Install High Availability">
                    Install High Availability
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/aws_marketplace.html" title="AWS Marketplace">
                    AWS Marketplace
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/azure_portal.html" title="Microsoft Azure">
                    Microsoft Azure
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/openstack.html" title="Openstack">
                    Openstack
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Supermarket">
                Supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="https://supermarket.chef.io" title="Public Supermarket">
                    Public Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_supermarket.html" title="Install Private Supermarket">
                    Install Private Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_supermarket.html#customize-supermarket" title="Customize Supermarket">
                    Customize Supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/install_supermarket.html#run-supermarket-in-kitchen" title="Run in Test Kitchen">
                    Run in Test Kitchen
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_server.html#install" title="Management Console">
                Management Console
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_push_jobs.html" title="Push Jobs">
                Push Jobs
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Integrations">
                Integrations
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/integrate_compliance_chef_server.html" title="w/Chef Compliance">
                    w/Chef Compliance
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/uninstall.html" title="Uninstall">
                Uninstall
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Cookbook Reference">
            Cookbook Reference
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbooks.html" title="About Cookbooks">
                About Cookbooks
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/attributes.html" title="Attributes">
                Attributes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/definitions.html" title="Definitions">
                Definitions
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/files.html" title="Files">
                Files
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/libraries.html" title="Libraries">
                Libraries
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Recipes">
                Recipes
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/recipes.html" title="About Recipes">
                    About Recipes
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/debug.html" title="Debug Recipes, Client Runs">
                    Debug Recipes, Client Runs
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Recipe DSL">
                Recipe DSL
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#attribute" title="attribute?">
                    attribute?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#control" title="control">
                    control
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#control-group" title="control_group">
                    control_group
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#cookbook-name" title="cookbook_name">
                    cookbook_name
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#data-bag" title="data_bag">
                    data_bag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#data-bag-item" title="data_bag_item">
                    data_bag_item
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#platform" title="platform?">
                    platform?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#platform-family" title="platform_family?">
                    platform_family?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#reboot-pending" title="reboot_pending?">
                    reboot_pending?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#recipe-name" title="recipe_name">
                    recipe_name
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-data-exists" title="registry_data_exists?">
                    registry_data_exists?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-get-subkeys" title="registry_get_subkeys">
                    registry_get_subkeys
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-get-values" title="registry_get_values">
                    registry_get_values
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-has-subkeys" title="registry_has_subkeys?">
                    registry_has_subkeys?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-key-exists" title="registry_key_exists?">
                    registry_key_exists?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#registry-value-exists" title="registry_value_exists?">
                    registry_value_exists?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#resources" title="resources">
                    resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#search" title="search">
                    search
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#shell-out" title="shell_out">
                    shell_out
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#shell-out-bang" title="shell_out!">
                    shell_out!
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#shell-out-with-systems-locale" title="shell_out_with_systems_locale">
                    shell_out_with_systems_locale
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#tag-tagged-untag" title="tag">
                    tag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#tag-tagged-untag" title="tagged?">
                    tagged?
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#tag-tagged-untag" title="untag">
                    untag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#value-for-platform" title="value_for_platform">
                    value_for_platform
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#value-for-platform-family" title="value_for_platform_family">
                    value_for_platform_family
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/dsl_recipe.html#helpers" title="Windows Platform Helpers">
                    Windows Platform Helpers
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Resources">
                Resources
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/resource.html" title="About Resources">
                    About Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_common.html" title="Common Functionality">
                    Common Functionality
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/custom_resources.html" title="Custom Resources">
                    Custom Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resources.html" title="All Resources (Single Page)">
                    All Resources (Single Page)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_apt_package.html" title="apt_package">
                    apt_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_apt_repository.html" title="apt_repository">
                    apt_repository
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_apt_update.html" title="apt_update">
                    apt_update
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_bash.html" title="bash">
                    bash
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_batch.html" title="batch">
                    batch
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_bff_package.html" title="bff_package">
                    bff_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_breakpoint.html" title="breakpoint">
                    breakpoint
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_cab_package.html" title="cab_package">
                    cab_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_gem.html" title="chef_gem">
                    chef_gem
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_acl.html" title="chef_acl">
                    chef_acl
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_client.html" title="chef_client">
                    chef_client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_container.html" title="chef_container">
                    chef_container
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_data_bag_item.html" title="chef_data_bag_item">
                    chef_data_bag_item
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_data_bag.html" title="chef_data_bag">
                    chef_data_bag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_environment.html" title="chef_environment">
                    chef_environment
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_group.html" title="chef_group">
                    chef_group
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_handler.html" title="chef_handler">
                    chef_handler
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_mirror.html" title="chef_mirror">
                    chef_mirror
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_node.html" title="chef_node">
                    chef_node
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_organization.html" title="chef_organization">
                    chef_organization
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_role.html" title="chef_role">
                    chef_role
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chef_user.html" title="chef_user">
                    chef_user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_chocolatey_package.html" title="chocolatey_package">
                    chocolatey_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_cookbook_file.html" title="cookbook_file">
                    cookbook_file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_cron.html" title="cron">
                    cron
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_csh.html" title="csh">
                    csh
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_deploy.html" title="deploy">
                    deploy
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_directory.html" title="directory">
                    directory
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_dpkg_package.html" title="dpkg_package">
                    dpkg_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_dsc_resource.html" title="dsc_resource">
                    dsc_resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_dsc_script.html" title="dsc_script">
                    dsc_script
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_easy_install_package.html" title="easy_install_package">
                    easy_install_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_env.html" title="env">
                    env
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_erlang_call.html" title="erl_call">
                    erl_call
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_execute.html" title="execute">
                    execute
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_file.html" title="file">
                    file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_freebsd_package.html" title="freebsd_package">
                    freebsd_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_gem_package.html" title="gem_package">
                    gem_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_git.html" title="git">
                    git
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_group.html" title="group">
                    group
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_homebrew_package.html" title="homebrew_package">
                    homebrew_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_http_request.html" title="http_request">
                    http_request
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ifconfig.html" title="ifconfig">
                    ifconfig
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ips_package.html" title="ips_package">
                    ips_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ksh.html" title="ksh">
                    ksh
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_launchd.html" title="launchd">
                    launchd
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_link.html" title="link">
                    link
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_log.html" title="log">
                    log
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_macports_package.html" title="macports_package">
                    macports_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_mdadm.html" title="mdadm">
                    mdadm
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_mount.html" title="mount">
                    mount
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_msu_package.html" title="msu_package">
                    msu_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ohai.html" title="ohai">
                    ohai
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_openbsd_package.html" title="openbsd_package">
                    openbsd_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_osx_profile.html" title="osx_profile">
                    osx_profile
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_package.html" title="package">
                    package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_pacman_package.html" title="pacman_package">
                    pacman_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_paludis_package.html" title="paludis_package">
                    paludis_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_perl.html" title="perl">
                    perl
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_portage_package.html" title="portage_package">
                    portage_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_powershell_script.html" title="powershell_script">
                    powershell_script
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_private_key.html" title="private_key">
                    private_key
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_public_key.html" title="public_key">
                    public_key
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_python.html" title="python">
                    python
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_reboot.html" title="reboot">
                    reboot
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_registry_key.html" title="registry_key">
                    registry_key
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_remote_directory.html" title="remote_directory">
                    remote_directory
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_remote_file.html" title="remote_file">
                    remote_file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_route.html" title="route">
                    route
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_rpm_package.html" title="rpm_package">
                    rpm_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ruby.html" title="ruby">
                    ruby
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_ruby_block.html" title="ruby_block">
                    ruby_block
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_script.html" title="script">
                    script
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_service.html" title="service">
                    service
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_smartos_package.html" title="smartos_package">
                    smartos_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_solaris_package.html" title="solaris_package">
                    solaris_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_subversion.html" title="subversion">
                    subversion
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_systemd_unit.html" title="systemd_unit">
                    systemd_unit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_template.html" title="template">
                    template
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_user.html" title="user">
                    user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_windows_package.html" title="windows_package">
                    windows_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_windows_service.html" title="windows_service">
                    windows_service
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_yum.html" title="yum_package">
                    yum_package
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_yum_repository.html" title="yum_repository">
                    yum_repository
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_examples.html" title="Examples (by Resource)">
                    Examples (by Resource)
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/templates.html" title="Templates">
                Templates
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbook_repo.html" title="Cookbook Repo">
                Cookbook Repo
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_metadata.html" title="metadata.rb">
                metadata.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookbook_versions.html" title="Cookbook Versions">
                Cookbook Versions
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ruby.html" title="Ruby">
                Ruby
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Chef DK">
            Chef DK
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/about_chefdk.html" title="About the ChefDK">
                About the ChefDK
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/berkshelf.html" title="Berkshelf">
                Berkshelf
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_apply.html" title="chef-apply (executable)">
                chef-apply (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_shell.html" title="chef-shell (executable)">
                chef-shell (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="chef (executable)">
                chef (executable)
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-env" title="chef env">
                    chef env
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-exec" title="chef exec">
                    chef exec
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-gem" title="chef gem">
                    chef gem
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-app" title="chef generate app">
                    chef generate app
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-attribute" title="chef generate attribute">
                    chef generate attribute
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-cookbook" title="chef generate cookbook">
                    chef generate cookbook
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-file" title="chef generate file">
                    chef generate file
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-lwrp" title="chef generate lwrp">
                    chef generate lwrp
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-recipe" title="chef generate recipe">
                    chef generate recipe
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-repo" title="chef generate repo">
                    chef generate repo
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-generate-template" title="chef generate template">
                    chef generate template
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-provision" title="chef provision">
                    chef provision
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-shell-init" title="chef shell-init">
                    chef shell-init
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef.html#chef-verify" title="chef verify">
                    chef verify
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Chef Solo">
                Chef Solo
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/chef_solo.html" title="About Chef Solo">
                    About Chef Solo
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_chef_solo.html" title="chef-solo (executable)">
                    chef-solo (executable)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_solo.html" title="solo.rb">
                    solo.rb
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_shell.html" title="chef-shell (executable)">
                chef-shell (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_client.html#run-in-local-mode" title="chef-zero (local mode)">
                chef-zero (local mode)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_vault.html" title="chef-vault">
                chef-vault
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chefspec.html" title="ChefSpec">
                ChefSpec
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Configuration">
                Configuration
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/config_rb.html" title="config.rb">
                    config.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_client.html#d-directories" title="Multiple Config Files">
                    Multiple Config Files
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/cookstyle.html" title="cookstyle">
                cookstyle
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_delivery.html" title="Delivery CLI">
                Delivery CLI
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/foodcritic.html" title="Foodcritic">
                Foodcritic
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Test Kitchen">
                Test Kitchen
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/kitchen.html" title="About Test Kitchen">
                    About Test Kitchen
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_kitchen.html" title="kitchen (executable)">
                    kitchen (executable)
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_yml_kitchen.html" title=".kitchen.yml">
                    .kitchen.yml
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_kitchen_vagrant.html" title="kitchen-vagrant">
                    kitchen-vagrant
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Knife">
                Knife
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/knife.html" title="About Knife">
                    About Knife
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_common_options.html" title="Common Options">
                    Common Options
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_using.html" title="Using Knife">
                    Using Knife
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_knife.html" title="knife.rb">
                    knife.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_bootstrap.html" title="knife bootstrap">
                    knife bootstrap
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_client.html" title="knife client">
                    knife client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_configure.html" title="knife configure">
                    knife configure
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_cookbook.html" title="knife cookbook">
                    knife cookbook
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_cookbook_site.html" title="knife cookbook site">
                    knife cookbook site
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_data_bag.html" title="knife data bag">
                    knife data bag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_delete.html" title="knife delete">
                    knife delete
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_deps.html" title="knife deps">
                    knife deps
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_diff.html" title="knife diff">
                    knife diff
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_download.html" title="knife download">
                    knife download
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_edit.html" title="knife edit">
                    knife edit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_environment.html" title="knife environment">
                    knife environment
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_exec.html" title="knife exec">
                    knife exec
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_list.html" title="knife list">
                    knife list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_node.html" title="knife node">
                    knife node
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_raw.html" title="knife raw">
                    knife raw
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_recipe_list.html" title="knife recipe list">
                    knife recipe list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_role.html" title="knife role">
                    knife role
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_search.html" title="knife search">
                    knife search
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_serve.html" title="knife serve">
                    knife serve
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_show.html" title="knife show">
                    knife show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_ssh.html" title="knife ssh">
                    knife ssh
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_ssl_check.html" title="knife ssl_check">
                    knife ssl_check
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_ssl_fetch.html" title="knife ssl_fetch">
                    knife ssl_fetch
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_status.html" title="knife status">
                    knife status
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_tag.html" title="knife tag">
                    knife tag
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_upload.html" title="knife upload">
                    knife upload
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_user.html" title="knife user">
                    knife user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/knife_xargs.html" title="knife xargs">
                    knife xargs
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="knife opc">
                knife opc
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html" title="About knife opc">
                    About knife opc
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#knife-rb-configuration" title="knife.rb Configuration">
                    knife.rb Configuration
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-list" title="opc user list">
                    opc user list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-show" title="opc user show">
                    opc user show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-create" title="opc user create">
                    opc user create
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-delete" title="opc user delete">
                    opc user delete
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-edit" title="opc user edit">
                    opc user edit
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-user-password" title="opc user password">
                    opc user password
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-list" title="opc org list">
                    opc org list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-show" title="opc org show">
                    opc org show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-create" title="opc org create">
                    opc org create
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-delete" title="opc org delete">
                    opc org delete
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-user-add" title="opc org user add">
                    opc org user add
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_opc.html#opc-org-user-remove" title="opc org user remove">
                    opc org user remove
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_spork.html" title="knife spork">
                knife spork
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="knife supermarket">
                knife supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html" title="About knife supermarket">
                    About knife supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#download" title="supermarket download">
                    supermarket download
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#install" title="supermarket install">
                    supermarket install
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#list" title="supermarket list">
                    supermarket list
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#search" title="supermarket search">
                    supermarket search
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#share" title="supermarket share">
                    supermarket share
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#show" title="supermarket show">
                    supermarket show
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html#unshare" title="supermarket unshare">
                    supermarket unshare
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Ohai">
                Ohai
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/ohai.html" title="About Ohai">
                    About Ohai
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_ohai.html" title="ohai (executable)">
                    ohai (executable)
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Policyfile">
                Policyfile
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/policyfile.html" title="About Policyfile">
                    About Policyfile
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_policyfile.html" title="Policyfile.rb">
                    Policyfile.rb
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Provisioning">
                Provisioning
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/provisioning.html" title="About Provisioning">
                    About Provisioning
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_load_balancer.html" title="load_balancer resource">
                    load_balancer resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine.html" title="machine resource">
                    machine resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_batch.html" title="machine_batch resource">
                    machine_batch resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_execute.html" title="machine_execute resource">
                    machine_execute resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_file.html" title="machine_file resource">
                    machine_file resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/resource_machine_image.html" title="machine_image resource">
                    machine_image resource
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/provisioning_aws.html" title="AWS Driver Resources">
                    AWS Driver Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/provisioning_fog.html" title="Fog Driver Resources">
                    Fog Driver Resources
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/provisioning_vagrant.html" title="Vagrant Driver Resources">
                    Vagrant Driver Resources
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_push_jobs_client.html" title="push-jobs-client (executable)">
                push-jobs-client (executable)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/rubocop.html" title="Rubocop">
                Rubocop
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Managing the Server">
            Managing the Server
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/runbook.html" title="Runbook (Single Page)">
                Runbook (Single Page)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_backup_restore.html" title="Backup &amp; Restore">
                Backup &amp; Restore
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_data.html" title="Data Storage">
                Data Storage
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_firewalls_and_ports.html" title="Firewalls &amp; Ports">
                Firewalls &amp; Ports
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_ldap.html" title="Active Directory &amp; LDAP">
                Active Directory &amp; LDAP
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_logs.html" title="Log Files">
                Log Files
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_monitor.html" title="Monitor">
                Monitor
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_orgs.html" title="Organizations &amp; Groups">
                Organizations &amp; Groups
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/secrets.html" title="Secrets">
                Secrets
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_security.html" title="Security">
                Security
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_services.html" title="Services">
                Services
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_tuning.html" title="Tuning">
                Tuning
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_server.html" title="Upgrades">
                Upgrades
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_server_ha_v2.html" title="Upgrade HA Cluster">
                Upgrade HA Cluster
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_users.html" title="Users">
                Users
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_server.html" title="chef-server-ctl">
                chef-server-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_chef_backend.html" title="chef-backend-ctl">
                chef-backend-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_server.html" title="chef-server.rb">
                chef-server.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_opscode_expander.html" title="opscode-expander-ctl">
                opscode-expander-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_chef_server.html" title="Chef Server API">
                Chef Server API
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Push Jobs">
                Push Jobs
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_push_jobs.html" title="knife push jobs">
                    knife push jobs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_push_jobs_client.html" title="push-jobs-client">
                    push-jobs-client
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_push_jobs_client.html" title="push-jobs-client.rb">
                    push-jobs-client.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_push_jobs_server.html" title="push-jobs-server.rb">
                    push-jobs-server.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/api_push_jobs.html" title="Push Jobs API">
                    Push Jobs API
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_sent_events.html" title="Server Sent Events">
                    Server Sent Events
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Supermarket">
                Supermarket
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/supermarket_logs.html" title="Log Files">
                    Log Files
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/supermarket_monitor.html" title="Monitoring">
                    Monitoring
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_supermarket.html" title="supermarket.rb">
                    supermarket.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/plugin_knife_supermarket.html" title="knife supermarket">
                    knife supermarket
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_supermarket.html" title="supermarket-ctl">
                    supermarket-ctl
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/supermarket_api.html" title="Supermarket API">
                    Supermarket API
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Management Console">
                Management Console
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/server_configure_saml.html" title="Configure SAML">
                    Configure SAML
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_clients.html" title="Clients">
                    Clients
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_cookbooks.html" title="Cookbooks">
                    Cookbooks
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_data_bags.html" title="Data Bags">
                    Data Bags
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_environments.html" title="Environments">
                    Environments
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_nodes.html" title="Nodes">
                    Nodes
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_manage_roles.html" title="Roles">
                    Roles
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/server_users.html#chef-manage" title="Users">
                    Users
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/config_rb_manage.html" title="manage.rb">
                    manage.rb
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_manage.html" title="chef-manage-ctl">
                    chef-manage-ctl
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Habitat"> <!-- if item has custom image -->

        <img class="icon-left" src="./_static/habitat-mark.png"></img> Habitat <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/habitat.html" title="Habitat Overview">
            Habitat Overview
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Tutorials">
            Tutorials
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://www.habitat.sh/tutorials/getting-started-overview" title="Getting started">
                Getting started
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="InSpec"> <!-- if item has custom image -->

        <img class="icon-left" src="./_static/inspec_logo.png"></img> InSpec <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/inspec.html" title="InSpec Overview">
            InSpec Overview
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Chef Automate"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-cogs icon-left"></i> Chef Automate <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items">

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Getting Started">
            Getting Started
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_automate.html" title="Chef Automate Overview">
                Chef Automate Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_chef_automate.html" title="Installation Guide">
                Installation Guide
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Tutorials">
            Tutorials
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/automate/install" title="Get Started">
                Get Started
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/automate/visibility" title="Visibility into Infrastructure">
                Visibility into Infrastructure
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/automate/deploy-cookbook/" title="Deploy with Chef Automate">
                Deploy with Chef Automate
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/compliance-assess" title="Assess for Compliance">
                Assess for Compliance
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="https://learn.chef.io/tutorials/compliance-remediate" title="Remediate Compliance Failures">
                Remediate Compliance Failures
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Setup">
            Setup
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_pipeline.html" title="Configure a Pipeline">
                Configure a Pipeline
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_json_delivery.html" title="Configure a Project">
                Configure a Project
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/setup_visibility_chef_automate.html" title="Configure Data Collection">
                Configure Data Collection
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Concepts">
            Concepts
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2">

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Workflow">
                Workflow
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/workflow.html" title="Workflow Overview">
                    Workflow Overview
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_manage_dependencies.html" title="Manage Dependencies">
                    Manage Dependencies
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/visibility.html" title="Visibility Overview">
                Visibility Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/compliance.html" title="Compliance Overview">
                Compliance Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/ctl_delivery.html" title="Delivery CLI">
            Delivery CLI
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Integrations">
            Integrations
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_bitbucket.html" title="w/Bitbucket">
                w/Bitbucket
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_smtp.html" title="w/Email (SMTP)">
                w/Email (SMTP)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_github.html" title="w/GitHub">
                w/GitHub
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_ldap.html" title="w/LDAP">
                w/LDAP
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_chef_automate_saml.html" title="w/SAML">
                w/SAML
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_delivery_slack.html" title="w/Slack">
                w/Slack
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Cookbooks">
            Cookbooks
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_build_cookbook.html" title="build-cookbook (cookbook)">
                build-cookbook (cookbook)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_truck.html" title="delivery-truck (cookbook)">
                delivery-truck (cookbook)
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/publish_cookbooks_multiple_servers.html" title="Publish to Multiple Chef Servers">
                Publish to Multiple Chef Servers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/dsl_delivery.html" title="Workflow DSL">
            Workflow DSL
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/job_dispatch.html" title="Job Dispatch">
            Job Dispatch
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Managing the Server">
            Managing the Server
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2">

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="Backups">
                Backups
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#configuration" title="Configuration">
                    Configuration
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#create-backups" title="Create Backups">
                    Create Backups
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#list-backups" title="List Backups">
                    List Backups
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#delete-backups" title="Delete Backups">
                    Delete Backups
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/delivery_server_backup.html#restore-backups" title="Restore Backups">
                    Restore Backups
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/scaling_capacity_planning_chef_automate.html" title="Capacity Planning">
                Capacity Planning
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_delivery.html" title="Chef Automate API">
                Chef Automate API
              </a>
            </li> <!-- /if subItem2.hasSubItems -->

            <li class="has-sub-items">
              <div class="has-sub-items-content" title="automate-ctl">
                automate-ctl
                <i class="fa fa-chevron-down"></i>
              </div>
              <ul class="sub-items level-3">

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#cleanse" title="cleanse">
                    cleanse
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#create-enterprise" title="create-enterprise">
                    create-enterprise
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#create-user" title="create-user">
                    create-user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-application" title="delete-application">
                    delete-application
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-enterprise" title="delete-enterprise">
                    delete-enterprise
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-project" title="delete-project">
                    delete-project
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-user" title="delete-user">
                    delete-user
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-visibility-node" title="delete-visibility-node">
                    delete-visibility-node
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#delete-visibility-node-by-id" title="delete-visibility-node-by-id">
                    delete-visibility-node-by-id
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#gather-logs" title="gather-logs">
                    gather-logs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#help" title="help">
                    help
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#install-runner" title="install-runner">
                    install-runner
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#list-applications" title="list-applications">
                    list-applications
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#list-enterprises" title="list-enterprises">
                    list-enterprises
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#list-users" title="list-users">
                    list-users
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#migrate-change-description" title="migrate-change-description">
                    migrate-change-description
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#migrate-patchset-diffs" title="migrate-patchset-diffs">
                    migrate-patchset-diffs
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#preflight-check" title="preflight-check">
                    preflight-check
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#reconfigure" title="reconfigure">
                    reconfigure
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#rename-enterprise" title="rename-enterprise">
                    rename-enterprise
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#reset-password" title="reset-password">
                    reset-password
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#restore-backup" title="restore-backup">
                    restore-backup
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#revoke-token" title="revoke-token">
                    revoke-token
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#show-config" title="show-config">
                    show-config
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#uninstall" title="uninstall">
                    uninstall
                  </a>
                </li>

                <li>
                  <a class="nav-docs-link" href="/ctl_delivery_server.html#update-project-hooks" title="update-project-hooks">
                    update-project-hooks
                  </a>
                </li> <!-- /for subItem3 in subItem2.subItems -->

              </ul>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_delivery.html" title="delivery.rb">
                delivery.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_server_disaster_recovery.html" title="Disaster Recovery">
                Disaster Recovery
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/elasticsearch_and_kibana_auth.html" title="Elasticsearch &amp; Kibana Auth">
                Elasticsearch &amp; Kibana Auth
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/manage_indices_chef_automate.html" title="Manage Elasticsearch Indices">
                Manage Elasticsearch Indices
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/search_query_chef_automate.html" title="Node Search Reference">
                Node Search Reference
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_manage_secrets.html" title="Secrets">
                Secrets
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/stream_data_chef_automate.html" title="Stream Data">
                Stream Data
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_server_tuning.html" title="Tuning">
                Tuning
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_chef_automate.html" title="Upgrades">
                Upgrades
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/delivery_users_and_roles.html" title="Users &amp; Roles">
                Users &amp; Roles
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Compliance scanner">
            Compliance scanner
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/compliance.html" title="Overview">
                Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/release_notes_compliance.html" title="Release Notes">
                Release Notes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_compliance.html" title="Installation Guide">
                Installation Guide
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_compliance_chef_server.html" title="Integrate w/Chef Server">
                Integrate w/Chef Server
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/integrate_compliance_chef_automate.html" title="Integrate w/Chef Automate">
                Integrate w/Chef Automate
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_compliance.html" title="Upgrade Compliance">
                Upgrade Compliance
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_compliance.html" title="chef-compliance.rb">
                chef-compliance.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_compliance.html" title="Chef Compliance API">
                Chef Compliance API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/aws_opsworks_chef_automate.html" title="AWS OpsWorks for Chef Automate">
            AWS OpsWorks for Chef Automate
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/troubleshooting_chef_automate.html" title="Troubleshooting">
            Troubleshooting
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Legacy"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-hdd-o icon-left"></i> Legacy <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items">

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Analytics">
            Analytics
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics.html" title="Overview">
                Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/release_notes_analytics.html" title="Release Notes">
                Release Notes
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_analytics.html" title="Install Standalone">
                Install Standalone
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/actions.html" title="Web UI">
                Web UI
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_webui_tasks.html" title="Management Console">
                Management Console
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_nodes_view.html" title="Nodes View">
                Nodes View
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics.html#integrations" title="Integrations">
                Integrations
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_splunk.html" title="Splunk">
                Splunk
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_rules.html" title="Rules">
                Rules
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/analytics_monitor.html" title="Monitor">
                Monitor
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/upgrade_analytics.html" title="Upgrades">
                Upgrades
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/chef_client_analytics.html" title="Chef Client for Analytics">
                Chef Client for Analytics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_analytics.html" title="opscode-analytics-ctl">
                opscode-analytics-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_analytics.html" title="opscode-analytics.rb">
                opscode-analytics.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_analytics.html" title="knife-analytics">
                knife-analytics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_analytics.html" title="Analytics API">
                Analytics API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/dsl_recipe_analytics.html" title="Recipe DSL for Analytics">
                Recipe DSL for Analytics
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Reporting">
            Reporting
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/reporting.html" title="Overview">
                Overview
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/install_reporting.html" title="Install Reporting">
                Install Reporting
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/server_manage_reports.html" title="View Reports">
                View Reports
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_reporting.html" title="knife reporting">
                knife reporting
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ctl_reporting.html" title="opscode-reporting-ctl">
                opscode-reporting-ctl
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/config_rb_reporting.html" title="opscode-reporting.rb">
                opscode-reporting.rb
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/api_reporting.html" title="Reporting API">
                Reporting API
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li>
    <li class="main-item has-sub-items">

      <div class="has-sub-items-content" title="Extension APIs"> <!-- else item does not have custom image and should use FontAwesome icon -->

        <i class="fa fa-clone icon-left"></i> Extension APIs <!-- endif -->

        <i class="fa fa-chevron-down"></i>
      </div>


      <ul class="sub-items"> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/dsl_compliance.html" title="Compliance DSL">
            Compliance DSL
          </a>
        </li>

         <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Handlers">
            Handlers
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/handlers.html#custom-handlers" title="Custom Handlers">
                Custom Handlers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/dsl_handler.html" title="Handler DSL">
                Handler DSL
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_community.html#handlers" title="Community Handlers">
                Community Handlers
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Knife Plugins">
            Knife Plugins
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife.html" title="About Cloud Plugins">
                About Cloud Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_knife_custom.html" title="Custom Plugins">
                Custom Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_community.html#knife" title="Community Plugins">
                Community Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems -->

        <li class="has-sub-items">
          <div class="has-sub-items-content" title="Ohai Plugins">
            Ohai Plugins
            <i class="fa fa-chevron-down"></i>
          </div>
          <ul class="sub-items level-2"> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/ohai_custom.html" title="Custom Plugins">
                Custom Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem2 does not have sub items -->

            <li>
              <a class="nav-docs-link" href="/plugin_community.html#ohai" title="Community Plugins">
                Community Plugins
              </a>
            </li> <!-- /if subItem2.hasSubItems --> <!-- /for subItem2 in subItem.subItems -->

          </ul>
        
        </li> <!-- /if subItem2.hasSubItems --> <!-- if subItem does not have sub items  -->

        <li>
          <a class="nav-docs-link" href="/plugin_community.html#chef-client" title="Chef Client Plugins">
            Chef Client Plugins
          </a>
        </li>

         <!-- /if subItem2.hasSubItems --> <!-- /for subItem in subItems -->

      </ul>
    </li> <!-- /for item in navItems -->
    
    <li class="main-item dark-item">
      <a href="https://github.com/chef/chef-web-docs" title="Available on GitHub">
        <i class="fa fa-github icon-left"></i>
        Available on GitHub
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://www.chef.io/chef/get-chef">
        <i class="fa fa-download icon-left"></i>
        Get Chef
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://docs.chef.io/feedback.html">
        <i class="fa fa-commenting icon-left"></i>
        Send Feedback
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://www.chef.io/support/">
        <i class="fa fa-support icon-left"></i>
        Support
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://docs.chef.io/index.html">
        <i class="fa fa-map-o icon-left"></i>
        Site Map
      </a>
    </li>
    <li class="main-item dark-item">
      <a href="https://docs-archive.chef.io/">
        <i class="fa fa-archive icon-left"></i>
        Archive
      </a>
    </li>
  </ul>
</nav>
      <div class="documentwrapper"><div class="sphinxsidebar" role="navigation" aria-label="main navigation">
  <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Runbook</a><ul>
<li><a class="reference internal" href="#monitor">Monitor</a><ul>
<li><a class="reference internal" href="#monitoring-priorities">Monitoring Priorities</a><ul>
<li><a class="reference internal" href="#disks">Disks</a></li>
<li><a class="reference internal" href="#high-availability">High Availability</a></li>
</ul>
</li>
<li><a class="reference internal" href="#application-checks">Application Checks</a><ul>
<li><a class="reference internal" href="#drbd">DRBD</a></li>
<li><a class="reference internal" href="#id1">Erlang</a><ul>
<li><a class="reference internal" href="#eper-tools"><tt class="docutils literal"><span class="pre">eper</span></tt> tools</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nginx">Nginx</a></li>
<li><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li><a class="reference internal" href="#rabbitmq">RabbitMQ</a></li>
<li><a class="reference internal" href="#redis">Redis</a></li>
<li><a class="reference internal" href="#apache-solr">Apache Solr</a></li>
</ul>
</li>
<li><a class="reference internal" href="#system-checks">System Checks</a><ul>
<li><a class="reference internal" href="#ha-status">ha-status</a></li>
<li><a class="reference internal" href="#opscode-authz">opscode-authz</a></li>
<li><a class="reference internal" href="#opscode-erchef">opscode-erchef</a></li>
<li><a class="reference internal" href="#opscode-expander">opscode-expander</a><ul>
<li><a class="reference internal" href="#search-indexes">Search Indexes</a></li>
<li><a class="reference internal" href="#opscode-expander-ctl">opscode-expander-ctl</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#nodes-workstations">Nodes, Workstations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log-files">Log Files</a><ul>
<li><a class="reference internal" href="#view-log-files">View Log Files</a><ul>
<li><a class="reference internal" href="#tail-log-files">tail Log Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#supervisor">Supervisor</a><ul>
<li><a class="reference internal" href="#nginx-access">nginx, access</a></li>
<li><a class="reference internal" href="#opscode-erchef-current">opscode-erchef, current</a></li>
<li><a class="reference internal" href="#opscode-erchef-erchef">opscode-erchef, erchef</a></li>
</ul>
</li>
<li><a class="reference internal" href="#application">Application</a><ul>
<li><a class="reference internal" href="#id2">nginx</a><ul>
<li><a class="reference internal" href="#read-log-files">Read Log Files</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#firewalls-and-ports">Firewalls and Ports</a><ul>
<li><a class="reference internal" href="#standalone">Standalone</a></li>
<li><a class="reference internal" href="#id3">High Availability</a><ul>
<li><a class="reference internal" href="#front-end">Front End</a></li>
<li><a class="reference internal" href="#back-end">Back End</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tiered">Tiered</a><ul>
<li><a class="reference internal" href="#id4">Front End</a></li>
<li><a class="reference internal" href="#id5">Back End</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chef-analytics">Chef Analytics</a></li>
<li><a class="reference internal" href="#chef-push-jobs">Chef Push Jobs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#services">Services</a><ul>
<li><a class="reference internal" href="#service-subcommands">Service Subcommands</a><ul>
<li><a class="reference internal" href="#hup">hup</a></li>
<li><a class="reference internal" href="#int">int</a></li>
<li><a class="reference internal" href="#kill">kill</a></li>
<li><a class="reference internal" href="#once">once</a></li>
<li><a class="reference internal" href="#restart">restart</a></li>
<li><a class="reference internal" href="#service-list">service-list</a></li>
<li><a class="reference internal" href="#start">start</a></li>
<li><a class="reference internal" href="#status">status</a><ul>
<li><a class="reference internal" href="#id6">High Availability</a></li>
<li><a class="reference internal" href="#id7">Log Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stop">stop</a></li>
<li><a class="reference internal" href="#tail">tail</a></li>
<li><a class="reference internal" href="#term">term</a></li>
</ul>
</li>
<li><a class="reference internal" href="#list-of-services">List of Services</a><ul>
<li><a class="reference internal" href="#bifrost">bifrost</a><ul>
<li><a class="reference internal" href="#id8">status</a></li>
<li><a class="reference internal" href="#id9">start</a></li>
<li><a class="reference internal" href="#id10">stop</a></li>
<li><a class="reference internal" href="#id11">restart</a></li>
<li><a class="reference internal" href="#id12">kill</a></li>
<li><a class="reference internal" href="#run-once">run once</a></li>
<li><a class="reference internal" href="#id13">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bookshelf">bookshelf</a><ul>
<li><a class="reference internal" href="#id14">status</a></li>
<li><a class="reference internal" href="#id15">start</a></li>
<li><a class="reference internal" href="#id16">stop</a></li>
<li><a class="reference internal" href="#id17">restart</a></li>
<li><a class="reference internal" href="#id18">kill</a></li>
<li><a class="reference internal" href="#id19">run once</a></li>
<li><a class="reference internal" href="#id20">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#keepalived">keepalived</a><ul>
<li><a class="reference internal" href="#id21">status</a></li>
<li><a class="reference internal" href="#id22">start</a></li>
<li><a class="reference internal" href="#id23">stop</a></li>
<li><a class="reference internal" href="#id24">restart</a></li>
<li><a class="reference internal" href="#id25">kill</a></li>
<li><a class="reference internal" href="#id26">run once</a></li>
<li><a class="reference internal" href="#id27">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id28">nginx</a><ul>
<li><a class="reference internal" href="#id29">status</a></li>
<li><a class="reference internal" href="#id30">start</a></li>
<li><a class="reference internal" href="#id31">stop</a></li>
<li><a class="reference internal" href="#id32">restart</a></li>
<li><a class="reference internal" href="#id33">kill</a></li>
<li><a class="reference internal" href="#id34">run once</a></li>
<li><a class="reference internal" href="#id35">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id36">opscode-erchef</a><ul>
<li><a class="reference internal" href="#id37">status</a></li>
<li><a class="reference internal" href="#id38">start</a></li>
<li><a class="reference internal" href="#id39">stop</a></li>
<li><a class="reference internal" href="#id40">restart</a></li>
<li><a class="reference internal" href="#id41">kill</a></li>
<li><a class="reference internal" href="#id42">run once</a></li>
<li><a class="reference internal" href="#id43">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id44">opscode-expander</a><ul>
<li><a class="reference internal" href="#id45">status</a></li>
<li><a class="reference internal" href="#id46">start</a></li>
<li><a class="reference internal" href="#id47">stop</a></li>
<li><a class="reference internal" href="#id48">restart</a></li>
<li><a class="reference internal" href="#id49">kill</a></li>
<li><a class="reference internal" href="#id50">run once</a></li>
<li><a class="reference internal" href="#id51">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opscode-solr4">opscode-solr4</a><ul>
<li><a class="reference internal" href="#id52">status</a></li>
<li><a class="reference internal" href="#id53">start</a></li>
<li><a class="reference internal" href="#id54">stop</a></li>
<li><a class="reference internal" href="#id55">restart</a></li>
<li><a class="reference internal" href="#id56">kill</a></li>
<li><a class="reference internal" href="#id57">run once</a></li>
<li><a class="reference internal" href="#id58">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id59">postgresql</a><ul>
<li><a class="reference internal" href="#id60">status</a></li>
<li><a class="reference internal" href="#id61">start</a></li>
<li><a class="reference internal" href="#id62">stop</a></li>
<li><a class="reference internal" href="#id63">restart</a></li>
<li><a class="reference internal" href="#id64">kill</a></li>
<li><a class="reference internal" href="#id65">run once</a></li>
<li><a class="reference internal" href="#id66">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id67">rabbitmq</a><ul>
<li><a class="reference internal" href="#id68">status</a></li>
<li><a class="reference internal" href="#id69">start</a></li>
<li><a class="reference internal" href="#id70">stop</a></li>
<li><a class="reference internal" href="#id71">restart</a></li>
<li><a class="reference internal" href="#id72">kill</a></li>
<li><a class="reference internal" href="#id73">run once</a></li>
<li><a class="reference internal" href="#id74">tail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id75">redis</a><ul>
<li><a class="reference internal" href="#id76">status</a></li>
<li><a class="reference internal" href="#id77">start</a></li>
<li><a class="reference internal" href="#id78">stop</a></li>
<li><a class="reference internal" href="#id79">restart</a></li>
<li><a class="reference internal" href="#id80">kill</a></li>
<li><a class="reference internal" href="#id81">run once</a></li>
<li><a class="reference internal" href="#id82">tail</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security">Security</a><ul>
<li><a class="reference internal" href="#ssl-certificates">SSL Certificates</a><ul>
<li><a class="reference internal" href="#ssl-protocols">SSL Protocols</a></li>
<li><a class="reference internal" href="#id83">Chef Analytics</a></li>
<li><a class="reference internal" href="#knife-chef-client">Knife, chef-client</a></li>
<li><a class="reference internal" href="#private-certificate-authority">Private Certificate Authority</a></li>
<li><a class="reference internal" href="#intermediate-certificates">Intermediate Certificates</a></li>
<li><a class="reference internal" href="#regenerate-certificates">Regenerate Certificates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-rotation">Key Rotation</a><ul>
<li><a class="reference internal" href="#add-client-key">add-client-key</a></li>
<li><a class="reference internal" href="#add-user-key">add-user-key</a></li>
<li><a class="reference internal" href="#delete-client-key">delete-client-key</a></li>
<li><a class="reference internal" href="#delete-user-key">delete-user-key</a></li>
<li><a class="reference internal" href="#list-client-key">list-client-key</a></li>
<li><a class="reference internal" href="#list-user-key">list-user-key</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chef-client-settings">chef-client Settings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#server-tuning">Server Tuning</a><ul>
<li><a class="reference internal" href="#customize-the-config-file">Customize the Config File</a><ul>
<li><a class="reference internal" href="#use-conditions">Use Conditions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recommended-settings">Recommended Settings</a><ul>
<li><a class="reference internal" href="#id84">SSL Protocols</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optional-services-tuning">Optional Services Tuning</a><ul>
<li><a class="reference internal" href="#id85">bookshelf</a></li>
<li><a class="reference internal" href="#id86">opscode-erchef</a></li>
<li><a class="reference internal" href="#id87">opscode-expander</a></li>
<li><a class="reference internal" href="#id88">opscode-solr4</a><ul>
<li><a class="reference internal" href="#available-memory">Available Memory</a></li>
<li><a class="reference internal" href="#large-node-sizes">Large Node Sizes</a></li>
<li><a class="reference internal" href="#update-frequency">Update Frequency</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id89">postgresql</a></li>
<li><a class="reference internal" href="#id90">rabbitmq</a><ul>
<li><a class="reference internal" href="#analytics-queues">Analytics Queues</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#backup-and-restore">Backup and Restore</a><ul>
<li><a class="reference internal" href="#id91">High Availability</a></li>
<li><a class="reference internal" href="#required-directories">Required Directories</a><ul>
<li><a class="reference internal" href="#backup">Backup</a></li>
<li><a class="reference internal" href="#restore">Restore</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chef-server-ctl">chef-server-ctl</a><ul>
<li><a class="reference internal" href="#id92">backup</a></li>
<li><a class="reference internal" href="#id93">restore</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
</div>
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="runbook">
<h1>Runbook<a class="headerlink" href="#runbook" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/runbook.rst">[edit on GitHub]</a></p>
<p>The Chef server acts as a hub for configuration data. The Chef server stores cookbooks, the policies that are applied to nodes, and metadata that describes each registered node that is being managed by the chef-client. Nodes use the chef-client to ask the Chef server for configuration details, such as recipes, templates, and file distributions. The chef-client then does as much of the configuration work as possible on the nodes themselves (and not on the Chef server). This scalable approach distributes the configuration effort throughout the organization.</p>
<p>Starting with the release of Chef server 11, the front-end for the Chef server is written using <a class="reference external" href="http://www.erlang.org/">Erlang</a>, which is a programming language that <a class="reference external" href="http://en.wikipedia.org/wiki/Erlang_%28programming_language%29">first appeared in 1986</a>, was open sourced in 1998, and is excellent with critical enterprise concerns like concurrency, fault-tolerance, and distributed environments. The Chef server can scale to the size of any enterprise and is sometimes referred to as Erchef.</p>
<p>The following diagram shows the various components that are part of a Chef server deployment and how they relate to one another.</p>
<a class="reference internal image-reference" href="_images/server_components.svg"><img src="_images/server_components.svg" width="500px" /></a>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Component</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Bookshelf</td>
<td><p class="first">Bookshelf is used to store cookbook content&#8212;files, templates, and so on&#8212;that have been uploaded to the Chef server as part of a cookbook version. Cookbook content is stored by content checksum. If two different cookbooks or different versions of the same cookbook include the same file or template, Bookshelf will store that file only once. The cookbook content managed by Bookshelf is stored in flat files and is separated from the Chef server and search index repositories.</p>
<p class="last">All cookbooks are stored in a dedicated repository.</p>
</td>
</tr>
<tr class="row-odd"><td>WebUI</td>
<td>chef-server-webui is a Ruby on Rails 3.0 application that hosts the web interface for the Chef server.</td>
</tr>
<tr class="row-even"><td>Erchef</td>
<td><p class="first">Erchef is a complete rewrite of the core API for the Chef server, which allows it to be faster and more scalable than previous versions. The API itself is still compatible with the original Ruby-based Chef server, which means that cookbooks and recipes that were authored for the Ruby-based Chef server will continue to work on the Erlang-based Chef server. The chef-client is still written in Ruby.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even though the Chef server is authored in Erlang, writing code in Erlang is NOT a requirement for using Chef.</p>
</div>
</td>
</tr>
<tr class="row-odd"><td>Message Queues</td>
<td><p class="first">Messages are sent to the Search Index using the following components:</p>
<blockquote>
<div><ol class="arabic simple">
<li>RabbitMQ is used as the message queue for the Chef server. All items that will be added to the search index repository are first added to a queue.</li>
<li>chef-expander is used to pull messages from the RabbitMQ queue, process them into the required format, and then post them to chef-solr for indexing.</li>
<li>chef-solr wraps Apache Solr and exposes its REST API for indexing and search.</li>
</ol>
</div></blockquote>
<p class="last">All messages are added to a dedicated search index repository.</p>
</td>
</tr>
<tr class="row-even"><td>Nginx</td>
<td>Nginx is an open-source HTTP and reverse proxy server that is used as the front-end load balancer for the Chef server. All requests to the Chef server API are routed through Nginx.</td>
</tr>
<tr class="row-odd"><td>PostgreSQL</td>
<td>PostgreSQL is the data storage repository for the Chef server.</td>
</tr>
</tbody>
</table>
<p>The following sections detail how to monitor the server, manage log files, manage services, manage firewalls and ports, configure SSL, tune server configuration settings, and backup and restore data.</p>
<div class="section" id="monitor">
<h2>Monitor<a class="headerlink" href="#monitor" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_monitor.rst">[edit on GitHub]</a></p>
<p>Monitoring the Chef server involves two types of checks: application and system. In addition monitoring the HTTP requests that workstations and nodes are making to the Chef server and per-disk data storage volumes is recommended.</p>
<div class="section" id="monitoring-priorities">
<h3>Monitoring Priorities<a class="headerlink" href="#monitoring-priorities" title="Permalink to this headline"></a></h3>
<p>The following sections describe the priorities for monitoring of the Chef server. In particular, running out of disk space is the primary cause of failure.</p>
<div class="section" id="disks">
<h4>Disks<a class="headerlink" href="#disks" title="Permalink to this headline"></a></h4>
<p>Over time, and with enough data, disks will fill up or exceed the per-disk quotas that may have been set for them and they will not be able to write data. A disk that is not able to write data will not be able to support certain components of the Chef server, such as PostgreSQL, RabbitMQ, service log files, and deleted file handles. Monitoring disk usage is the best way to ensure that disks don&#8217;t fill up or exceed their quota.</p>
<p>Use the following commands to monitor global disk usage on a Chef server with a typical installation:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ du -sh /var/opt/opscode
</pre></div>
</div>
<p>and:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ du -sh /var/log/opscode
</pre></div>
</div>
<p>To keep the Chef server healthy, both <tt class="docutils literal"><span class="pre">/var/opt/opscode</span></tt> and <tt class="docutils literal"><span class="pre">/var/log/opscode</span></tt> should never exceed 80% use. In situations where disk space grows at a rapid pace, it may be preferable to shut down the Chef server and contact Chef support.</p>
<p>The following components should be monitored for signs that disks may be rapidly filling up:</p>
<ul class="simple">
<li><strong>PostgreSQL</strong> PostgreSQL is the data store for the Chef server.</li>
<li><strong>RabbitMQ</strong> The RabbitMQ data folder can fill up if the <strong>opscode-expander</strong> service is not able to keep up with the data being moved into the search database by RabbitMQ. When the <strong>opscode-expander</strong> service falls behind, RabbitMQ will start storing the individual messages on-disk while it waits for the <strong>opscode-expander</strong> service to catch up. If the RabbitMQ disk fills up completely, RabbitMQ will need to be restarted to free up the disk space and any data that was stored on-disk will be lost.</li>
<li><strong>Log files</strong> If <tt class="docutils literal"><span class="pre">/var/log/opscode</span></tt> is taking up a lot of disk space, ensure that the Chef server log rotation cron job is running without errors. These errors can be found in <tt class="docutils literal"><span class="pre">/var/log/messages</span></tt>, <tt class="docutils literal"><span class="pre">/var/log/syslog</span></tt> and/or the root user&#8217;s local mail.</li>
<li><strong>Deleted file handles</strong> Running processes with file handles associated with one (or more) deleted files will prevent the disk space being used by the deleted files from being reclaimed. Use the <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">lsof</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">'(deleted)'</span></tt> command to find all deleted file handles.</li>
</ul>
</div>
<div class="section" id="high-availability">
<h4>High Availability<a class="headerlink" href="#high-availability" title="Permalink to this headline"></a></h4>
<p>All components of computer systems fail, and ethernet networks, while being generally very robust, are no exception. A high availability configuration of the Chef server that uses DRBD depends on a functioning network to begin and maintain replication between the back end servers on which the Chef server is running.</p>
<p>To become aware of failure at the earliest opportunity, the <tt class="docutils literal"><span class="pre">/proc/drbd</span></tt> psuedo file should be monitored for signs
that cluster replication has stopped or is falling behind:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cat /proc/drbd
</pre></div>
</div>
<p>A healthy connection state is similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>version: 8.4.0 <span class="o">(</span>api:1/proto:86-100<span class="o">)</span>
GIT-hash: 09b6d528b3b3de50462cd7831c0a3791abc665c3 build by linbit@buildsystem.linbit, 2011-10-12 09:07:35
 0: cs:Connected ro:Secondary/Secondary ds:UpToDate/UpToDate C r-----
    ns:0 nr:0 dw:0 dr:656 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:b oos:0
</pre></div>
</div>
<p>An unhealthy connection state from the perspective of the initial primary machine is similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>version: 8.4.0 <span class="o">(</span>api:1/proto:86-100<span class="o">)</span>
GIT-hash: 09b6d528b3b3de50462cd7831c0a3791abc665c3 build by linbit@buildsystem.linbit, 2011-10-12 09:07:35
 0: cs:WFConnection ro:Primary/Secondary ds:UpToDate/Unknown C r---
    ns:0 nr:0 dw:0 dr:0 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:b oos:54192
</pre></div>
</div>
<p>where this shows lost communication with the secondary machine and <tt class="docutils literal"><span class="pre">oos:</span></tt> at non-zero (and increasing). This connection state is not fatal, but does represent a degraded state for the cluster where the machines are no longer in sync and are building up a queue of unwritten writes on the originating side that must eventually be synchronized to the secondary machine after the network stabilizes.</p>
</div>
</div>
<div class="section" id="application-checks">
<h3>Application Checks<a class="headerlink" href="#application-checks" title="Permalink to this headline"></a></h3>
<p>Application-level checks should be done periodically to ensure that there is enough disk space, enough memory, and that the front-end and back-end services are communicating.</p>
<div class="section" id="drbd">
<h4>DRBD<a class="headerlink" href="#drbd" title="Permalink to this headline"></a></h4>
<p>Drbdadm is the management tool for DRBD. It can be used to obtain status information and to alter the state of the DRBD cluster. For more information about Drbdadm, see <a class="reference external" href="http://www.drbd.org/users-guide/re-drbdadm.html">http://www.drbd.org/users-guide/re-drbdadm.html</a>.</p>
<p><tt class="docutils literal"><span class="pre">/proc/drbd</span></tt> is a virtual file that displays real-time status information about all currently-configured DRBD resources. Use the following command to view the contents of this virtual file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cat /proc/drbd
</pre></div>
</div>
<p>Use <tt class="docutils literal"><span class="pre">chef-server-ctl</span> <span class="pre">ha-status</span></tt> along with <tt class="docutils literal"><span class="pre">/proc/drbd</span></tt> to help evaluate the current state of the cluster. Follow the split-brain recovery procedures for DRBD if the cluster becomes two unconnected pieces.</p>
</div>
<div class="section" id="id1">
<h4>Erlang<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<p>Many components of the Chef server are written using Erlang and run on the BEAM virtual machine. One feature of Erlang and BEAM is the ability to interact with the running service using a command shell. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /opt/opscode/embedded
  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/opscode/bin:/opt/opscode/embedded/bin
  bin/erl -setcookie service_name -name me@127.0.0.1 -remsh service_name@127.0.0.1
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">service_name</span></tt> is <tt class="docutils literal"><span class="pre">bifrost</span></tt> or <tt class="docutils literal"><span class="pre">erchef</span></tt>. This command will then open a shell that is connected to the Erchef processes:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ Erlang R15B02 <span class="o">(</span>erts-5.9.2<span class="o">)</span> <span class="o">[</span>source<span class="o">]</span> <span class="o">[</span>64-bit<span class="o">]</span> ...
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Connecting to the Erlang processes should only be done when directed by Chef support services.</p>
</div>
<p>To connect to the <strong>oc_bifrost</strong> service, use the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ erl -setcookie oc_bifrost -name me@127.0.0.1 -remsh oc_bifrost@127.0.0.1
</pre></div>
</div>
<p>To connect to the <strong>opscode-erchef</strong> service, use the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ erl -setcookie erchef -name me@127.0.0.1 -remsh erchef@127.0.0.1
</pre></div>
</div>
<p>To disconnect from the shell, use the following key sequence <tt class="docutils literal"><span class="pre">CTRL-g</span></tt>, <tt class="docutils literal"><span class="pre">q</span></tt>, and then <tt class="docutils literal"><span class="pre">ENTER</span></tt>.</p>
<p>The output from the shell after the <tt class="docutils literal"><span class="pre">CTRL-g</span></tt> looks similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">(</span>erchef@127.0.0.1<span class="o">)</span>1&gt;
User switch <span class="nb">command</span>
</pre></div>
</div>
<p>then enter <tt class="docutils literal"><span class="pre">q</span></tt>, and then hit <tt class="docutils literal"><span class="pre">ENTER</span></tt> to exit the shell.</p>
<p>Some commands should not be entered when interacting with a running service while using the command shell, including:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">q()</span></tt> kills the Erlang node</li>
<li><tt class="docutils literal"><span class="pre">init:stop()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">exit</span></tt> or <tt class="docutils literal"><span class="pre">exit()</span></tt> does nothing</li>
</ul>
<div class="section" id="eper-tools">
<h5><tt class="docutils literal"><span class="pre">eper</span></tt> tools<a class="headerlink" href="#eper-tools" title="Permalink to this headline"></a></h5>
<p>As root on the Chef server, point to the bundled <tt class="docutils literal"><span class="pre">eper</span></tt> package of debugging tools. Replace the 2nd and 5th path entries and the <tt class="docutils literal"><span class="pre">X.XX.X</span></tt> value in the following path with the items that occur on the system.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">ERL_LIB</span><span class="o">=</span>:/opt/<span class="o">{</span>chef-server,opscode<span class="o">}</span>/embedded/service/<span class="o">{</span>erchef,opscode-erchef<span class="o">}</span>/lib/eper-X.XX.X/ebin/
</pre></div>
</div>
<p>Open an Erlang command shell to begin diagnosing service issues on the Chef server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Eshell V5.10.4  <span class="o">(</span>abort with ^G<span class="o">)</span>
<span class="o">(</span>erchef@127.0.0.1<span class="o">)</span>1&gt;
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">dtop</span></tt> tool presents a view on the Erlang virtual machine that is similar to the <tt class="docutils literal"><span class="pre">linuxdagnostic</span></tt> command. The period at the end of the dtop command is required for the command to take effect.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">(</span>erchef@127.0.0.1<span class="o">)</span>1&gt; dtop:start<span class="o">()</span>.
</pre></div>
</div>
<p>To stop the <tt class="docutils literal"><span class="pre">dtop</span></tt> command, run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">(</span>erchef@127.0.0.1<span class="o">)</span>1&gt; dtop:stop<span class="o">()</span>.
</pre></div>
</div>
<p>To disconnect from the shell, use the following key sequence <tt class="docutils literal"><span class="pre">CTRL-g</span></tt>, <tt class="docutils literal"><span class="pre">q</span></tt>, and then <tt class="docutils literal"><span class="pre">ENTER</span></tt>.</p>
<p>The output from the shell after the <tt class="docutils literal"><span class="pre">CTRL-g</span></tt> looks similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">(</span>erchef@127.0.0.1<span class="o">)</span>1&gt;
User switch <span class="nb">command</span>
</pre></div>
</div>
<p>then enter <tt class="docutils literal"><span class="pre">q</span></tt>, and then hit <tt class="docutils literal"><span class="pre">ENTER</span></tt> to exit the shell.</p>
</div>
</div>
<div class="section" id="nginx">
<h4>Nginx<a class="headerlink" href="#nginx" title="Permalink to this headline"></a></h4>
<p>Use Nginx to monitor for services that may be returning 504 errors. Use the following command on a front-end machine:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ grep <span class="s1">&#39;HTTP/1.1&quot; 504&#39;</span> /var/log/opscode/nginx/access.log
</pre></div>
</div>
<p>and then extract the URLs and sort them by <tt class="docutils literal"><span class="pre">uniq</span></tt> count:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ grep <span class="s1">&#39;HTTP/1.1&quot; 504&#39;</span> nginx-access.log <span class="p">|</span> cut -d<span class="s1">&#39; &#39;</span> -f8 <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> sort
</pre></div>
</div>
<p>In a large installation, restricting these results to a subset of results may be necessary:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tail -10000 nginx-access.log <span class="p">|</span> grep <span class="s1">&#39;HTTP/1.1&quot; 504&#39;</span> <span class="p">|</span> cut -d<span class="s1">&#39; &#39;</span> -f8 <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> sort
</pre></div>
</div>
</div>
<div class="section" id="postgresql">
<h4>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this headline"></a></h4>
<p>psql is the management tool for PostgreSQL. It can be used to obtain information about data stored in PostgreSQL. For more information about psql, see <a class="reference external" href="http://www.postgresql.org/docs/manuals/">http://www.postgresql.org/docs/manuals/</a>, and then the doc set appropriate for the version of PostgreSQL being used.</p>
<p>To connect to the PostgreSQL database, run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /opt/opscode/embedded/service/postgresql/
  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/opscode/bin:/opt/opscode/embedded/bin
  bin/psql -U opscode_chef
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Connecting to the PostgreSQL database should only be done when directed by Chef support services.</p>
</div>
</div>
<div class="section" id="rabbitmq">
<h4>RabbitMQ<a class="headerlink" href="#rabbitmq" title="Permalink to this headline"></a></h4>
<p>rabbitmqctl is the management tool for RabbitMQ. It can be used to obtain status information and to ensure that message queuing is running properly. For more information about rabbitmqctl, see <a class="reference external" href="https://www.rabbitmq.com/man/rabbitmqctl.1.man.html">https://www.rabbitmq.com/man/rabbitmqctl.1.man.html</a>.</p>
<p>To obtain status information for message queues, run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/opscode/bin:/opt/opscode/embedded/bin
  rabbitmqctl status
</pre></div>
</div>
<p>to return something similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Status of node rabbit@localhost ...
<span class="o">[{</span>pid,3044<span class="o">}</span>,
 <span class="o">{</span>running_applications, <span class="o">[{</span>rabbit,<span class="s2">&quot;RabbitMQ&quot;</span>,<span class="s2">&quot;2.7.1&quot;</span><span class="o">}</span>,
                         <span class="o">{</span>mnesia,<span class="s2">&quot;MNESIA CXC 138 12&quot;</span>,<span class="s2">&quot;4.7.1},</span>
<span class="s2">                         {os_mon,&quot;</span>CPO CXC <span class="m">138</span> 46<span class="s2">&quot;,&quot;</span>2.2.10<span class="o">}</span>,
                         ...
                         <span class="o">{</span>kernel,<span class="s2">&quot;ERTS CXC 138 10&quot;</span>,<span class="s2">&quot;2.15.2&quot;</span><span class="o">}]}</span>,
 <span class="o">{</span>os,<span class="o">{</span>unix,linux<span class="o">}}</span>,
 <span class="o">{</span>erlang_version,<span class="s2">&quot;Erlang R15B02 (erts-5.9.2) [source] [64-bit] ...&quot;</span><span class="o">}</span>,
 <span class="o">{</span>memory,<span class="o">[{</span>total,96955896<span class="o">}</span>,
          <span class="o">{</span>processes,38634560<span class="o">}</span>,
          ...
          <span class="o">{</span>ets,5850336<span class="o">}]}</span>,
 <span class="o">{</span>vm_memory_high_watermark,0.39999999995176794<span class="o">}</span>,
 <span class="o">{</span>vm_memory_limit,1658647347<span class="o">}]</span>
 ... <span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="redis">
<h4>Redis<a class="headerlink" href="#redis" title="Permalink to this headline"></a></h4>
<p>The <strong>redis_lb</strong> service located on the back end machine handles requests that are made from the Nginx service that is located on all front end machines in a Chef server cluster.</p>
<p>In the event of a disk full condition for the Redis data store, the <tt class="docutils literal"><span class="pre">dump.rdb</span></tt> (the primary data store <tt class="docutils literal"><span class="pre">.rdb</span></tt> used by Redis) can become corrupt and saved as a zero byte file.</p>
<p>When this occurs, after the <strong>redis_lb</strong> service started, it&#8217;s logs will show a statement similar to the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>2015-03-23_16:11:31.44256 <span class="o">[</span>11529<span class="o">]</span> <span class="m">23</span> Mar 16:10:09.624 <span class="c1"># Server started, Redis version 2.8.2</span>
2015-03-23_16:11:31.44256 <span class="o">[</span>11529<span class="o">]</span> <span class="m">23</span> Mar 16:10:09.624 <span class="c1"># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add &#39;vm.overcommit_memory = 1&#39; to /etc/sysctl.conf and then reboot or run the command &#39;sysctl vm.overcommit_memory=1&#39; for this to take effect.</span>
2015-03-23_16:11:31.44257 <span class="o">[</span>11529<span class="o">]</span> <span class="m">23</span> Mar 16:11:31.438 <span class="c1"># Short read or OOM loading DB. Unrecoverable error, aborting now.</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">dump.rdb</span></tt> file will be empty:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ls -al /var/opt/opscode/redis_lb/data/
total 20
drwxr-x--- <span class="m">2</span> opscode opscode <span class="m">4096</span> Mar <span class="m">23</span> 15:58 .
drwxr-x--- <span class="m">4</span> opscode opscode <span class="m">4096</span> Dec <span class="m">22</span> 18:59 ..
-rw-r--r-- <span class="m">1</span> opscode opscode    <span class="m">0</span> Mar <span class="m">23</span> 15:58 dump.rdb
</pre></div>
</div>
<p>This situation is caused by a bug in Redis where saves are allowed to succeed even when the disk has been full for some time, and not just on edge cases where the disk becomes full as Redis is writing. To fix this issue, do the following:</p>
<ol class="arabic">
<li><p class="first">Stop the <strong>redis_lb</strong> service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>chef-server-ctl stop redis_lb
</pre></div>
</div>
</li>
<li><p class="first">Remove the corrupt files:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> /var/opt/opscode/redis_lb/data
rm -fr *rdb
</pre></div>
</div>
</li>
<li><p class="first">Start the <strong>redis_lb</strong> service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>chef-server-ctl start redis_lb

less /var/log/opscode/redis_lb/current
2015-03-23_17:05:18.82516 <span class="o">[</span>28676<span class="o">]</span> <span class="m">23</span> Mar 17:05:18.825 * The server is now ready to accept connections on port 16379
</pre></div>
</div>
</li>
<li><p class="first">Reconfigure the Chef server to re-populate Redis:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>chef-server-ctl reconfigure
</pre></div>
</div>
</li>
<li><p class="first">Verify that Redis is re-populated, as indicated by the key <tt class="docutils literal"><span class="pre">dl_default</span></tt>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/opt/opscode/embedded/bin/redis-cli -p <span class="m">16379</span> keys <span class="se">\*</span>
1<span class="o">)</span> <span class="s2">&quot;dl_default&quot;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="apache-solr">
<h4>Apache Solr<a class="headerlink" href="#apache-solr" title="Permalink to this headline"></a></h4>
<p>The <strong>opscode-solr4</strong> service located on the primary back end machine handles requests that are made from the Erchef service that is located on all front end machines in a Chef server cluster.</p>
<p>Under normal circumstances, opscode-solr4 will need access to a total of 2x the space used for the index.</p>
<p>The thread at <a class="reference external" href="http://comments.gmane.org/gmane.comp.jakarta.lucene.solr.user/99149">http://comments.gmane.org/gmane.comp.jakarta.lucene.solr.user/99149</a> explains more fully, including describing an extreme case where it&#8217;s possible that 3x the storage might be necessary. Chef server usage of Apache Solr via the <strong>opscode-solr4</strong> service will generally only require the used storage for the index + 1x that amount of storage in free space.</p>
<p>For example, a 2GB search index will require about 2GB of free space available in the <strong>opscode-solr4</strong> service&#8217;s storage area. The standard storage area for the <strong>opscode-solr4</strong> service in a standalone topology Chef server install is <tt class="docutils literal"><span class="pre">/var/opt/opscode/opscode-solr4/data</span></tt>.</p>
</div>
</div>
<div class="section" id="system-checks">
<h3>System Checks<a class="headerlink" href="#system-checks" title="Permalink to this headline"></a></h3>
<p>System-level checks should be done for the following components: ports, services, and high availability status.</p>
<div class="section" id="ha-status">
<h4>ha-status<a class="headerlink" href="#ha-status" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">ha-status</span></tt> subcommand is used to check the status for services running in a high availability topology. This command will verify the following:</p>
<blockquote>
<div><ul class="simple">
<li>The Keepalived daemon is enabled in the config</li>
<li>The DRBD process is enabled in the config</li>
<li>The underlying block device or logical volume for DRBD has been created and configured</li>
<li>The DRBD device exists</li>
<li>The current state of the server is <tt class="docutils literal"><span class="pre">master</span></tt> or <tt class="docutils literal"><span class="pre">backup</span></tt>; any migration processes have completed</li>
<li>The failover virtual IP address is correctly attached to only the <tt class="docutils literal"><span class="pre">master</span></tt> node</li>
<li>The DRBD state is correct based on the state of the server being <tt class="docutils literal"><span class="pre">master</span></tt> or <tt class="docutils literal"><span class="pre">backup</span></tt></li>
<li>The DRBD mount point is correctly mounted to only the <tt class="docutils literal"><span class="pre">master</span></tt> node</li>
<li>The DRBD replication IP addresses are pingable</li>
<li>The <tt class="docutils literal"><span class="pre">runit</span></tt> status of the services are correct (up or down) based on the <tt class="docutils literal"><span class="pre">master</span></tt> or <tt class="docutils literal"><span class="pre">backup</span></tt> state of the server</li>
</ul>
</div></blockquote>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ private-chef-ctl ha-status
</pre></div>
</div>
<p>If this command runs successfully, it will return the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="o">[</span>OK<span class="o">]</span> all checks passed.
</pre></div>
</div>
<p>Otherwise it will print out a list of errors, similar to the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>...
<span class="o">[</span>OK<span class="o">]</span> nginx is running correctly, and I am master.
<span class="o">[</span>ERROR<span class="o">]</span> nrpe is not running.
<span class="o">[</span>OK<span class="o">]</span> opscode-account is running correctly, and I am master.
...
<span class="o">[</span>ERROR<span class="o">]</span> ERRORS WERE DETECTED.
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>OK<span class="o">]</span> keepalived HA services enabled
<span class="o">[</span>OK<span class="o">]</span> DRBD disk replication enabled
<span class="o">[</span>OK<span class="o">]</span> DRBD partition /dev/opscode/drbd found
<span class="o">[</span>OK<span class="o">]</span> DRBD device /dev/drbd0 found
<span class="o">[</span>OK<span class="o">]</span> cluster <span class="nv">status</span> <span class="o">=</span> master
<span class="o">[</span>OK<span class="o">]</span> found VIP IP address and I am master
<span class="o">[</span>OK<span class="o">]</span> found VRRP communications interface eth1
<span class="o">[</span>OK<span class="o">]</span> my DRBD status is Connected/Primary/UpToDate and I am master
<span class="o">[</span>OK<span class="o">]</span> my DRBD partition is mounted and I am master
<span class="o">[</span>OK<span class="o">]</span> DRBD primary IP address pings
<span class="o">[</span>OK<span class="o">]</span> DRBD secondary IP address pings
...
<span class="o">[</span>OK<span class="o">]</span> all checks passed.
</pre></div>
</div>
</div>
<div class="section" id="opscode-authz">
<h4>opscode-authz<a class="headerlink" href="#opscode-authz" title="Permalink to this headline"></a></h4>
<p>The authz API provides a high-level view of the health of the <strong>opscode-authz</strong> service with a simple endpoint: <tt class="docutils literal"><span class="pre">_ping</span></tt>. This endpoint can be accessed using cURL and GNU Wget. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ curl http://localhost:9463/_ping
</pre></div>
</div>
<p>This command typically prints a lot of information. Use Python to use pretty-print output:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ curl http://localhost:9463/_ping <span class="p">|</span> python -mjson.tool
</pre></div>
</div>
</div>
<div class="section" id="opscode-erchef">
<h4>opscode-erchef<a class="headerlink" href="#opscode-erchef" title="Permalink to this headline"></a></h4>
<p>The status API provides a high-level view of the health of the system with a simple endpoint: <tt class="docutils literal"><span class="pre">_status</span></tt>. This endpoint can be accessed using cURL and GNU Wget. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ curl http://localhost:8000/_status
</pre></div>
</div>
<p>which will return something similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">{</span>
  <span class="s2">&quot;status&quot;</span>:<span class="s2">&quot;pong&quot;</span>,
  <span class="s2">&quot;upstreams&quot;</span>:<span class="o">{</span><span class="s2">&quot;upstream_service&quot;</span>:<span class="s2">&quot;pong&quot;</span>,<span class="s2">&quot;upstream_service&quot;</span>:<span class="s2">&quot;fail&quot;</span>,...<span class="o">}</span>,
<span class="o">}</span>
</pre></div>
</div>
<p>For each of the upstream services, <tt class="docutils literal"><span class="pre">pong</span></tt> or <tt class="docutils literal"><span class="pre">fail</span></tt> is returned. The possible upstream names are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">chef_solr</span></tt> (for the <strong>opscode-solr4</strong> service)</li>
<li><tt class="docutils literal"><span class="pre">chef_sql</span></tt> (for the <strong>postgresql</strong> service)</li>
<li><tt class="docutils literal"><span class="pre">oc_chef_authz</span></tt> (for the <strong>opscode-authz</strong> service)</li>
</ul>
<p>If any of the status values return <tt class="docutils literal"><span class="pre">fail</span></tt>, this typically means the Chef server is unavailable for that service.</p>
</div>
<div class="section" id="opscode-expander">
<h4>opscode-expander<a class="headerlink" href="#opscode-expander" title="Permalink to this headline"></a></h4>
<p>As the queue depth increases it may take longer for updates posted to the Chef server by each chef-client to be added to the search indexes on the Chef server. The depth of this queue should be monitored using the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /opt/opscode/embedded/service/opscode-expander/
  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/opscode/bin:/opt/opscode/embedded/bin
</pre></div>
</div>
<div class="section" id="search-indexes">
<h5>Search Indexes<a class="headerlink" href="#search-indexes" title="Permalink to this headline"></a></h5>
<p>Search indexes allow queries to be made for any type of data that is indexed by the Chef server, including data bags (and data bag items), environments, nodes, and roles. A defined query syntax is used to support search patterns like exact, wildcard, range, and fuzzy. A search is a full-text query that can be done from several locations, including from within a recipe, by using the <tt class="docutils literal"><span class="pre">search</span></tt> subcommand in knife, the <tt class="docutils literal"><span class="pre">search</span></tt> method in the Recipe DSL, the search box in the Chef management console, and by using the <tt class="docutils literal"><span class="pre">/search</span></tt> or <tt class="docutils literal"><span class="pre">/search/INDEX</span></tt> endpoints in the Chef server API. The search engine is based on Apache Solr and is run from the Chef server.</p>
<p>If the search indexes are not being updated properly, first ensure that the <strong>opscode-expander</strong> service is running on the backend machine:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status opscode-expander
</pre></div>
</div>
<p>and then (if it is not running), start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start opscode-expander
</pre></div>
</div>
<p>If the <strong>opscode-expander</strong> does not start correctly, then take a look at the <tt class="docutils literal"><span class="pre">/var/log/opscode/opscode-expander/current</span></tt> log file for error messages.</p>
<p>If the <strong>opscode-expander</strong> is running, check the queue length:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ watch -n1 sudo -E bin/opscode-expanderctl queue-depth
</pre></div>
</div>
<p>If the number of total messages continues to increase, increase the number of workers available to the <strong>opscode-expander</strong> service.</p>
</div>
<div class="section" id="opscode-expander-ctl">
<h5>opscode-expander-ctl<a class="headerlink" href="#opscode-expander-ctl" title="Permalink to this headline"></a></h5>
<p>The opscode-expander-ctl executable can be used to generate status information for the <strong>opscode-expander</strong> service. The opscode-expander-ctl executable is run as a command-line tool from the master backend machine.</p>
<p>This tool has the following syntax:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>opscode-expanderctl OPTION
</pre></div>
</div>
<p>This tool has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">log-level</span></tt></dt>
<dd>Use to show the log level for all nodes in the cluster.</dd>
<dt><tt class="docutils literal"><span class="pre">node-status</span></tt></dt>
<dd>Use to show the status for all nodes in the cluster.</dd>
<dt><tt class="docutils literal"><span class="pre">queue-depth</span></tt></dt>
<dd>Use to display the aggregate queue backlog.</dd>
<dt><tt class="docutils literal"><span class="pre">queue-status</span></tt></dt>
<dd>Use to show the backlog and consumer counts for each vnode queue.</dd>
</dl>
<p>For example, to view the aggregate queue backlog, enter the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /opt/opscode/embedded/service/opscode-expander/
  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/opscode/bin:/opt/opscode/embedded/bin
  bin/opscode-expanderctl queue-depth
</pre></div>
</div>
<p>to return something similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>total messages:       0
average queue depth:  0.0
max queue depth:      0
min queue depth:      0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="nodes-workstations">
<h3>Nodes, Workstations<a class="headerlink" href="#nodes-workstations" title="Permalink to this headline"></a></h3>
<p>If a client makes an HTTP request to the server that returns a non-specific error message, this is typically an issue with the <strong>opscode-chef</strong> or <strong>opscode-erchef</strong> services. View the full error message for these services in their respective log files. The error is most often a stacktrace from the application error. In some cases, the error message will clearly indicate a problem with another service, which can then be investigated further. For non-obvious errors, please contact Chef support services.</p>
</div>
</div>
<div class="section" id="log-files">
<h2>Log Files<a class="headerlink" href="#log-files" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_logs.rst">[edit on GitHub]</a></p>
<p>All logs generated by the Chef server can be found in <tt class="docutils literal"><span class="pre">/var/log/opscode</span></tt>. Each service enabled on the system also has a sub-directory in which service-specific logs are located, typically found in <tt class="docutils literal"><span class="pre">/var/log/opscode/service_name</span></tt>.</p>
<div class="section" id="view-log-files">
<h3>View Log Files<a class="headerlink" href="#view-log-files" title="Permalink to this headline"></a></h3>
<p>The Chef server has built-in support for easily tailing the logs that are generated. To view all the logs being generated on the Chef server, enter the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail
</pre></div>
</div>
<p>To view logs for a specific service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail SERVICENAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICENAME</span></tt> should be replaced with name of the service for which log files will be viewed.</p>
<p>Another way to view log files is to use the system utility tail:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tail -50f /var/log/chef-server/opscode-chef/current
</pre></div>
</div>
<div class="section" id="tail-log-files">
<h4>tail Log Files<a class="headerlink" href="#tail-log-files" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">tail</span></tt> subcommand is used to follow all of the Chef server logs for all services. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
<p>Another common approach to tailing the log files for a service is to use the system utility <tt class="docutils literal"><span class="pre">tail</span></tt>. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tail -50f /var/log/opscode/opscode-chef/current
</pre></div>
</div>
</div>
</div>
<div class="section" id="supervisor">
<h3>Supervisor<a class="headerlink" href="#supervisor" title="Permalink to this headline"></a></h3>
<p>Supervisor logs are created and managed directly by the service supervisor, and are automatically rotated when a the current log file reaches 1,000,000 bytes. 10 log files are kept. The latest supervisor log is always located in <tt class="docutils literal"><span class="pre">/var/log/chef-server/service_name/current</span></tt> and rotated logs have a filename starting with <tt class="docutils literal"><span class="pre">&#64;</span></tt> followed by a precise <tt class="docutils literal"><span class="pre">tai64n</span></tt> timestamp based on when the file was rotated.</p>
<p>Supervisor logs are available for the following services:</p>
<ul class="simple">
<li>bifrost</li>
<li>bookshelf</li>
<li>nginx</li>
<li>opscode-erchef</li>
<li>opscode-expander</li>
<li>opscode-expander-reindexer</li>
<li>opscode-solr4</li>
<li>postgresql</li>
<li>rabbitmq</li>
<li>redis</li>
</ul>
<div class="section" id="nginx-access">
<h4>nginx, access<a class="headerlink" href="#nginx-access" title="Permalink to this headline"></a></h4>
<p>Nginx is an important entry point for data on the Chef server, which means that debugging efforts frequently start with analyzing the <strong>nginx</strong> service&#8217;s <tt class="docutils literal"><span class="pre">access.log</span></tt> file. This log contains every HTTP request made to the front-end machine and can be very useful when investigating request rates and usage patterns. The following is an example log entry:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>175.185.9.6 - - [12/Jul/2013:15:56:54 +0000] &quot;GET
/organizations/exampleorg/data/firewall/nova_api HTTP/1.1&quot; 200
&quot;0.850&quot; 452 &quot;-&quot; &quot;Chef Client/0.10.2 (ruby-1.8.7-p302; ohai-0.6.4;
x86_64-linux; +http://opscode.com)&quot; &quot;127.0.0.1:9460&quot; &quot;200&quot;
&quot;0.849&quot; &quot;0.10.2&quot; &quot;version=1.0&quot; &quot;some_node.example.com&quot;
&quot;2013-07-12T15:56:40Z&quot; &quot;2jmj7l5rSw0yVb/vlWAYkK/YBwk=&quot; 985
</pre></div>
</div>
<p>where important fields in this log include:</p>
<ul class="simple">
<li>The HTTP status code (<tt class="docutils literal"><span class="pre">200</span></tt>)</li>
<li>The IP address of the requesting client (<tt class="docutils literal"><span class="pre">175.185.9.6</span></tt>)</li>
<li>The timestamp (<tt class="docutils literal"><span class="pre">[12/Jul/2013:15:56:54</span> <span class="pre">+0000]</span></tt>)</li>
<li>The total request time (<tt class="docutils literal"><span class="pre">&quot;0.850&quot;</span></tt>)</li>
<li>The request method (<tt class="docutils literal"><span class="pre">GET</span></tt>)</li>
<li>The request URL (<tt class="docutils literal"><span class="pre">/organizations/exampleorg/data/firewall/nova_api</span></tt>)</li>
</ul>
</div>
<div class="section" id="opscode-erchef-current">
<h4>opscode-erchef, current<a class="headerlink" href="#opscode-erchef-current" title="Permalink to this headline"></a></h4>
<p>The <strong>opscode-erchef</strong> service&#8217;s <tt class="docutils literal"><span class="pre">current.log</span></tt> file contains a history of stack traces from major application crashes.</p>
</div>
<div class="section" id="opscode-erchef-erchef">
<h4>opscode-erchef, erchef<a class="headerlink" href="#opscode-erchef-erchef" title="Permalink to this headline"></a></h4>
<p>The <strong>opscode-erchef</strong> service&#8217;s <tt class="docutils literal"><span class="pre">erchef.log</span></tt> file contains a history of API requests that have been processed by Erchef. These logs can be rotated quickly, therefore it is generally best to sort them by date, and then find the most recently updated log file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ls -lrt /var/log/opscode/opscode-erchef/erchef.log.*
</pre></div>
</div>
<p>The following is an example log entry:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>2013-08-06T08:54:32Z erchef@127.0.0.1 INFO org_name=srwjedoqqoypgmvafmoi; req_id=g3IAA2QAEGVyY2hlZkAx
</pre></div>
</div>
<p>where important fields in this log include:</p>
<ul class="simple">
<li>The HTTP method (<tt class="docutils literal"><span class="pre">POST</span></tt>)</li>
<li>The HTTP path (<tt class="docutils literal"><span class="pre">/organizations/srwjedoqqoypgmvafmoi/environments</span></tt>)</li>
<li>The message (<tt class="docutils literal"><span class="pre">{created,&lt;&lt;&quot;_default&quot;&gt;&gt;}</span></tt>)</li>
<li>The organization name (<tt class="docutils literal"><span class="pre">org_name=srwjedoqqoypgmvafmoi</span></tt>)</li>
<li>The timestamp (<tt class="docutils literal"><span class="pre">2013-08-06T08:54:32Z</span></tt>)</li>
<li>The name of the user and/or chef-client which made the request (<tt class="docutils literal"><span class="pre">pivotal</span></tt>)</li>
</ul>
<p>In addition, the log file may contain additional entries that detail the amounts of time spent interacting with other services:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rdbms_time</span></tt> (the time spent talking to the <strong>postgresql</strong> service)</li>
<li><tt class="docutils literal"><span class="pre">req_time</span></tt> (the request time)</li>
<li><tt class="docutils literal"><span class="pre">solr_time</span></tt> (the time spent talking to the <strong>opscode-solr</strong> service)</li>
</ul>
</div>
</div>
<div class="section" id="application">
<h3>Application<a class="headerlink" href="#application" title="Permalink to this headline"></a></h3>
<p>Application logs are created by the services directly, and may require log rotation policies to be applied based on organizational goals and the platform(s) on which the services are running.</p>
<div class="section" id="id2">
<h4>nginx<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">nginx</span></tt> service creates both supervisor and administrator logs. The administrator logs contain both access and error logs for each virtual host utilized by the Chef server. Each of the following logs require external log rotation.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Logs</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/access.log</span></tt></td>
<td>The Web UI and API HTTP access logs.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/error.log</span></tt></td>
<td>The Web UI and API HTTP error logs.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/internal-account.access.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">opscode-account</span></tt> internal load-balancer access logs.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/internal-account.error.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">opscode-account</span></tt> internal load-balancer error logs.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/internal-authz.access.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">opscode-authz</span></tt> internal load-balancer access logs.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/internal-authz.error.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">opscode-authz</span></tt> internal load-balancer error logs.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/internal-chef.access.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">opscode-chef</span></tt> and <tt class="docutils literal"><span class="pre">opscode-erchef</span></tt> internal load-balancer access logs.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/internal-chef.error.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">opscode-chef</span></tt> and <tt class="docutils literal"><span class="pre">opscode-erchef</span></tt> internal load-balancer error logs.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/nagios.access.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">nagios</span></tt> access logs.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/nagios.error.log</span></tt></td>
<td>The <tt class="docutils literal"><span class="pre">nagios</span></tt> error logs.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/var/log/opscode/nginx/rewrite-port-80.log</span></tt></td>
<td>The rewrite logs for traffic that uses HTTP instead of HTTPS.</td>
</tr>
</tbody>
</table>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail nginx
</pre></div>
</div>
<div class="section" id="read-log-files">
<h5>Read Log Files<a class="headerlink" href="#read-log-files" title="Permalink to this headline"></a></h5>
<p>The <strong>nginx</strong> access log format is as follows:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>log_format opscode <span class="s1">&#39;$remote_addr - $remote_user [$time_local]  &#39;</span>
  <span class="s1">&#39;&quot;$request&quot; $status &quot;$request_time&quot; $body_bytes_sent &#39;</span>
  <span class="s1">&#39;&quot;$http_referrer&quot; &quot;$http_user_agent&quot; &quot;$upstream_addr&quot; &#39;</span>
  <span class="s1">&#39;&quot;$upstream_status&quot; &quot;$upstream_response_time&quot; &quot;$http_x_chef_version&quot; &#39;</span>
  <span class="s1">&#39;&quot;$http_x_ops_sign&quot; &quot;$http_x_ops_userid&quot; &quot;$http_x_ops_timestamp&quot; &#39;</span>
   <span class="s1">&#39;&quot;$http_x_ops_content_hash&quot; $request_length&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>A sample log line:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>192.168.4.1 - - <span class="o">[</span>17/Feb/2012:16:02:42 -0800<span class="o">]</span>
  <span class="s2">&quot;GET /organizations/nginx/cookbooks HTTP/1.1&quot;</span> 200
  <span class="s2">&quot;0.346&quot;</span> <span class="m">12</span> <span class="s2">&quot;-&quot;</span>
  <span class="s2">&quot;Chef Knife/0.10.4 (ruby-1.9.3-p0;</span>
<span class="s2">                      ohai-0.6.10;</span>
<span class="s2">                      x86_64-darwin11.2.0;</span>
<span class="s2">                      +http://opscode.com</span>
<span class="s2">                      )&quot;</span>
  <span class="s2">&quot;127.0.0.1:9460&quot;</span> <span class="s2">&quot;200&quot;</span> <span class="s2">&quot;0.339&quot;</span> <span class="s2">&quot;0.10.4&quot;</span>
  <span class="s2">&quot;version=1.0&quot;</span> <span class="s2">&quot;adam&quot;</span> <span class="s2">&quot;2012-02-18T00:02:42Z&quot;</span>
  <span class="s2">&quot;2jmj7l5rSw0yVb/vlWAYkK/YBwk=&quot;</span> 871
</pre></div>
</div>
<p>Field descriptions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$remote_addr</span></tt></td>
<td>The IP address of the client who made this request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$remote_user</span></tt></td>
<td>The HTTP basic auth user name of this request.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$time_local</span></tt></td>
<td>The local time of the request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$request</span></tt></td>
<td>The HTTP request.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$status</span></tt></td>
<td>The HTTP status code.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$request_time</span></tt></td>
<td>The time it took to service the request.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$body_bytes_sent</span></tt></td>
<td>The number of bytes in the HTTP response body.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$http_referrer</span></tt></td>
<td>The HTTP referrer.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$http_user_agent</span></tt></td>
<td>The user agent of the requesting client.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$upstream_addr</span></tt></td>
<td>The upstream reverse proxy used to service this request.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$upstream_status</span></tt></td>
<td>The upstream reverse proxy response status code.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$upstream_response_time</span></tt></td>
<td>The upstream reverse proxy response time.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$http_x_chef_version</span></tt></td>
<td>The version of Chef used to make this request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$http_x_ops_sign</span></tt></td>
<td>The version of the authentication protocol.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$http_x_ops_userid</span></tt></td>
<td>The client name that was used to sign this request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$http_x_ops_timestamp</span></tt></td>
<td>The timestamp from when this request was signed.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">$http_x_ops_content_hash</span></tt></td>
<td>The hash of the contents of this request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">$request_length</span></tt></td>
<td>The length of this request.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section" id="firewalls-and-ports">
<h2>Firewalls and Ports<a class="headerlink" href="#firewalls-and-ports" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_firewalls_and_ports.rst">[edit on GitHub]</a></p>
<p>All of the ports used by the Chef server are TCP ports. Refer to the operating system&#8217;s manual or site systems administrators for instructions on how to enable changes to ports, if necessary.</p>
<p>All services must be listening on the appropriate ports. Most monitoring systems provide a means of testing whether a given port is accepting connections and service-specific tools may also be available. In addition, the generic system tool Telnet can also be used to initiate the connection:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ telnet HOST_NAME PORT
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An &#8220;external&#8221; port is external from the perspective of a workstation (such as knife), a machine (the chef-client), or any other user that accesses the Chef server via the Chef server API.</p>
</div>
<div class="section" id="standalone">
<h3>Standalone<a class="headerlink" href="#standalone" title="Permalink to this headline"></a></h3>
<p>The following sections describe the ports that are required by the Chef server in a standalone configuration:</p>
<img alt="_images/chef_server_ports_standalone.png" src="_images/chef_server_ports_standalone.png" />
<p>A single loopback interface should be configured using the <tt class="docutils literal"><span class="pre">127.0.0.1</span></tt> address. This ensures that all of the services are available to the Chef server, in the event that the Chef server attempts to contact itself from within a front or back end machine. All ports should be accessible through the loopback interface of their respective hosts.</p>
<p>For a standalone installation, ensure that ports marked as external (marked as <tt class="docutils literal"><span class="pre">yes</span></tt> in the <strong>External</strong> column) are open and accessible via any firewalls that are in use:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="78%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Port</th>
<th class="head">Service Name, Description</th>
<th class="head">External</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4321</td>
<td><p class="first"><strong>bookshelf</strong></p>
<p class="last">The <strong>bookshelf</strong> service is an Amazon Simple Storage Service (S3)-compatible service that is used to store cookbooks, including all of the files&#8212;recipes, templates, and so on&#8212;that are associated with each cookbook.</p>
</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>80, 443, 9683</td>
<td><p class="first"><strong>nginx</strong></p>
<p>The <strong>nginx</strong> service is used to manage traffic to the Chef server, including virtual hosts for internal and external API request/response routing, external add-on request routing, and routing between front- and back-end components.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Port 9683 is used to internally load balance the <strong>oc_bifrost</strong> service.</p>
</div>
</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>9463</td>
<td><p class="first"><strong>oc_bifrost</strong></p>
<p class="last">The <strong>oc_bifrost</strong> service ensures that every request to view or manage objects stored on the Chef server is authorized.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>9090</td>
<td><p class="first"><strong>oc-id</strong></p>
<p class="last">The <strong>oc-id</strong> service enables OAuth 2.0 authentication to the Chef server by external applications, including Chef Supermarket and Chef Analytics. OAuth 2.0 uses token-based authentication, where external applications use tokens that are issued by the <strong>oc-id</strong> provider. No special credentials&#8212;<tt class="docutils literal"><span class="pre">webui_priv.pem</span></tt> or privileged keys&#8212;are stored on the external application.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>8000</td>
<td><p class="first"><strong>opscode-erchef</strong></p>
<p>The <strong>opscode-erchef</strong> service is an Erlang-based service that is used to handle Chef server API requests to the following areas within the Chef server:</p>
<ul class="last simple">
<li>Cookbooks</li>
<li>Data bags</li>
<li>Environments</li>
<li>Nodes</li>
<li>Roles</li>
<li>Sandboxes</li>
<li>Search</li>
</ul>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>8983</td>
<td><p class="first"><strong>opscode-solr4</strong></p>
<p class="last">The <strong>opscode-solr4</strong> service is used to create the search indexes used for searching objects like nodes, data bags, and cookbooks. (This service ensures timely search results via the Chef server API; data that is used by the Chef platform is stored in PostgreSQL.)</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>5432</td>
<td><p class="first"><strong>postgresql</strong></p>
<p class="last">The <strong>postgresql</strong> service is used to store node, object, and user data.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>5672</td>
<td><p class="first"><strong>rabbitmq</strong></p>
<p class="last">The <strong>rabbitmq</strong> service is used to provide the message queue that is used by the Chef server to get search data to Apache Solr so that it can be indexed for search. When Chef Analytics is confiugred, the <strong>rabbitmq</strong> service is also used to send data from the Chef server to the Chef Analytics server.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>16379</td>
<td><p class="first"><strong>redis_lb</strong></p>
<p class="last">Key-value store used in conjunction with Nginx to route requests and populate request data used by the Chef server.</p>
</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h3>High Availability<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h3>
<p>The following sections describe the ports that are required by the Chef server in a high availability configuration that is running DRBD and Keepalived to manage the active/passive backend servers:</p>
<img alt="_images/chef_server_ports_ha_drbd.png" src="_images/chef_server_ports_ha_drbd.png" />
<p>A single loopback interface should be configured using the <tt class="docutils literal"><span class="pre">127.0.0.1</span></tt> address. This ensures that all of the services are available to the Chef server, in the event that the Chef server attempts to contact itself from within a front or back end machine. All ports should be accessible through the loopback interface of their respective hosts.</p>
<div class="section" id="front-end">
<h4>Front End<a class="headerlink" href="#front-end" title="Permalink to this headline"></a></h4>
<p>For front-end servers, ensure that ports marked as external (marked as <tt class="docutils literal"><span class="pre">yes</span></tt> in the <strong>External</strong> column) are open and accessible via any firewalls that are in use:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="78%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Port</th>
<th class="head">Service Name, Description</th>
<th class="head">External</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>80, 443, 9683</td>
<td><p class="first"><strong>nginx</strong></p>
<p>The <strong>nginx</strong> service is used to manage traffic to the Chef server, including virtual hosts for internal and external API request/response routing, external add-on request routing, and routing between front- and back-end components.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Port 9683 is used to internally load balance the <strong>oc_bifrost</strong> service.</p>
</div>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>9463</td>
<td><p class="first"><strong>oc_bifrost</strong></p>
<p class="last">The <strong>oc_bifrost</strong> service ensures that every request to view or manage objects stored on the Chef server is authorized.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>9090</td>
<td><p class="first"><strong>oc-id</strong></p>
<p class="last">The <strong>oc-id</strong> service enables OAuth 2.0 authentication to the Chef server by external applications, including Chef Supermarket and Chef Analytics. OAuth 2.0 uses token-based authentication, where external applications use tokens that are issued by the <strong>oc-id</strong> provider. No special credentials&#8212;<tt class="docutils literal"><span class="pre">webui_priv.pem</span></tt> or privileged keys&#8212;are stored on the external application.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>8000</td>
<td><p class="first"><strong>opscode-erchef</strong></p>
<p>The <strong>opscode-erchef</strong> service is an Erlang-based service that is used to handle Chef server API requests to the following areas within the Chef server:</p>
<ul class="last simple">
<li>Cookbooks</li>
<li>Data bags</li>
<li>Environments</li>
<li>Nodes</li>
<li>Roles</li>
<li>Sandboxes</li>
<li>Search</li>
</ul>
</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="back-end">
<h4>Back End<a class="headerlink" href="#back-end" title="Permalink to this headline"></a></h4>
<p>For back-end servers, ensure that ports marked as external (marked as <tt class="docutils literal"><span class="pre">yes</span></tt> in the <strong>External</strong> column) are open and accessible via any firewalls that are in use:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="78%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Port</th>
<th class="head">Service Name, Description</th>
<th class="head">External</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4321</td>
<td><p class="first"><strong>bookshelf</strong></p>
<p class="last">The <strong>bookshelf</strong> service is an Amazon Simple Storage Service (S3)-compatible service that is used to store cookbooks, including all of the files&#8212;recipes, templates, and so on&#8212;that are associated with each cookbook.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>112</td>
<td><p class="first"><strong>keepalived</strong></p>
<p class="last">The <strong>keepalived</strong> service manages the virtual IP address (VIP) between the backend machines in a high availability topology that uses DRBD.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>80, 443, 9683</td>
<td><p class="first"><strong>nginx</strong></p>
<p>The <strong>nginx</strong> service is used to manage traffic to the Chef server, including virtual hosts for internal and external API request/response routing, external add-on request routing, and routing between front- and back-end components.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Port 9683 is used to internally load balance the <strong>oc_bifrost</strong> service.</p>
</div>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>9683</td>
<td><p class="first"><strong>oc_bifrost</strong></p>
<p class="last">The <strong>oc_bifrost</strong> service ensures that every request to view or manage objects stored on the Chef server is authorized.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>9090</td>
<td><p class="first"><strong>oc-id</strong></p>
<p class="last">The <strong>oc-id</strong> service enables OAuth 2.0 authentication to the Chef server by external applications, including Chef Supermarket and Chef Analytics. OAuth 2.0 uses token-based authentication, where external applications use tokens that are issued by the <strong>oc-id</strong> provider. No special credentials&#8212;<tt class="docutils literal"><span class="pre">webui_priv.pem</span></tt> or privileged keys&#8212;are stored on the external application.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>8000</td>
<td><p class="first"><strong>opscode-erchef</strong></p>
<p>The <strong>opscode-erchef</strong> service is an Erlang-based service that is used to handle Chef server API requests to the following areas within the Chef server:</p>
<ul class="last simple">
<li>Cookbooks</li>
<li>Data bags</li>
<li>Environments</li>
<li>Nodes</li>
<li>Roles</li>
<li>Sandboxes</li>
<li>Search</li>
</ul>
</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><p class="first"><strong>opscode-expander</strong></p>
<p class="last">The <strong>opscode-expander</strong> service is used to process data (pulled from the <strong>rabbitmq</strong> service&#8217;s message queue) so that it can be properly indexed by the <strong>opscode-solr4</strong> service.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>8983</td>
<td><p class="first"><strong>opscode-solr4</strong></p>
<p class="last">The <strong>opscode-solr4</strong> service is used to create the search indexes used for searching objects like nodes, data bags, and cookbooks. (This service ensures timely search results via the Chef server API; data that is used by the Chef platform is stored in PostgreSQL.)</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>5432</td>
<td><p class="first"><strong>postgresql</strong></p>
<p class="last">The <strong>postgresql</strong> service is used to store node, object, and user data.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>5672, 15672</td>
<td><p class="first"><strong>rabbitmq</strong></p>
<p class="last">The <strong>rabbitmq</strong> service is used to provide the message queue that is used by the Chef server to get search data to Apache Solr so that it can be indexed for search. When Chef Analytics is confiugred, the <strong>rabbitmq</strong> service is also used to send data from the Chef server to the Chef Analytics server.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>16379</td>
<td><p class="first"><strong>redis_lb</strong></p>
<p class="last">Key-value store used in conjunction with Nginx to route requests and populate request data used by the Chef server.</p>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>7788-7799</td>
<td>DRBD This port range must be open between all back end servers in a high availability configuration that uses DRBD.</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tiered">
<h3>Tiered<a class="headerlink" href="#tiered" title="Permalink to this headline"></a></h3>
<p>The following sections describe the ports that are required by the Chef server in a tiered configuration:</p>
<img alt="_images/chef_server_ports_tiered.png" src="_images/chef_server_ports_tiered.png" />
<p>A single loopback interface should be configured using the <tt class="docutils literal"><span class="pre">127.0.0.1</span></tt> address. This ensures that all of the services are available to the Chef server, in the event that the Chef server attempts to contact itself from within a front or back end machine. All ports should be accessible through the loopback interface of their respective hosts.</p>
<div class="section" id="id4">
<h4>Front End<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h4>
<p>For front-end servers, ensure that ports marked as external (marked as <tt class="docutils literal"><span class="pre">yes</span></tt> in the <strong>External</strong> column) are open and accessible via any firewalls that are in use:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="78%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Port</th>
<th class="head">Service Name, Description</th>
<th class="head">External</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>80, 443, 9683</td>
<td><p class="first"><strong>nginx</strong></p>
<p>The <strong>nginx</strong> service is used to manage traffic to the Chef server, including virtual hosts for internal and external API request/response routing, external add-on request routing, and routing between front- and back-end components.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Port 9683 is used to internally load balance the <strong>oc_bifrost</strong> service.</p>
</div>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>9463</td>
<td><p class="first"><strong>oc_bifrost</strong></p>
<p class="last">The <strong>oc_bifrost</strong> service ensures that every request to view or manage objects stored on the Chef server is authorized.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>9090</td>
<td><p class="first"><strong>oc-id</strong></p>
<p class="last">The <strong>oc-id</strong> service enables OAuth 2.0 authentication to the Chef server by external applications, including Chef Supermarket and Chef Analytics. OAuth 2.0 uses token-based authentication, where external applications use tokens that are issued by the <strong>oc-id</strong> provider. No special credentials&#8212;<tt class="docutils literal"><span class="pre">webui_priv.pem</span></tt> or privileged keys&#8212;are stored on the external application.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>8000</td>
<td><p class="first"><strong>opscode-erchef</strong></p>
<p>The <strong>opscode-erchef</strong> service is an Erlang-based service that is used to handle Chef server API requests to the following areas within the Chef server:</p>
<ul class="last simple">
<li>Cookbooks</li>
<li>Data bags</li>
<li>Environments</li>
<li>Nodes</li>
<li>Roles</li>
<li>Sandboxes</li>
<li>Search</li>
</ul>
</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id5">
<h4>Back End<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<p>For back-end servers in a tiered Chef server installation, ensure that ports marked as external (marked as <tt class="docutils literal"><span class="pre">yes</span></tt> in the <strong>External</strong> column) are open and accessible via any firewalls that are in use:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="78%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Port</th>
<th class="head">Service Name, Description</th>
<th class="head">External</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>80, 443, 9683</td>
<td><p class="first"><strong>nginx</strong></p>
<p>The <strong>nginx</strong> service is used to manage traffic to the Chef server, including virtual hosts for internal and external API request/response routing, external add-on request routing, and routing between front- and back-end components.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Port 9683 is used to internally load balance the <strong>oc_bifrost</strong> service.</p>
</div>
</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>9463</td>
<td><p class="first"><strong>oc_bifrost</strong></p>
<p class="last">The <strong>oc_bifrost</strong> service ensures that every request to view or manage objects stored on the Chef server is authorized.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>8983</td>
<td><p class="first"><strong>opscode-solr4</strong></p>
<p class="last">The <strong>opscode-solr4</strong> service is used to create the search indexes used for searching objects like nodes, data bags, and cookbooks. (This service ensures timely search results via the Chef server API; data that is used by the Chef platform is stored in PostgreSQL.)</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>5432</td>
<td><p class="first"><strong>postgresql</strong></p>
<p class="last">The <strong>postgresql</strong> service is used to store node, object, and user data.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>5672, 15672</td>
<td><p class="first"><strong>rabbitmq</strong></p>
<p class="last">The <strong>rabbitmq</strong> service is used to provide the message queue that is used by the Chef server to get search data to Apache Solr so that it can be indexed for search. When Chef Analytics is confiugred, the <strong>rabbitmq</strong> service is also used to send data from the Chef server to the Chef Analytics server.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>16379</td>
<td><p class="first"><strong>redis_lb</strong></p>
<p class="last">Key-value store used in conjunction with Nginx to route requests and populate request data used by the Chef server.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>4321</td>
<td><p class="first"><strong>bookshelf</strong></p>
<p class="last">The <strong>bookshelf</strong> service is an Amazon Simple Storage Service (S3)-compatible service that is used to store cookbooks, including all of the files&#8212;recipes, templates, and so on&#8212;that are associated with each cookbook.</p>
</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>8000</td>
<td><p class="first"><strong>opscode-erchef</strong></p>
<p>The <strong>opscode-erchef</strong> service is an Erlang-based service that is used to handle Chef server API requests to the following areas within the Chef server:</p>
<ul class="last simple">
<li>Cookbooks</li>
<li>Data bags</li>
<li>Environments</li>
<li>Nodes</li>
<li>Roles</li>
<li>Sandboxes</li>
<li>Search</li>
</ul>
</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="chef-analytics">
<h3>Chef Analytics<a class="headerlink" href="#chef-analytics" title="Permalink to this headline"></a></h3>
<p>The following sections describe the ports that are required by Chef Analytics:</p>
<p>For communication between Chef Analytics and the Chef server, ensure that ports marked as external (<tt class="docutils literal"><span class="pre">yes</span></tt>) are open and accessible via any firewalls that are in use:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="78%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Port</th>
<th class="head">Service</th>
<th class="head">External</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>80</td>
<td><strong>nginx</strong></td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>443</td>
<td><strong>nginx</strong></td>
<td>yes</td>
</tr>
<tr class="row-even"><td>5672</td>
<td><p class="first"><strong>rabbitmq</strong></p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The RabbitMQ port on the Chef server must alow inbound traffic from Chef Analytics.</p>
</div>
</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>10011</td>
<td>actions</td>
<td>no</td>
</tr>
<tr class="row-even"><td>10012</td>
<td>actions_messages</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>10013</td>
<td>notifier_config</td>
<td>no</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="chef-push-jobs">
<h3>Chef Push Jobs<a class="headerlink" href="#chef-push-jobs" title="Permalink to this headline"></a></h3>
<p>TCP protocol ports 10000 and 10002. TCP/10000 is the default heartbeat port. TCP/10002 is the command port. It may be configured in the Chef push jobs configuration file . This port allows Chef push jobs clients to communicate with the Chef push jobs server. In a configuration with both front and back ends, this port only needs to be open on the back end servers. The Chef push jobs server waits for connections from the Chef push jobs client, and never initiates a connection to a Chef push jobs client.</p>
</div>
</div>
<div class="section" id="services">
<h2>Services<a class="headerlink" href="#services" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_services.rst">[edit on GitHub]</a></p>
<p>The Chef server has a built in process supervisor, which ensures that all of the required services are in the appropriate state at any given time. The supervisor starts two processes per service.</p>
<div class="section" id="service-subcommands">
<h3>Service Subcommands<a class="headerlink" href="#service-subcommands" title="Permalink to this headline"></a></h3>
<p>This command has a built in process supervisor that ensures all of the required services are in the appropriate state at any given time. The supervisor starts two processes per service and provides the following subcommands for managing services: <tt class="docutils literal"><span class="pre">hup</span></tt>, <tt class="docutils literal"><span class="pre">int</span></tt>, <tt class="docutils literal"><span class="pre">kill</span></tt>, <tt class="docutils literal"><span class="pre">once</span></tt>, <tt class="docutils literal"><span class="pre">restart</span></tt>, <tt class="docutils literal"><span class="pre">service-list</span></tt>, <tt class="docutils literal"><span class="pre">start</span></tt>, <tt class="docutils literal"><span class="pre">status</span></tt>, <tt class="docutils literal"><span class="pre">stop</span></tt>, <tt class="docutils literal"><span class="pre">tail</span></tt>, and <tt class="docutils literal"><span class="pre">term</span></tt>.</p>
<div class="section" id="hup">
<h4>hup<a class="headerlink" href="#hup" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">hup</span></tt> subcommand is used to send a <tt class="docutils literal"><span class="pre">SIGHUP</span></tt> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl hup SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
</div>
<div class="section" id="int">
<h4>int<a class="headerlink" href="#int" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">int</span></tt> subcommand is used to send a <tt class="docutils literal"><span class="pre">SIGINT</span></tt> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl int SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
</div>
<div class="section" id="kill">
<h4>kill<a class="headerlink" href="#kill" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">kill</span></tt> subcommand is used to send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
</div>
<div class="section" id="once">
<h4>once<a class="headerlink" href="#once" title="Permalink to this headline"></a></h4>
<p>The supervisor for the Chef server is configured to restart any service that fails, unless that service has been asked to change its state. The <tt class="docutils literal"><span class="pre">once</span></tt> subcommand is used to tell the supervisor to not attempt to restart any service that fails.</p>
<p>This command is useful when troubleshooting configuration errors that prevent a service from starting. Run the <tt class="docutils literal"><span class="pre">once</span></tt> subcommand followed by the <tt class="docutils literal"><span class="pre">status</span></tt> subcommand to look for services in a down state and/or to identify which services are in trouble. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
</div>
<div class="section" id="restart">
<h4>restart<a class="headerlink" href="#restart" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">restart</span></tt> subcommand is used to restart all services enabled on the Chef server or to restart an individual service by specifying the name of that service in the command.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When running the Chef server in a high availability configuration, restarting all services may trigger failover.</p>
</div>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand. When a service is successfully restarted the output should be similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: service_name: <span class="o">(</span>pid 12345<span class="o">)</span> 1s
</pre></div>
</div>
</div>
<div class="section" id="service-list">
<h4>service-list<a class="headerlink" href="#service-list" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand is used to display a list of all available services. A service that is enabled is labeled with an asterisk (*).</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl service-list
</pre></div>
</div>
</div>
<div class="section" id="start">
<h4>start<a class="headerlink" href="#start" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">start</span></tt> subcommand is used to start all services that are enabled in the Chef server. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand. When a service is successfully started the output should be similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: service_name: <span class="o">(</span>pid 12345<span class="o">)</span> 1s
</pre></div>
</div>
<p>The supervisor for the Chef server is configured to wait seven seconds for a service to respond to a command from the supervisor. If you see output that references a timeout, it means that a signal has been sent to the process, but that the process has yet to actually comply. In general, processes that have timed out are not a big concern, unless they are failing to respond to the signals at all. If a process is not responding, use a command like the <tt class="docutils literal"><span class="pre">kill</span></tt> subcommand to stop the process, investigate the cause (if required), and then use the <tt class="docutils literal"><span class="pre">start</span></tt> subcommand to re-enable it.</p>
</div>
<div class="section" id="status">
<h4>status<a class="headerlink" href="#status" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">status</span></tt> subcommand is used to show the status of all services available to the Chef server. The results will vary based on the configuration of a given server. This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status
</pre></div>
</div>
<p>and will return the status for all services. Status can be returned for individual services by specifying the name of the service as part of the command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
<p>When service status is requested, the output should be similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: service_name: <span class="o">(</span>pid 12345<span class="o">)</span> 12345s<span class="p">;</span> run: log: <span class="o">(</span>pid 1234<span class="o">)</span> 67890s
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">run:</span></tt> is the state of the service (<tt class="docutils literal"><span class="pre">run:</span></tt> or <tt class="docutils literal"><span class="pre">down:</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">service_name:</span></tt> is the name of the service for which status is returned</li>
<li><tt class="docutils literal"><span class="pre">(pid</span> <span class="pre">12345)</span></tt> is the process identifier</li>
<li><tt class="docutils literal"><span class="pre">12345s</span></tt> is the uptime of the service, in seconds</li>
</ul>
<p>For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ down: opscode-erchef: <span class="o">(</span>pid 35546<span class="o">)</span> 10s
</pre></div>
</div>
<p>By default, runit will restart services automatically when the services fail. Therefore, runit may report the status of a service as <tt class="docutils literal"><span class="pre">run:</span></tt> even when there is an issue with that service. When investigating why a particular service is not running as it should be, look for the services with the shortest uptimes. For example, the list below indicates that the <strong>opscode-erchef</strong> should be investigated further:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>run: oc-id
run: opscode-chef: <span class="o">(</span>pid 4327<span class="o">)</span> 13671s<span class="p">;</span> run: log: <span class="o">(</span>pid 4326<span class="o">)</span> 13671s
run: opscode-erchef: <span class="o">(</span>pid 5383<span class="o">)</span> 5s<span class="p">;</span> run: log: <span class="o">(</span>pid 4382<span class="o">)</span> 13669s
run: opscode-expander: <span class="o">(</span>pid 4078<span class="o">)</span> 13694s<span class="p">;</span> run: log: <span class="o">(</span>pid 4077<span class="o">)</span> 13694s
run: opscode-expander-reindexer: <span class="o">(</span>pid 4130<span class="o">)</span> 13692s<span class="p">;</span> run: log: <span class="o">(</span>pid 4114<span class="o">)</span> 13692s
</pre></div>
</div>
<div class="section" id="id6">
<h5>High Availability<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h5>
<p>On back-end servers in a high availability topology, Keepalived is used by the clustering service to determine whether a service should be running. If the <tt class="docutils literal"><span class="pre">status</span></tt> subcommand is run against any of these nodes, a few things change:</p>
<ul class="simple">
<li>On the back-end node that is currently the backup server, it is normal to see only one running process: Keepalived</li>
<li>On the back-end node that is currently the master server, it is normal to see all services running. It is also normal to see some services in a down state if the server, on reboot, did not attempt to start the services because Keepalived determines which services are restarted based on the state of the cluster</li>
</ul>
<p>A sample status line for a service that is running on the master server in a high availability topology:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>run: opscode-solr4: <span class="o">(</span>pid 25341<span class="o">)</span> 239s, normally down<span class="p">;</span> run: log: <span class="o">(</span>pid 5700<span class="o">)</span> 145308s
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h5>Log Files<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h5>
<p>A typical status line for a service that is running any of the Chef server front-end services is similar to the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>run: name_of_service: <span class="o">(</span>pid 1486<span class="o">)</span> 7819s<span class="p">;</span> run: log: <span class="o">(</span>pid 1485<span class="o">)</span> 7819s
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">run</span></tt> describes the state in which the supervisor attempts to keep processes. This state is either <tt class="docutils literal"><span class="pre">run</span></tt> or <tt class="docutils literal"><span class="pre">down</span></tt>. If a service is in a <tt class="docutils literal"><span class="pre">down</span></tt> state, it should be stopped</li>
<li><tt class="docutils literal"><span class="pre">name_of_service</span></tt> is the service name, for example: <tt class="docutils literal"><span class="pre">opscode-solr4</span></tt></li>
<li><tt class="docutils literal"><span class="pre">(pid</span> <span class="pre">1486)</span> <span class="pre">7819s;</span></tt> is the process identifier followed by the amount of time (in seconds) the service has been running</li>
<li><tt class="docutils literal"><span class="pre">run:</span> <span class="pre">log:</span> <span class="pre">(pid</span> <span class="pre">1485)</span> <span class="pre">7819s</span></tt> is the log process. It is typical for a log process to have a longer run time than a service; this is because the supervisor does not need to restart the log process in order to connect the supervised process</li>
</ul>
<p>If the service is down, the status line will appear similar to the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>down: opscode-solr4: 3s, normally up<span class="p">;</span> run: log: <span class="o">(</span>pid 1485<span class="o">)</span> 8526s
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">down</span></tt> indicates that the service is in a down state</li>
<li><tt class="docutils literal"><span class="pre">3s,</span> <span class="pre">normally</span> <span class="pre">up;</span></tt> indicates that the service is normally in a run state and that the supervisor would attempt to restart this service after a reboot</li>
</ul>
</div>
</div>
<div class="section" id="stop">
<h4>stop<a class="headerlink" href="#stop" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">stop</span></tt> subcommand is used to stop all services enabled on the Chef server. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand. When a service is successfully stopped the output should be similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: diwb: service_name: 0s, normally up
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop
</pre></div>
</div>
<p>will return something similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ok: down: nginx: 393s, normally up
ok: down: opscode-chef: 391s, normally up
ok: down: opscode-erchef: 391s, normally up
ok: down: opscode-expander: 390s, normally up
ok: down: opscode-expander-reindexer: 389s, normally up
ok: down: opscode-solr4: 389s, normally up
ok: down: postgresql: 388s, normally up
ok: down: rabbitmq: 388s, normally up
ok: down: redis_lb: 387s, normally up
</pre></div>
</div>
</div>
<div class="section" id="tail">
<h4>tail<a class="headerlink" href="#tail" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">tail</span></tt> subcommand is used to follow all of the Chef server logs for all services. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
</div>
<div class="section" id="term">
<h4>term<a class="headerlink" href="#term" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">term</span></tt> subcommand is used to send a <tt class="docutils literal"><span class="pre">SIGTERM</span></tt> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl term SERVICE_NAME
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">SERVICE_NAME</span></tt> represents the name of any service that is listed after running the <tt class="docutils literal"><span class="pre">service-list</span></tt> subcommand.</p>
</div>
</div>
<div class="section" id="list-of-services">
<h3>List of Services<a class="headerlink" href="#list-of-services" title="Permalink to this headline"></a></h3>
<p>The following services are part of the Chef server:</p>
<ul class="simple">
<li>bifrost</li>
<li>bookshelf</li>
<li>keepalived</li>
<li>nginx</li>
<li>opscode-erchef</li>
<li>opscode-expander</li>
<li>opscode-solr4</li>
<li>postgresql</li>
<li>rabbitmq</li>
<li>redis-lb</li>
</ul>
<div class="section" id="bifrost">
<h4>bifrost<a class="headerlink" href="#bifrost" title="Permalink to this headline"></a></h4>
<p>The <strong>oc_bifrost</strong> service ensures that every request to view or manage objects stored on the Chef server is authorized.</p>
<div class="section" id="id8">
<h5>status<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status bifrost
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: bifrost: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h5>start<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start bifrost
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h5>stop<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop bifrost
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h5>restart<a class="headerlink" href="#id11" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart bifrost
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: bifrost: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h5>kill<a class="headerlink" href="#id12" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> bifrost
</pre></div>
</div>
</div>
<div class="section" id="run-once">
<h5>run once<a class="headerlink" href="#run-once" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once bifrost
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h5>tail<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail bifrost
</pre></div>
</div>
</div>
</div>
<div class="section" id="bookshelf">
<h4>bookshelf<a class="headerlink" href="#bookshelf" title="Permalink to this headline"></a></h4>
<p>The <strong>bookshelf</strong> service is an Amazon Simple Storage Service (S3)-compatible service that is used to store cookbooks, including all of the files&#8212;recipes, templates, and so on&#8212;that are associated with each cookbook.</p>
<div class="section" id="id14">
<h5>status<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status bookshelf
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: bookshelf: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h5>start<a class="headerlink" href="#id15" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start bookshelf
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h5>stop<a class="headerlink" href="#id16" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop bookshelf
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h5>restart<a class="headerlink" href="#id17" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart bookshelf
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: bookshelf: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h5>kill<a class="headerlink" href="#id18" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> bookshelf
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h5>run once<a class="headerlink" href="#id19" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once bookshelf
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h5>tail<a class="headerlink" href="#id20" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail bookshelf
</pre></div>
</div>
</div>
</div>
<div class="section" id="keepalived">
<h4>keepalived<a class="headerlink" href="#keepalived" title="Permalink to this headline"></a></h4>
<p>The <strong>keepalived</strong> service manages the virtual IP address (VIP) between the backend machines in a high availability topology that uses DRBD.</p>
<div class="section" id="id21">
<h5>status<a class="headerlink" href="#id21" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status keepalived
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: keepalived: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h5>start<a class="headerlink" href="#id22" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start keepalived
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h5>stop<a class="headerlink" href="#id23" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop keepalived
</pre></div>
</div>
</div>
<div class="section" id="id24">
<h5>restart<a class="headerlink" href="#id24" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart keepalived
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: keepalived: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h5>kill<a class="headerlink" href="#id25" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> keepalived
</pre></div>
</div>
</div>
<div class="section" id="id26">
<h5>run once<a class="headerlink" href="#id26" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once keepalived
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h5>tail<a class="headerlink" href="#id27" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail keepalived
</pre></div>
</div>
</div>
</div>
<div class="section" id="id28">
<h4>nginx<a class="headerlink" href="#id28" title="Permalink to this headline"></a></h4>
<p>The <strong>nginx</strong> service is used to manage traffic to the Chef server, including virtual hosts for internal and external API request/response routing, external add-on request routing, and routing between front- and back-end components.</p>
<div class="section" id="id29">
<h5>status<a class="headerlink" href="#id29" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status nginx
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: nginx: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id30">
<h5>start<a class="headerlink" href="#id30" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start nginx
</pre></div>
</div>
</div>
<div class="section" id="id31">
<h5>stop<a class="headerlink" href="#id31" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop nginx
</pre></div>
</div>
</div>
<div class="section" id="id32">
<h5>restart<a class="headerlink" href="#id32" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart nginx
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: nginx: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id33">
<h5>kill<a class="headerlink" href="#id33" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> nginx
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h5>run once<a class="headerlink" href="#id34" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once nginx
</pre></div>
</div>
</div>
<div class="section" id="id35">
<h5>tail<a class="headerlink" href="#id35" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail nginx
</pre></div>
</div>
</div>
</div>
<div class="section" id="id36">
<h4>opscode-erchef<a class="headerlink" href="#id36" title="Permalink to this headline"></a></h4>
<p>The <strong>opscode-erchef</strong> service is an Erlang-based service that is used to handle Chef server API requests to the following areas within the Chef server:</p>
<ul class="simple">
<li>Cookbooks</li>
<li>Data bags</li>
<li>Environments</li>
<li>Nodes</li>
<li>Roles</li>
<li>Sandboxes</li>
<li>Search</li>
</ul>
<div class="section" id="id37">
<h5>status<a class="headerlink" href="#id37" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status opscode-erchef
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: opscode-erchefs: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id38">
<h5>start<a class="headerlink" href="#id38" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start opscode-erchef
</pre></div>
</div>
</div>
<div class="section" id="id39">
<h5>stop<a class="headerlink" href="#id39" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop opscode-erchef
</pre></div>
</div>
</div>
<div class="section" id="id40">
<h5>restart<a class="headerlink" href="#id40" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart opscode-erchef
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: opscode-erchef: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id41">
<h5>kill<a class="headerlink" href="#id41" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> opscode-erchef
</pre></div>
</div>
</div>
<div class="section" id="id42">
<h5>run once<a class="headerlink" href="#id42" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once opscode-erchef
</pre></div>
</div>
</div>
<div class="section" id="id43">
<h5>tail<a class="headerlink" href="#id43" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail opscode-erchef
</pre></div>
</div>
</div>
</div>
<div class="section" id="id44">
<h4>opscode-expander<a class="headerlink" href="#id44" title="Permalink to this headline"></a></h4>
<p>The <strong>opscode-expander</strong> service is used to process data (pulled from the <strong>rabbitmq</strong> service&#8217;s message queue) so that it can be properly indexed by the <strong>opscode-solr4</strong> service.</p>
<div class="section" id="id45">
<h5>status<a class="headerlink" href="#id45" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status opscode-expander
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: opscode-expander: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id46">
<h5>start<a class="headerlink" href="#id46" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start opscode-expander
</pre></div>
</div>
</div>
<div class="section" id="id47">
<h5>stop<a class="headerlink" href="#id47" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop opscode-expander
</pre></div>
</div>
</div>
<div class="section" id="id48">
<h5>restart<a class="headerlink" href="#id48" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart opscode-expander
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: opscode-expander: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id49">
<h5>kill<a class="headerlink" href="#id49" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> opscode-expander
</pre></div>
</div>
</div>
<div class="section" id="id50">
<h5>run once<a class="headerlink" href="#id50" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once opscode-expander
</pre></div>
</div>
</div>
<div class="section" id="id51">
<h5>tail<a class="headerlink" href="#id51" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail opscode-expander
</pre></div>
</div>
</div>
</div>
<div class="section" id="opscode-solr4">
<h4>opscode-solr4<a class="headerlink" href="#opscode-solr4" title="Permalink to this headline"></a></h4>
<p>The <strong>opscode-solr4</strong> service is used to create the search indexes used for searching objects like nodes, data bags, and cookbooks. (This service ensures timely search results via the Chef server API; data that is used by the Chef platform is stored in PostgreSQL.)</p>
<div class="section" id="id52">
<h5>status<a class="headerlink" href="#id52" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status opscode-solr
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: opscode-solr: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id53">
<h5>start<a class="headerlink" href="#id53" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start opscode-solr
</pre></div>
</div>
</div>
<div class="section" id="id54">
<h5>stop<a class="headerlink" href="#id54" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop opscode-solr
</pre></div>
</div>
</div>
<div class="section" id="id55">
<h5>restart<a class="headerlink" href="#id55" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart opscode-solr
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: opscode-solr: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id56">
<h5>kill<a class="headerlink" href="#id56" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> opscode-solr
</pre></div>
</div>
</div>
<div class="section" id="id57">
<h5>run once<a class="headerlink" href="#id57" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once opscode-solr
</pre></div>
</div>
</div>
<div class="section" id="id58">
<h5>tail<a class="headerlink" href="#id58" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail opscode-solr
</pre></div>
</div>
</div>
</div>
<div class="section" id="id59">
<h4>postgresql<a class="headerlink" href="#id59" title="Permalink to this headline"></a></h4>
<p>The <strong>postgresql</strong> service is used to store node, object, and user data.</p>
<div class="section" id="id60">
<h5>status<a class="headerlink" href="#id60" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status postgresql
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: postgresql: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id61">
<h5>start<a class="headerlink" href="#id61" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start postgresql
</pre></div>
</div>
</div>
<div class="section" id="id62">
<h5>stop<a class="headerlink" href="#id62" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop postgresql
</pre></div>
</div>
</div>
<div class="section" id="id63">
<h5>restart<a class="headerlink" href="#id63" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart postgresql
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: postgresql: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id64">
<h5>kill<a class="headerlink" href="#id64" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> postgresql
</pre></div>
</div>
</div>
<div class="section" id="id65">
<h5>run once<a class="headerlink" href="#id65" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once postgresqls
</pre></div>
</div>
</div>
<div class="section" id="id66">
<h5>tail<a class="headerlink" href="#id66" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail postgresql
</pre></div>
</div>
</div>
</div>
<div class="section" id="id67">
<h4>rabbitmq<a class="headerlink" href="#id67" title="Permalink to this headline"></a></h4>
<p>The <strong>rabbitmq</strong> service is used to provide the message queue that is used by the Chef server to get search data to Apache Solr so that it can be indexed for search. When Chef Analytics is confiugred, the <strong>rabbitmq</strong> service is also used to send data from the Chef server to the Chef Analytics server.</p>
<div class="section" id="id68">
<h5>status<a class="headerlink" href="#id68" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status rabbitmq
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: rabbitmq: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id69">
<h5>start<a class="headerlink" href="#id69" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start rabbitmq
</pre></div>
</div>
</div>
<div class="section" id="id70">
<h5>stop<a class="headerlink" href="#id70" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop rabbitmq
</pre></div>
</div>
</div>
<div class="section" id="id71">
<h5>restart<a class="headerlink" href="#id71" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart rabbitmq
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: rabbitmq: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id72">
<h5>kill<a class="headerlink" href="#id72" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> rabbitmq
</pre></div>
</div>
</div>
<div class="section" id="id73">
<h5>run once<a class="headerlink" href="#id73" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once rabbitmq
</pre></div>
</div>
</div>
<div class="section" id="id74">
<h5>tail<a class="headerlink" href="#id74" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail rabbitmq
</pre></div>
</div>
</div>
</div>
<div class="section" id="id75">
<h4>redis<a class="headerlink" href="#id75" title="Permalink to this headline"></a></h4>
<p>Key-value store used in conjunction with Nginx to route requests and populate request data used by the Chef server.</p>
<div class="section" id="id76">
<h5>status<a class="headerlink" href="#id76" title="Permalink to this headline"></a></h5>
<p>To view the status for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl status redis
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run: redis: <span class="o">(</span>pid 1234<span class="o">)</span> 123456s<span class="p">;</span> run: log: <span class="o">(</span>pid 5678<span class="o">)</span> 789012s
</pre></div>
</div>
</div>
<div class="section" id="id77">
<h5>start<a class="headerlink" href="#id77" title="Permalink to this headline"></a></h5>
<p>To start the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start redis
</pre></div>
</div>
</div>
<div class="section" id="id78">
<h5>stop<a class="headerlink" href="#id78" title="Permalink to this headline"></a></h5>
<p>To stop the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop redis
</pre></div>
</div>
</div>
<div class="section" id="id79">
<h5>restart<a class="headerlink" href="#id79" title="Permalink to this headline"></a></h5>
<p>To restart the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart redis
</pre></div>
</div>
<p>to return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ok: run: redis: <span class="o">(</span>pid 1234<span class="o">)</span> 1234s
</pre></div>
</div>
</div>
<div class="section" id="id80">
<h5>kill<a class="headerlink" href="#id80" title="Permalink to this headline"></a></h5>
<p>To kill the service (send a <tt class="docutils literal"><span class="pre">SIGKILL</span></tt> command):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl <span class="nb">kill</span> name_of_service
</pre></div>
</div>
</div>
<div class="section" id="id81">
<h5>run once<a class="headerlink" href="#id81" title="Permalink to this headline"></a></h5>
<p>To run the service, but not restart it (if the service fails):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl once redis
</pre></div>
</div>
</div>
<div class="section" id="id82">
<h5>tail<a class="headerlink" href="#id82" title="Permalink to this headline"></a></h5>
<p>To follow the logs for the service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl tail name_of_service
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="security">
<h2>Security<a class="headerlink" href="#security" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_security.rst">[edit on GitHub]</a></p>
<p>Configuration of SSL for the Chef server using certificate authority-verified certificates is done by placing the certificate and private key file obtained from the certifying authority in the correct files after the initial configuration of Chef server.</p>
<p>Initial configuration of the Chef server is done automatically using a self-signed certificate to create the certificate and private key files for Nginx.</p>
<p>The locations of the certificate and private key files are</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">/var/opt/opscode/nginx/ca/FQDN.crt</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/var/opt/opscode/nginx/ca/FQDN.key</span></tt></li>
</ul>
<p>Because the FQDN has already been configured, do the following:</p>
<ol class="arabic">
<li><p class="first">Replace the contents of <tt class="docutils literal"><span class="pre">/var/opt/opscode/nginx/ca/FQDN.crt</span></tt> and <tt class="docutils literal"><span class="pre">/var/opt/opscode/nginx/ca/FQDN.key</span></tt> with the certifying authority&#8217;s files.</p>
</li>
<li><p class="first">Reconfigure the Chef server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl reconfigure
</pre></div>
</div>
</li>
<li><p class="first">Restart the Nginx service to load the new key and certificate:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restart nginx
</pre></div>
</div>
</li>
</ol>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The FQDN for the Chef server should not exceed 64 characters when using OpenSSL. OpenSSL requires the <tt class="docutils literal"><span class="pre">CN</span></tt> in a certificate to be no longer than 64 characters.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">By default, the Chef server uses the FQDN to determine the common name (<tt class="docutils literal"><span class="pre">CN</span></tt>). If the FQDN of the Chef server is longer than 64 characters, the <tt class="docutils literal"><span class="pre">reconfigure</span></tt> command will not fail, but an empty certificate file will be created. Nginx will not start if a certificate file is empty.</p>
</div>
<div class="section" id="ssl-certificates">
<h3>SSL Certificates<a class="headerlink" href="#ssl-certificates" title="Permalink to this headline"></a></h3>
<p>The Chef server can be configured to use SSL certificates by adding the following settings to the server configuration file:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">nginx['ssl_certificate']</span></tt></td>
<td>The SSL certificate used to verify communication over HTTPS.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">nginx['ssl_certificate_key']</span></tt></td>
<td>The certificate key used for SSL communication.</td>
</tr>
</tbody>
</table>
<p>and then setting their values to define the paths to the certificate and key.</p>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_certificate&#39;</span><span class="o">]</span>  <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/certs/your-host.crt&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_certificate_key&#39;</span><span class="o">]</span>  <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/private/your-host.key&quot;</span>
</pre></div>
</div>
<p>Save the file, and then run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo chef-server-ctl reconfigure
</pre></div>
</div>
<p>For more information about the server configuration file, see <a class="reference internal" href="config_rb_server.html"><em>chef-server.rb</em></a>.</p>
<div class="section" id="ssl-protocols">
<h4>SSL Protocols<a class="headerlink" href="#ssl-protocols" title="Permalink to this headline"></a></h4>
<p>The following settings are often modified from the default as part of the tuning effort for the <strong>nginx</strong> service and to configure the Chef server to use SSL certificates:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_certificate']</span></tt></dt>
<dd>The SSL certificate used to verify communication over HTTPS. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_certificate_key']</span></tt></dt>
<dd>The certificate key used for SSL communication. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_ciphers']</span></tt></dt>
<dd><p class="first">The list of supported cipher suites that are used to establish a secure connection. To favor AES256 with ECDHE forward security, drop the <tt class="docutils literal"><span class="pre">RC4-SHA:RC4-MD5:RC4:RSA</span></tt> prefix. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_ciphers&#39;</span><span class="o">]</span> <span class="o">=</span>  <span class="s2">&quot;HIGH:MEDIUM:!LOW:!kEDH: \</span>
<span class="s2">                         !aNULL:!ADH:!eNULL:!EXP: \</span>
<span class="s2">                         !SSLv2:!SEED:!CAMELLIA: \</span>
<span class="s2">                         !PSK&quot;</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_protocols']</span></tt></dt>
<dd><p class="first">The SSL protocol versions that are enabled. SSL 3.0 is supported by the Chef server; however, SSL 3.0 is an obsolete and insecure protocol. Transport Layer Security (TLS)&#8212;TLS 1.0, TLS 1.1, and TLS 1.2&#8212;has effectively replaced SSL 3.0, which provides for authenticated version negotiation between the chef-client and Chef server, which ensures the latest version of the TLS protocol is used. For the highest possible security, it is recommended to disable SSL 3.0 and allow all versions of the TLS protocol.  For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_protocols&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;TLSv1 TLSv1.1 TLSv1.2&quot;</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference external" href="https://wiki.mozilla.org/Security/Server_Side_TLS">https://wiki.mozilla.org/Security/Server_Side_TLS</a> for more information about the values used with the <tt class="docutils literal"><span class="pre">nginx['ssl_ciphers']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_protocols']</span></tt> settings.</p>
</div>
<p>For example, after copying the SSL certificate files to the Chef server, update the <tt class="docutils literal"><span class="pre">nginx['ssl_certificate']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_certificate_key']</span></tt> settings to specify the paths to those files, and then (optionally) update the <tt class="docutils literal"><span class="pre">nginx['ssl_ciphers']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_protocols']</span></tt> settings to reflect the desired level of hardness for the Chef server:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_certificate&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/private/name.of.pem&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_certificate_key&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/private/name.of.key&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_ciphers&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_protocols&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;TLSv1 TLSv1.1 TLSv1.2&quot;</span>
</pre></div>
</div>
<p><strong>Example: Configure SSL Keys for Nginx</strong></p>
<p>The following example shows how the Chef server sets up and configures SSL certificates for Nginx. The cipher suite used by Nginx <a class="reference external" href="https://docs.chef.io/config_rb_server.html#ssl-protocols">is configurable</a> using the <tt class="docutils literal"><span class="pre">ssl_protocols</span></tt> and <tt class="docutils literal"><span class="pre">ssl_ciphers</span></tt> settings.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">ssl_keyfile</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nginx_ca_dir</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;private_chef&#39;</span><span class="o">][</span><span class="s1">&#39;nginx&#39;</span><span class="o">][</span><span class="s1">&#39;server_name&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">.key&quot;</span><span class="p">)</span>
<span class="n">ssl_crtfile</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nginx_ca_dir</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;private_chef&#39;</span><span class="o">][</span><span class="s1">&#39;nginx&#39;</span><span class="o">][</span><span class="s1">&#39;server_name&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">.crt&quot;</span><span class="p">)</span>
<span class="n">ssl_signing_conf</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nginx_ca_dir</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;private_chef&#39;</span><span class="o">][</span><span class="s1">&#39;nginx&#39;</span><span class="o">][</span><span class="s1">&#39;server_name&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">-ssl.conf&quot;</span><span class="p">)</span>

<span class="k">unless</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">ssl_keyfile</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">ssl_crtfile</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">ssl_signing_conf</span><span class="p">)</span>
  <span class="n">file</span> <span class="n">ssl_keyfile</span> <span class="k">do</span>
    <span class="n">owner</span> <span class="s1">&#39;root&#39;</span>
    <span class="n">group</span> <span class="s1">&#39;root&#39;</span>
    <span class="n">mode</span> <span class="s1">&#39;0755&#39;</span>
    <span class="n">content</span> <span class="s1">&#39;/opt/opscode/embedded/bin/openssl genrsa 2048&#39;</span>
    <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">ssl_keyfile</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="n">file</span> <span class="n">ssl_signing_conf</span> <span class="k">do</span>
    <span class="n">owner</span> <span class="s1">&#39;root&#39;</span>
    <span class="n">group</span> <span class="s1">&#39;root&#39;</span>
    <span class="n">mode</span> <span class="s1">&#39;0755&#39;</span>
    <span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">ssl_signing_conf</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">content</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  [ req ]</span>
<span class="sh">  distinguished_name = req_distinguished_name</span>
<span class="sh">  prompt = no</span>
<span class="sh">  [ req_distinguished_name ]</span>
<span class="sh">  C                      = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;ssl_country_name&#39;]}</span>
<span class="sh">  ST                     = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;ssl_state_name&#39;]}</span>
<span class="sh">  L                      = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;ssl_locality_name&#39;]}</span>
<span class="sh">  O                      = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;ssl_company_name&#39;]}</span>
<span class="sh">  OU                     = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;ssl_organizational_unit_name&#39;]}</span>
<span class="sh">  CN                     = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;server_name&#39;]}</span>
<span class="sh">  emailAddress           = #{node[&#39;private_chef&#39;][&#39;nginx&#39;][&#39;ssl_email_address&#39;]}</span>
<span class="no">  EOH</span>
  <span class="k">end</span>

  <span class="n">ruby_block</span> <span class="s1">&#39;create crtfile&#39;</span> <span class="k">do</span>
    <span class="n">block</span> <span class="k">do</span>
      <span class="n">r</span> <span class="o">=</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Resource</span><span class="o">::</span><span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">ssl_crtfile</span><span class="p">,</span> <span class="n">run_context</span><span class="p">)</span>
      <span class="n">r</span><span class="o">.</span><span class="n">owner</span> <span class="s1">&#39;root&#39;</span>
      <span class="n">r</span><span class="o">.</span><span class="n">group</span> <span class="s1">&#39;root&#39;</span>
      <span class="n">r</span><span class="o">.</span><span class="n">mode</span> <span class="s1">&#39;0755&#39;</span>
      <span class="n">r</span><span class="o">.</span><span class="n">content</span> <span class="s2">&quot;/opt/opscode/embedded/bin/openssl req -config &#39;</span><span class="si">#{</span><span class="n">ssl_signing_conf</span><span class="si">}</span><span class="s2">&#39; -new -x509 -nodes -sha1 -days 3650 -key &#39;</span><span class="si">#{</span><span class="n">ssl_keyfile</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
      <span class="n">r</span><span class="o">.</span><span class="n">not_if</span> <span class="p">{</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">ssl_crtfile</span><span class="p">)</span> <span class="p">}</span>
      <span class="n">r</span><span class="o">.</span><span class="n">run_action</span><span class="p">(</span><span class="ss">:create</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="id83">
<h4>Chef Analytics<a class="headerlink" href="#id83" title="Permalink to this headline"></a></h4>
<p>The Chef Analytics server can be configured to use SSL certificates by adding the following settings in the server configuration file:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ssl['certificate']</span></tt></td>
<td>The SSL certificate used to verify communication over HTTPS.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ssl['certificate_key']</span></tt></td>
<td>The certificate key used for SSL communication.</td>
</tr>
</tbody>
</table>
<p>and then setting their values to define the paths to the certificate and key.</p>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">ssl</span><span class="o">[</span><span class="s1">&#39;certificate&#39;</span><span class="o">]</span>  <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/certs/your-host.crt&quot;</span>
<span class="n">ssl</span><span class="o">[</span><span class="s1">&#39;certificate_key&#39;</span><span class="o">]</span>  <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/private/your-host.key&quot;</span>
</pre></div>
</div>
<p>Save the file, and then run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo opscode-analytics-ctl reconfigure
</pre></div>
</div>
</div>
<div class="section" id="knife-chef-client">
<h4>Knife, chef-client<a class="headerlink" href="#knife-chef-client" title="Permalink to this headline"></a></h4>
<p>Chef server 12 enables SSL verification by default for all requests made to the server, such as those made by knife and the chef-client. The certificate that is generated during the installation of the Chef server is self-signed, which means the certificate is not signed by a trusted certificate authority (CA) that ships with the chef-client. The certificate generated by the Chef server must be downloaded to any machine from which knife and/or the chef-client will make requests to the Chef server.</p>
<p>For example, without downloading the SSL certificate, the following knife command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ knife client list
</pre></div>
</div>
<p>responds with an error similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ERROR: SSL Validation failure connecting to host: chef-server.example.com ...
ERROR: OpenSSL::SSL::SSLError: SSL_connect <span class="nv">returned</span><span class="o">=</span><span class="m">1</span> <span class="nv">errno</span><span class="o">=</span><span class="m">0</span> <span class="nv">state</span><span class="o">=</span>SSLv3 ...
</pre></div>
</div>
<p>This is by design and will occur until a verifiable certificate is added to the machine from which the request is sent.</p>
<p>See <a class="reference external" href="https://docs.chef.io/chef_client_security.html#ssl-certificates">SSL Certificates</a> for more information about how knife and the chef-client use SSL certificates generated by the Chef server.</p>
</div>
<div class="section" id="private-certificate-authority">
<h4>Private Certificate Authority<a class="headerlink" href="#private-certificate-authority" title="Permalink to this headline"></a></h4>
<p>If an organization is using an internal certificate authority, then the root certificate will not appear in any <tt class="docutils literal"><span class="pre">cacerts.pem</span></tt> file that ships by default with operating systems and web browsers. Because of this, no currently deployed system will be able to verify certificates that are issued in this manner. To allow other systems to trust certificates from an internal certificate authority, this root certificate will need to be configured so that other systems can follow the chain of authority back to the root certificate. (An intermediate certificate is not enough becuase the root certificate is not already globally known.)</p>
<p>To use an internal certificate authority, append both the server and root certificates into a single <tt class="docutils literal"><span class="pre">.crt</span></tt> file. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cat server.crt root.crt &gt;&gt; /var/opt/opscode/nginx/ca/FQDN.crt
</pre></div>
</div>
</div>
<div class="section" id="intermediate-certificates">
<h4>Intermediate Certificates<a class="headerlink" href="#intermediate-certificates" title="Permalink to this headline"></a></h4>
<p>To use an intermediate certificate, append both the server and intermediate certificates into a single <tt class="docutils literal"><span class="pre">.crt</span></tt> file. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cat server.crt intermediate.crt &gt;&gt; /var/opt/opscode/nginx/ca/FQDN.crt
</pre></div>
</div>
</div>
<div class="section" id="regenerate-certificates">
<h4>Regenerate Certificates<a class="headerlink" href="#regenerate-certificates" title="Permalink to this headline"></a></h4>
<p>SSL certificates should be regenerated periodically. This is an important part of protecting the Chef server from vulnerabilities and helps to prevent the information stored on the Chef server from being compromised.</p>
<p>To regenerate SSL certificates:</p>
<ol class="arabic">
<li><p class="first">Run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop
</pre></div>
</div>
</li>
<li><p class="first">The Chef server can regenerate them. These certificates will be located in <tt class="docutils literal"><span class="pre">/var/opt/opscode/nginx/ca/</span></tt> and will be named after the FQDN for the Chef server. To determine the FQDN for the server, run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ hostname -f
</pre></div>
</div>
<p>Please delete the files found in the ca directory with names like this <tt class="docutils literal"><span class="pre">$FQDN.crt</span></tt> and <tt class="docutils literal"><span class="pre">$FQDN.key</span></tt>.</p>
</li>
<li><p class="first">If your organization has provided custom SSL certificates to the Chef server, the locations of that custom certificate and private key are defined in <tt class="docutils literal"><span class="pre">/etc/opscode/chef-server.rb</span></tt> as values for the <tt class="docutils literal"><span class="pre">nginx['ssl_certificate']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_certificate_key']</span></tt> settings. Delete the files referenced in those two settings and regenerate new keys using the same authority.</p>
</li>
<li><p class="first">Run the following command, Chef server-generated SSL certificates will automatically be created if necessary:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl reconfigure
</pre></div>
</div>
</li>
<li><p class="first">Run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="key-rotation">
<h3>Key Rotation<a class="headerlink" href="#key-rotation" title="Permalink to this headline"></a></h3>
<p>Use the following commands to manage public and private key rotation for users and clients.</p>
<div class="section" id="add-client-key">
<h4>add-client-key<a class="headerlink" href="#add-client-key" title="Permalink to this headline"></a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">add-client-key</span></tt> subcommand to add a client key.</p>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl add-client-key ORG_NAME CLIENT_NAME <span class="o">[</span>--public-key-path PATH<span class="o">]</span> <span class="o">[</span>--expiration-date DATE<span class="o">]</span> <span class="o">[</span>--key-name NAME<span class="o">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">All options for this subcommand must follow all arguments.</p>
</div>
<p><strong>Options</strong></p>
<p>This subcommand has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">CLIENT_NAME</span></tt></dt>
<dd>The name of the client that you wish to add a key for.</dd>
<dt><tt class="docutils literal"><span class="pre">-e</span> <span class="pre">DATE</span></tt> <tt class="docutils literal"><span class="pre">--expiration-date</span> <span class="pre">DATE</span></tt></dt>
<dd>An ISO 8601 formatted string: <tt class="docutils literal"><span class="pre">YYYY-MM-DDTHH:MM:SSZ</span></tt>. For example: <tt class="docutils literal"><span class="pre">2013-12-24T21:00:00Z</span></tt>. If not passed, expiration will default to infinity.</dd>
<dt><tt class="docutils literal"><span class="pre">-k</span> <span class="pre">NAME</span></tt> <tt class="docutils literal"><span class="pre">--key-name</span> <span class="pre">NAME</span></tt></dt>
<dd>String defining the name of your new key for this client. If not passed, it will default to the fingerprint of the public key.</dd>
<dt><tt class="docutils literal"><span class="pre">ORG_NAME</span></tt></dt>
<dd>The short name for the organization to which the client belongs.</dd>
<dt><tt class="docutils literal"><span class="pre">-p</span> <span class="pre">PATH</span></tt> <tt class="docutils literal"><span class="pre">--public-key-path</span> <span class="pre">PATH</span></tt></dt>
<dd>The location to a file containing valid PKCS#1 public key to be added. If not passed, then the server will generate a new one for you and return the private key to STDOUT.</dd>
</dl>
</div>
<div class="section" id="add-user-key">
<h4>add-user-key<a class="headerlink" href="#add-user-key" title="Permalink to this headline"></a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">add-user-key</span></tt> subcommand to add a user key.</p>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl add-user-key USER_NAME <span class="o">[</span>--public-key-path PATH<span class="o">]</span> <span class="o">[</span>--expiration-date DATE<span class="o">]</span> <span class="o">[</span>--key-name NAME<span class="o">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">All options for this subcommand must follow all arguments.</p>
</div>
<p><strong>Options</strong></p>
<p>This subcommand has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-e</span> <span class="pre">DATE</span></tt> <tt class="docutils literal"><span class="pre">--expiration-date</span> <span class="pre">DATE</span></tt></dt>
<dd>An ISO 8601 formatted string: <tt class="docutils literal"><span class="pre">YYYY-MM-DDTHH:MM:SSZ</span></tt>. For example: <tt class="docutils literal"><span class="pre">2013-12-24T21:00:00Z</span></tt>. If not passed, expiration will default to infinity.</dd>
<dt><tt class="docutils literal"><span class="pre">-k</span> <span class="pre">NAME</span></tt> <tt class="docutils literal"><span class="pre">--key-name</span> <span class="pre">NAME</span></tt></dt>
<dd>String defining the name of your new key for this user. If not passed, it will default to the fingerprint of the public key.</dd>
<dt><tt class="docutils literal"><span class="pre">-p</span> <span class="pre">PATH</span></tt> <tt class="docutils literal"><span class="pre">--public-key-path</span> <span class="pre">PATH</span></tt></dt>
<dd>The location to a file containing valid PKCS#1 public key to be added. If not passed, then the server will generate a new one for you and return the private key to STDOUT.</dd>
<dt><tt class="docutils literal"><span class="pre">USER_NAME</span></tt></dt>
<dd>The user name for the user for which a key is added.</dd>
</dl>
</div>
<div class="section" id="delete-client-key">
<h4>delete-client-key<a class="headerlink" href="#delete-client-key" title="Permalink to this headline"></a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">delete-client-key</span></tt> subcommand to delete a client key.</p>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl delete-client-key ORG_NAME CLIENT_NAME KEY_NAME
</pre></div>
</div>
<p><strong>Options</strong></p>
<p>This subcommand has the following arguments:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">ORG_NAME</span></tt></dt>
<dd>The short name for the organization to which the client belongs.</dd>
<dt><tt class="docutils literal"><span class="pre">CLIENT_NAME</span></tt></dt>
<dd>The name of the client.</dd>
<dt><tt class="docutils literal"><span class="pre">KEY_NAME</span></tt></dt>
<dd>The unique name to be assigned to the key you wish to delete.</dd>
</dl>
</div>
<div class="section" id="delete-user-key">
<h4>delete-user-key<a class="headerlink" href="#delete-user-key" title="Permalink to this headline"></a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">delete-user-key</span></tt> subcommand to delete a user key.</p>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl delete-user-key USER_NAME KEY_NAME
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The parameters for this subcommand must be in the order specified above.</p>
</div>
<p><strong>Options</strong></p>
<p>This subcommand has the following arguments:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">USER_NAME</span></tt></dt>
<dd>The user name.</dd>
<dt><tt class="docutils literal"><span class="pre">KEY_NAME</span></tt></dt>
<dd>The unique name to be assigned to the key you wish to delete.</dd>
</dl>
</div>
<div class="section" id="list-client-key">
<h4>list-client-key<a class="headerlink" href="#list-client-key" title="Permalink to this headline"></a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">list-client-keys</span></tt> subcommand to list client keys.</p>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl list-client-keys ORG_NAME CLIENT_NAME <span class="o">[</span>--verbose<span class="o">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">All options for this subcommand must follow all arguments.</p>
</div>
<p><strong>Options</strong></p>
<p>This subcommand has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">CLIENT_NAME</span></tt></dt>
<dd>The name of the client.</dd>
<dt><tt class="docutils literal"><span class="pre">ORG_NAME</span></tt></dt>
<dd>The short name for the organization to which the client belongs.</dd>
<dt><tt class="docutils literal"><span class="pre">--verbose</span></tt></dt>
<dd>Use to show the full public key strings in command output.</dd>
</dl>
</div>
<div class="section" id="list-user-key">
<h4>list-user-key<a class="headerlink" href="#list-user-key" title="Permalink to this headline"></a></h4>
<p>Use the <tt class="docutils literal"><span class="pre">list-user-keys</span></tt> subcommand to list client keys.</p>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl list-user-keys USER_NAME <span class="o">[</span>--verbose<span class="o">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">All options for this subcommand must follow all arguments.</p>
</div>
<p><strong>Options</strong></p>
<p>This subcommand has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">USER_NAME</span></tt></dt>
<dd>The user name you wish to list keys for.</dd>
<dt><tt class="docutils literal"><span class="pre">--verbose</span></tt></dt>
<dd>Use to show the full public key strings in command output.</dd>
</dl>
<p><strong>Example</strong></p>
<p>To view a list of user keys (including public key output):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl list-user-keys applejack --verbose
</pre></div>
</div>
<p>Returns:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="m">2</span> total key<span class="o">(</span>s<span class="o">)</span> found <span class="k">for</span> user applejack

key_name: test-key
expires_at: Infinity
public_key:
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4q9Dh+bwJSjhU/VI4Y8s
9WsbIPfpmBpoZoZVPL7V6JDfIaPUkdcSdZpynhRLhQwv9ScTFh65JwxC7wNhVspB
4bKZeW6vugNGwCyBIemMfxMlpKZQDOc5dnBiRMMOgXSIimeiFtL+NmMXnGBBHDaE
b+XXI8oCZRx5MTnzEs90mkaCRSIUlWxOUFzZvnv4jBrhWsd/yBM/h7YmVfmwVAjL
VST0QG4MnbCjNtbzToMj55NAGwSdKHCzvvpWYkd62ZOquY9f2UZKxYCX0bFPNVQM
EvBQGdNG39XYSEeF4LneYQKPHEZDdqe7TZdVE8ooU/syxlZgADtvkqEoc4zp1Im3
2wIDAQAB
-----END PUBLIC KEY-----

key_name: default
expires_at: Infinity
public_key:
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4q9Dh+bwJSjhU/VI4Y8s
9WsbIPfpmBpoZoZVPL7V6JDfIaPUkdcSdZpynhRLhQwv9ScTFh65JwxC7wNhVspB
4bKZeW6vugNGwCyBIemMfxMlpKZQDOc5dnBiRMMOgXSIimeiFtL+NmMXnGBBHDaE
b+XXI8oCZRx5MTnzEs90mkaCRSIUlWxOUFzZvnv4jBrhWsd/yBM/h7YmVfmwVAjL
VST0QG4MnbCjNtbzToMj55NAGwSdKHCzvvpWYkd62ZOquY9f2UZKxYCX0bFPNVQM
EvBQGdNG39XYSEeF4LneYQKPHEZDdqe7TZdVE8ooU/syxlZgADtvkqEoc4zp1Im3
2wIDAQAB
-----END PUBLIC KEY-----
</pre></div>
</div>
</div>
</div>
<div class="section" id="chef-client-settings">
<h3>chef-client Settings<a class="headerlink" href="#chef-client-settings" title="Permalink to this headline"></a></h3>
<p>Use following client.rb settings to manage SSL certificate preferences:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">local_key_generation</span></tt></td>
<td>Whether the Chef server or chef-client generates the private/public key pair. When <tt class="docutils literal"><span class="pre">true</span></tt>, the chef-client generates the key pair, and then sends the public key to the Chef server. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ssl_ca_file</span></tt></td>
<td>The file in which the OpenSSL key is saved. This setting is generated automatically by the chef-client and most users do not need to modify it.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ssl_ca_path</span></tt></td>
<td>The path to where the OpenSSL key is located. This setting is generated automatically by the chef-client and most users do not need to modify it.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ssl_client_cert</span></tt></td>
<td>The OpenSSL X.509 certificate used for mutual certificate validation. This setting is only necessary when mutual certificate validation is configured on the Chef server. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ssl_client_key</span></tt></td>
<td>The OpenSSL X.509 key used for mutual certificate validation. This setting is only necessary when mutual certificate validation is configured on the Chef server. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ssl_verify_mode</span></tt></td>
<td><p class="first">Set the verify mode for HTTPS requests.</p>
<ul class="simple">
<li>Use <tt class="docutils literal"><span class="pre">:verify_none</span></tt> to do no validation of SSL certificates.</li>
<li>Use <tt class="docutils literal"><span class="pre">:verify_peer</span></tt> to do validation of all SSL certificates, including the Chef server connections, S3 connections, and any HTTPS <strong>remote_file</strong> resource URLs used in the chef-client run. This is the recommended setting.</li>
</ul>
<p class="last">Depending on how OpenSSL is configured, the <tt class="docutils literal"><span class="pre">ssl_ca_path</span></tt> may need to be specified. Default value: <tt class="docutils literal"><span class="pre">:verify_peer</span></tt>.</p>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">verify_api_cert</span></tt></td>
<td>Verify the SSL certificate on the Chef server. When <tt class="docutils literal"><span class="pre">true</span></tt>, the chef-client always verifies the SSL certificate. When <tt class="docutils literal"><span class="pre">false</span></tt>, the chef-client uses the value of <tt class="docutils literal"><span class="pre">ssl_verify_mode</span></tt> to determine if the SSL certificate requires verification. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="server-tuning">
<h2>Server Tuning<a class="headerlink" href="#server-tuning" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_tuning.rst">[edit on GitHub]</a></p>
<p>The server configuration file contains a list of all configuration options that are available for the Chef server. Some of these values should be modified for large-scale installations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This topic contains general information about how settings can be tuned. In many cases, this topic suggests specific values to be used for tuning. That said, every organization and configuration is different, so please don&#8217;t hesitate to contact Chef support to discuss your tuning effort so as to help ensure the right value is identified for any particular setting.</p>
</div>
<div class="section" id="customize-the-config-file">
<h3>Customize the Config File<a class="headerlink" href="#customize-the-config-file" title="Permalink to this headline"></a></h3>
<p>The chef-server.rb file contains all of the non-default configuration settings used by the Chef server. (The default settings are built-in to the Chef server configuration and should only be added to the chef-server.rb file to apply non-default values.) These configuration settings are processed when the <tt class="docutils literal"><span class="pre">chef-server-ctl</span> <span class="pre">reconfigure</span></tt> command is run, such as immediately after setting up the Chef server or after making a change to the underlying configuration settings after the server has been deployed. The chef-server.rb file is a Ruby file, which means that conditional statements can be used in the configuration file.</p>
<div class="section" id="use-conditions">
<h4>Use Conditions<a class="headerlink" href="#use-conditions" title="Permalink to this headline"></a></h4>
<p>Use a <tt class="docutils literal"><span class="pre">case</span></tt> statement to apply different values based on whether the setting exists on the front-end or back-end servers. Add code to the server configuration file similar to the following:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">role_name</span> <span class="o">=</span> <span class="no">ChefServer</span><span class="o">[</span><span class="s2">&quot;servers&quot;</span><span class="o">][</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;fqdn&#39;</span><span class="o">]][</span><span class="s2">&quot;role&quot;</span><span class="o">]</span>
<span class="k">case</span> <span class="n">role_name</span>
<span class="k">when</span> <span class="s2">&quot;backend&quot;</span>
  <span class="c1"># backend-specific configuration here</span>
<span class="k">when</span> <span class="s2">&quot;frontend&quot;</span>
  <span class="c1"># frontend-specific configuration here</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="recommended-settings">
<h3>Recommended Settings<a class="headerlink" href="#recommended-settings" title="Permalink to this headline"></a></h3>
<p>The following settings are typically added to the server configuration file (no equal sign is necessary to set the value):</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">api_fqdn</span></tt></dt>
<dd>The FQDN for the Chef server. This setting is not in the server configuration file by default. When added, its value should be equal to the FQDN for the service URI used by the Chef server. For example: <tt class="docutils literal"><span class="pre">api_fqdn</span> <span class="pre">&quot;chef.example.com&quot;</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">bootstrap</span></tt></dt>
<dd>Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">ip_version</span></tt></dt>
<dd>Use to set the IP version: <tt class="docutils literal"><span class="pre">&quot;ipv4&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;ipv6&quot;</span></tt>. When set to <tt class="docutils literal"><span class="pre">&quot;ipv6&quot;</span></tt>, the API listens on IPv6 and front end and back end services communicate via IPv6 when a high availability configuration is used. When configuring for IPv6 in a high availability configuration, be sure to set the netmask on the IPv6 <tt class="docutils literal"><span class="pre">backend_vip</span></tt> attribute. Default value: <tt class="docutils literal"><span class="pre">&quot;ipv4&quot;</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">notification_email</span></tt></dt>
<dd>Default value: <tt class="docutils literal"><span class="pre">info&#64;example.com</span></tt>.</dd>
</dl>
<div class="section" id="id84">
<h4>SSL Protocols<a class="headerlink" href="#id84" title="Permalink to this headline"></a></h4>
<p>The following settings are often modified from the default as part of the tuning effort for the <strong>nginx</strong> service and to configure the Chef server to use SSL certificates:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_certificate']</span></tt></dt>
<dd>The SSL certificate used to verify communication over HTTPS. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_certificate_key']</span></tt></dt>
<dd>The certificate key used for SSL communication. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_ciphers']</span></tt></dt>
<dd><p class="first">The list of supported cipher suites that are used to establish a secure connection. To favor AES256 with ECDHE forward security, drop the <tt class="docutils literal"><span class="pre">RC4-SHA:RC4-MD5:RC4:RSA</span></tt> prefix. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_ciphers&#39;</span><span class="o">]</span> <span class="o">=</span>  <span class="s2">&quot;HIGH:MEDIUM:!LOW:!kEDH: \</span>
<span class="s2">                         !aNULL:!ADH:!eNULL:!EXP: \</span>
<span class="s2">                         !SSLv2:!SEED:!CAMELLIA: \</span>
<span class="s2">                         !PSK&quot;</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">nginx['ssl_protocols']</span></tt></dt>
<dd><p class="first">The SSL protocol versions that are enabled. SSL 3.0 is supported by the Chef server; however, SSL 3.0 is an obsolete and insecure protocol. Transport Layer Security (TLS)&#8212;TLS 1.0, TLS 1.1, and TLS 1.2&#8212;has effectively replaced SSL 3.0, which provides for authenticated version negotiation between the chef-client and Chef server, which ensures the latest version of the TLS protocol is used. For the highest possible security, it is recommended to disable SSL 3.0 and allow all versions of the TLS protocol.  For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_protocols&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;TLSv1 TLSv1.1 TLSv1.2&quot;</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference external" href="https://wiki.mozilla.org/Security/Server_Side_TLS">https://wiki.mozilla.org/Security/Server_Side_TLS</a> for more information about the values used with the <tt class="docutils literal"><span class="pre">nginx['ssl_ciphers']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_protocols']</span></tt> settings.</p>
</div>
<p>For example, after copying the SSL certificate files to the Chef server, update the <tt class="docutils literal"><span class="pre">nginx['ssl_certificate']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_certificate_key']</span></tt> settings to specify the paths to those files, and then (optionally) update the <tt class="docutils literal"><span class="pre">nginx['ssl_ciphers']</span></tt> and <tt class="docutils literal"><span class="pre">nginx['ssl_protocols']</span></tt> settings to reflect the desired level of hardness for the Chef server:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_certificate&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/private/name.of.pem&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_certificate_key&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/pki/tls/private/name.of.key&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_ciphers&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK&quot;</span>
<span class="n">nginx</span><span class="o">[</span><span class="s1">&#39;ssl_protocols&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;TLSv1 TLSv1.1 TLSv1.2&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="optional-services-tuning">
<h3>Optional Services Tuning<a class="headerlink" href="#optional-services-tuning" title="Permalink to this headline"></a></h3>
<p>The following settings are often used to for performance tuning of the Chef server in larger installations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When changes are made to the chef-server.rb file the Chef server must be reconfigured by running the following command:</p>
<div class="last highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl reconfigure
</pre></div>
</div>
</div>
<div class="section" id="id85">
<h4>bookshelf<a class="headerlink" href="#id85" title="Permalink to this headline"></a></h4>
<p>The following setting is often modified from the default as part of the tuning effort for the <strong>bookshelf</strong> service:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">bookshelf['vip']</span></tt></dt>
<dd>The virtual IP address. Default value: <tt class="docutils literal"><span class="pre">node['fqdn']</span></tt>.</dd>
</dl>
</div>
<div class="section" id="id86">
<h4>opscode-erchef<a class="headerlink" href="#id86" title="Permalink to this headline"></a></h4>
<p>The following settings are often modified from the default as part of the tuning effort for the <strong>opscode-erchef</strong> service:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">opscode_erchef['db_pool_size']</span></tt></dt>
<dd>The number of open connections to PostgreSQL that are maintained by the service. If failures indicate that the <strong>opscode-erchef</strong> service ran out of connections, try increasing the <tt class="docutils literal"><span class="pre">postgresql['max_connections']</span></tt> setting. If failures persist, then increase this value (in small increments) and also increase the value for <tt class="docutils literal"><span class="pre">postgresql['max_connections']</span></tt>. Default value: <tt class="docutils literal"><span class="pre">20</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">opscode_erchef['s3_url_ttl']</span></tt></dt>
<dd>The amount of time (in seconds) before connections to the server expire. If chef-client runs are timing out, increase this setting to <tt class="docutils literal"><span class="pre">3600</span></tt>, and then adjust again if necessary. Default value: <tt class="docutils literal"><span class="pre">900</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">opscode_erchef['strict_search_result_acls']</span></tt></dt>
<dd><p class="first">Use to specify that search results only return objects to which an actor (user, client, etc.) has read access, as determined by ACL settings. This affects all searches. When <tt class="docutils literal"><span class="pre">true</span></tt>, the performance of the Chef management console may increase because it enables the Chef management console to skip redundant ACL checks. To ensure the Chef management console is configured properly, after this setting has been applied with a <tt class="docutils literal"><span class="pre">chef-server-ctl</span> <span class="pre">reconfigure</span></tt> run <tt class="docutils literal"><span class="pre">chef-manage-ctl</span> <span class="pre">reconfigure</span></tt> to ensure the Chef management console also picks up the setting. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When <tt class="docutils literal"><span class="pre">true</span></tt>, <tt class="docutils literal"><span class="pre">opscode_erchef['strict_search_result_acls']</span></tt> affects all search results and any actor (user, client, etc.) that does not have read access to a search result will not be able to view it. For example, this could affect search results returned during chef-client runs if a chef-client does not have permission to read the information.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="id87">
<h4>opscode-expander<a class="headerlink" href="#id87" title="Permalink to this headline"></a></h4>
<p>The following setting is often modified from the default as part of the tuning effort for the <strong>opscode-expander</strong> service:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">opscode_expander['nodes']</span></tt></dt>
<dd>The number of allowed worker processes. The <strong>opscode-expander</strong> service runs on the back-end and feeds data to the <strong>opscode-solr</strong> service, which creates and maintains search data used by the Chef server. Additional memory may be required by these worker processes depending on the frequency and volume of chef-client runs across the organization, but only if the back-end machines have available CPU and RAM. Default value: <tt class="docutils literal"><span class="pre">2</span></tt>.</dd>
</dl>
</div>
<div class="section" id="id88">
<h4>opscode-solr4<a class="headerlink" href="#id88" title="Permalink to this headline"></a></h4>
<p>The following sections describe ways of tuning the <strong>opscode-solr4</strong> service to improve performance around large node sizes, available memory, and update frequencies.</p>
<div class="section" id="available-memory">
<h5>Available Memory<a class="headerlink" href="#available-memory" title="Permalink to this headline"></a></h5>
<p>Use the following configuration setting to help ensure that Apache Solr does not run out of memory:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">opscode_solr4['heap_size']</span></tt></dt>
<dd>The amount of memory (in MBs) available to Apache Solr. If there is not enough memory available, search queries made by nodes to Apache Solr may fail. The amount of memory that must be available also depends on the number of nodes in the organization, the frequency of search queries, and other characteristics that are unique to each organization. In general, as the number of nodes increases, so does the amount of memory.</dd>
</dl>
<p>If Apache Solr is running out of memory, the <tt class="docutils literal"><span class="pre">/var/log/opscode/opscode-solr4/current</span></tt> log file will contain a message similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>SEVERE: java.lang.OutOfMemoryError: Java heap space
</pre></div>
</div>
<p>The default value for <tt class="docutils literal"><span class="pre">opscode_solr4['heap_size']</span></tt> should work for many organizations, especially those with fewer than 25 nodes. For organizations with more than 25 nodes, set this value to 25% of system memory or <tt class="docutils literal"><span class="pre">1024</span></tt>, whichever is smaller. For very large configurations, increase this value to 25% of system memory or <tt class="docutils literal"><span class="pre">4096</span></tt>, whichever is smaller. This value should not exceed <tt class="docutils literal"><span class="pre">8192</span></tt>.</p>
</div>
<div class="section" id="large-node-sizes">
<h5>Large Node Sizes<a class="headerlink" href="#large-node-sizes" title="Permalink to this headline"></a></h5>
<p>The maximum field length setting for Apache Solr should be greater than any expected node object file sizes in order for them to be successfully added to the search index. If a node object file is greater than the maximum field length, the node object will be indexed up to the maximum, but the part of the file past that limit will not be indexed. If this occurs, it will seem as if nodes disappear from the search index. To ensure that large node file sizes are indexed properly, verify the following configuration settings:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nginx['client_max_body_size']</span></tt></dt>
<dd>The maximum accepted body size for a client request, as indicated by the <tt class="docutils literal"><span class="pre">Content-Length</span></tt> request header. When the maximum accepted body size is greater than this value, a <tt class="docutils literal"><span class="pre">413</span> <span class="pre">Request</span> <span class="pre">Entity</span> <span class="pre">Too</span> <span class="pre">Large</span></tt> error is returned. Default value: <tt class="docutils literal"><span class="pre">250m</span></tt>.</dd>
</dl>
<p>and</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">opscode-erchef']['max_request_size']</span></tt></dt>
<dd>Default value: <tt class="docutils literal"><span class="pre">1000000</span></tt>.</dd>
</dl>
<p>to ensure that those settings are not part of the reasons for incomplete indexing, and then update the following setting so that its value is greater than the expected node file sizes:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">opscode_solr4['max_field_length']</span></tt></dt>
<dd>The maximum field length (in number of tokens/terms). If a field length exceeds this value, Apache Solr may not be able to complete building the index. Default value: <tt class="docutils literal"><span class="pre">100000</span></tt> (increased from the Apache Solr default value of <tt class="docutils literal"><span class="pre">10000</span></tt>).</dd>
</dl>
<p>Use the <tt class="docutils literal"><span class="pre">wc</span></tt> command to get the character count of a large node object file. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ wc -w NODE_NAME.json
</pre></div>
</div>
<p>and then ensure there is a buffer beyond that value. For example, verify the size of the largest node object file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ wc -w nodebsp2016.json
</pre></div>
</div>
<p>which returns <tt class="docutils literal"><span class="pre">154516</span></tt>. Update the <tt class="docutils literal"><span class="pre">opscode_solr4['max_field_length']</span></tt> setting to have a value greater than the returned value. For example: <tt class="docutils literal"><span class="pre">180000</span></tt>.</p>
</div>
<div class="section" id="update-frequency">
<h5>Update Frequency<a class="headerlink" href="#update-frequency" title="Permalink to this headline"></a></h5>
<p>At the end of every chef-client run, the node object is saved to the Chef server. From the Chef server, each node object is then added to the <tt class="docutils literal"><span class="pre">SOLR</span></tt> search index. This process is asynchronous. By default, node objects are committed to the search index every 60 seconds or per 1000 node objects, whichever occurs first.</p>
<p>When data is committed to the Apache Solr index, all incoming updates are blocked. If the duration between updates is too short, it is possible for the rate at which updates are asked to occur to be faster than the rate at which objects can be actually committed.</p>
<p>Use the following configuration setting to improve the indexing performance of node objects:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">opscode_solr4['commit_interval']</span></tt></dt>
<dd>The frequency (in seconds) at which node objects are added to the Apache Solr search index. Default value: <tt class="docutils literal"><span class="pre">60000</span></tt> (every 60 seconds).</dd>
<dt><tt class="docutils literal"><span class="pre">opscode_solr4['max_commit_docs']</span></tt></dt>
<dd>The frequency (in documents) at which node objects are added to the Apache Solr search index. Default value: <tt class="docutils literal"><span class="pre">1000</span></tt> (every 1000 documents).</dd>
</dl>
</div>
</div>
<div class="section" id="id89">
<h4>postgresql<a class="headerlink" href="#id89" title="Permalink to this headline"></a></h4>
<p>The following setting is often modified from the default as part of the tuning effort for the <strong>postgresql</strong> service:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">postgresql['max_connections']</span></tt></dt>
<dd><p class="first">The maximum number of allowed concurrent connections. This value should only be tuned when the <tt class="docutils literal"><span class="pre">opscode_erchef['db_pool_size']</span></tt> value used by the <strong>opscode-erchef</strong> service is modified. Default value: <tt class="docutils literal"><span class="pre">350</span></tt>.</p>
<p>If there are more than two front end machines in a cluster, the <tt class="docutils literal"><span class="pre">postgresql['max_connections']</span></tt> setting should be increased. The increased value depends on the number of machines in the front end, but also the number of services that are running on each of these machines.</p>
<ul class="simple">
<li>Each front end machine always runs the <strong>oc_bifrost</strong> and <strong>opscode-erchef</strong> services.</li>
<li>The Reporting add-on adds the <strong>reporting</strong> service.</li>
<li>The Chef push jobs service adds the <strong>push_jobs</strong> service.</li>
</ul>
<p>Each of these services requires 25 connections, above the default value.</p>
<p>Use the following formula to help determine what the increased value should be:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">new_value</span> <span class="o">=</span> <span class="n">current_value</span> <span class="o">+</span> <span class="o">[</span>
            <span class="p">(</span><span class="c1"># of front end machines - 2) * (25 * # of services)</span>
                     <span class="o">]</span>
</pre></div>
</div>
<p>For example, if the current value is 350, there are four front end machines, and all add-ons are installed, then the formula looks like:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span></span><span class="mi">550</span> <span class="o">=</span> <span class="mi">350</span> <span class="o">+</span> <span class="o">[</span><span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">25</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">]</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="id90">
<h4>rabbitmq<a class="headerlink" href="#id90" title="Permalink to this headline"></a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Chef Analytics has been replaced by Chef Automate.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Chef Analytics has been replaced by Chef Automate.</p>
</div>
<p>The following settings must be modified when the Chef Analytics server is configured as a standalone server:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">rabbitmq['node_ip_address']</span></tt></dt>
<dd><p class="first">The bind IP address for RabbitMQ. Default value: <tt class="docutils literal"><span class="pre">&quot;127.0.0.1&quot;</span></tt>.</p>
<p class="last">Chef Analytics uses the same RabbitMQ service that is configured on the Chef server. When the Chef Analytics server is configured as a standalone server, the default settings for <tt class="docutils literal"><span class="pre">rabbitmq['node_ip_address']</span></tt> and <tt class="docutils literal"><span class="pre">rabbitmq['vip']</span></tt> must be updated. When the Chef Analytics server is configured as a standalone server, change this value to <tt class="docutils literal"><span class="pre">0.0.0.0</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['vip']</span></tt></dt>
<dd><p class="first">The virtual IP address. Default value: <tt class="docutils literal"><span class="pre">&quot;127.0.0.1&quot;</span></tt>.</p>
<p class="last">Chef Analytics uses the same RabbitMQ service that is configured on the Chef server. When the Chef Analytics server is configured as a standalone server, the default settings for <tt class="docutils literal"><span class="pre">rabbitmq['node_ip_address']</span></tt> and <tt class="docutils literal"><span class="pre">rabbitmq['vip']</span></tt> must be updated. When the Chef Analytics server is configured as a standalone server, change this value to the backend VIP address for the Chef server.</p>
</dd>
</dl>
<div class="section" id="analytics-queues">
<h5>Analytics Queues<a class="headerlink" href="#analytics-queues" title="Permalink to this headline"></a></h5>
<p>If the RabbitMQ queue that is used by Chef Analytics stops consuming messages, the Chef server data partition will fill up and may affect the overall performance of the Chef server application itself. The settings for the RabbitMQ queue are tunable, including for queue length monitoring, queue capacity, maximum number of messages that can be in the queue before messages are dropped, the point at which messages are dropped, for settings used by the rabbitmq-management plugin, and so on.</p>
<p>The following settings may be used for tuning RabbitMQ queues used by Chef Analytics and the Chef server:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">rabbitmq['analytics_max_length']</span></tt></dt>
<dd>The maximum number of messages that can be queued before RabbitMQ automatically drops messages from the front of the queue to make room for new messages. Default value: <tt class="docutils literal"><span class="pre">10000</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['drop_on_full_capacity']</span></tt></dt>
<dd>Specify if messages will stop being sent to the RabbitMQ queue when it is at capacity. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['management_enabled']</span></tt></dt>
<dd>Specify if the rabbitmq-management plugin is enabled. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['management_password']</span></tt></dt>
<dd>The rabbitmq-management plugin password. Default value: <tt class="docutils literal"><span class="pre">'chefrocks'</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['management_port']</span></tt></dt>
<dd>The rabbitmq-management plugin port. Default value: <tt class="docutils literal"><span class="pre">15672</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['management_user']</span></tt></dt>
<dd>The rabbitmq-management plugin user. Default value: <tt class="docutils literal"><span class="pre">'rabbitmgmt'</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['prevent_erchef_startup_on_full_capacity']</span></tt></dt>
<dd>Specify if the Chef server will start when the monitored RabbitMQ queue is full. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['queue_at_capacity_affects_overall_status']</span></tt></dt>
<dd>Specify if the <tt class="docutils literal"><span class="pre">_status</span></tt> endpoint in the Chef server API will fail if the monitored queue is at capacity. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['queue_length_monitor_enabled']</span></tt></dt>
<dd>Specify if the queue length monitor is enabled. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['queue_length_monitor_millis']</span></tt></dt>
<dd>The frequency (in milliseconds) at which the length of the RabbitMQ queue is checked. Default value: <tt class="docutils literal"><span class="pre">30000</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['queue_length_monitor_timeout_millis']</span></tt></dt>
<dd>The timeout (in milliseconds) at which calls to the queue length monitor will stop if the Chef server is overloaded. Default value: <tt class="docutils literal"><span class="pre">5000</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['queue_length_monitor_queue']</span></tt></dt>
<dd>The RabbitMQ queue that is observed by queue length monitor. Default value: <tt class="docutils literal"><span class="pre">'alaska'</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['queue_length_monitor_vhost']</span></tt></dt>
<dd>The virtual host for the RabbitMQ queue that is observed by queue length monitor. Default value: <tt class="docutils literal"><span class="pre">'/analytics'</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_http_cull_interval']</span></tt></dt>
<dd>The maximum cull interval (in seconds) for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">60</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_http_init_count']</span></tt></dt>
<dd>The initial worker count for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">25</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_http_max_age']</span></tt></dt>
<dd>The maximum connection worker age (in seconds) for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">70</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_http_max_connection_duration']</span></tt></dt>
<dd>The maximum connection duration (in seconds) for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">70</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_http_max_count']</span></tt></dt>
<dd>The maximum worker count for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">100</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_ibrowse_options']</span></tt></dt>
<dd>An array of comma-separated key-value pairs of ibrowse options for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">'{connect_timeout,</span> <span class="pre">10000}'</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['rabbit_mgmt_timeout']</span></tt></dt>
<dd>The timeout for the HTTP connection pool that is used by the rabbitmq-management plugin. Default value: <tt class="docutils literal"><span class="pre">30000</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">rabbitmq['ssl_versions']</span></tt></dt>
<dd>The SSL versions used by the rabbitmq-management plugin. (See also <a class="reference external" href="https://www.rabbitmq.com/ssl.html">https://www.rabbitmq.com/ssl.html</a>.) Default value: <tt class="docutils literal"><span class="pre">['tlsv1.2',</span> <span class="pre">'tlsv1.1']</span></tt>.</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="section" id="backup-and-restore">
<h2>Backup and Restore<a class="headerlink" href="#backup-and-restore" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/chef/chef-web-docs/blob/master/chef_master/source/server_backup_restore.rst">[edit on GitHub]</a></p>
<p>Periodic backups of Chef server data are an essential part of managing and maintaining a healthy configuration and to help ensure that important data can be restored, if required.</p>
<div class="section" id="id91">
<h3>High Availability<a class="headerlink" href="#id91" title="Permalink to this headline"></a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section only applies to the Enterprise Chef server, version 11.x.</p>
</div>
<p>To configure backups on the backend servers in a high availability configuration, set a cron job in <tt class="docutils literal"><span class="pre">/etc/cron.d/opc_snapshot</span></tt> similar to the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Add to /etc/cron.d/opc_snapshot, and then remove comment below MAILTO to activate the cron job</span>
<span class="nv">SHELL</span><span class="o">=</span>/bin/bash
<span class="nv">HOME</span><span class="o">=</span>/opt/opscode/bin
<span class="nv">PATH</span><span class="o">=</span>/usr/bin:/usr/sbin:/bin:/opt/opscode/embedded/bin:/opt/opscode/bin
<span class="nv">MAILTO</span><span class="o">=</span>SOMEONE@payingattention
<span class="c1">#17 23 * * * root drbd-backups -g opscode -l drbd &gt; /dev/null 2&gt;&amp;1</span>
</pre></div>
</div>
<p>A cron job similar to the previous example will mount a new snapshot logical volume named:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>/dev/opscode/backup-{+%Y-%m-%d-%H-%M-%S}
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">{+%Y-%m-%d-%H-%M-%S}</span></tt> is a format string for year, month, day, so on.</p>
<p>After the cron job has run successfully, the <tt class="docutils literal"><span class="pre">mount</span></tt> command will show the new logical volume mounted on the <tt class="docutils literal"><span class="pre">/var/opt/opscode/drbd-backups</span></tt> mount point. The backup script will create a snapshot logical volume in unused space in the <tt class="docutils literal"><span class="pre">/opscode</span></tt> volume group. After the snapshot is created, the backup script will attempt to mount the snapshot logical volume, after which the snapshot will stay mounted for 24 hours. Upon the next cron job run, the backup script will attempt to unmount, destroy the snapshot, and then repeat the sequence.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">drbd-backups</span></tt> script with default settings requires at least 40 GB free space in the <tt class="docutils literal"><span class="pre">/opscode</span></tt> volume group on the backend servers.</p>
</div>
</div>
<div class="section" id="required-directories">
<h3>Required Directories<a class="headerlink" href="#required-directories" title="Permalink to this headline"></a></h3>
<p>Data stored in the following directories should be backed up periodically:</p>
<ul class="simple">
<li>/etc/opscode</li>
<li>/var/opt/opscode</li>
</ul>
<p>This data is also essential when any type of backup and restore operation is done for the Chef server.</p>
<div class="section" id="backup">
<h4>Backup<a class="headerlink" href="#backup" title="Permalink to this headline"></a></h4>
<p>When backing up Chef server data, be sure that the system is shut down (or otherwise quiet) at the time of the backup.
Perform all activities as root unless otherwise directed.</p>
<ol class="arabic">
<li><p class="first">Make a postgres export using the following commands:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">THEDATE</span><span class="o">=</span><span class="sb">`</span>date <span class="s1">&#39;+%Y-%m-%d-%H-%M-%S&#39;</span><span class="sb">`</span>
sudo -E -u opscode-pgsql bash
/opt/opscode/embedded/bin/pg_dumpall -c <span class="p">|</span> gzip --fast &gt; /tmp/postgresql-dump-<span class="nv">$THEDATE</span>.gz
Ctrl-d
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Synchronize to make sure that all of the data is present on-disk:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>sync
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Backup the /etc/opscode and /var/opt/opscode directories and include the postgres export file as root</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>tar cvfzp var-opt-opscode-<span class="nv">$THEDATE</span>.tar.gz /etc/opscode /var/opt/opscode /tmp/postgresql-dump-<span class="nv">$THEDATE</span>.gz
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="restore">
<h4>Restore<a class="headerlink" href="#restore" title="Permalink to this headline"></a></h4>
<p>When restoring Chef server data, the previously backed-up files will be required, along with the Chef server running only the <strong>postgresql</strong> service. Perform all activities as root unless otherwise directed.</p>
<ol class="arabic">
<li><p class="first">Stop the Chef server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl stop
</pre></div>
</div>
</li>
<li><p class="first">Restore the previously backed-up files to the following locations:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">/etc/opscode</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/var/opt/opscode</span></tt></li>
</ul>
<p>by using the following command, which will exclude PostgreSQL files:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>tar xvfzp var-opt-opscode-<span class="nv">$THEDATE</span>.tar.gz --exclude<span class="o">=</span><span class="s1">&#39;var/opt/opscode/drbd/data/postgresql_9.2&#39;</span> -C /
</pre></div>
</div>
</li>
<li><p class="first">Start the <strong>postgresql</strong> service:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start postgresql
</pre></div>
</div>
</li>
<li><p class="first">Restore the PostgreSQL database:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>su - opscode-pgsql
gunzip -c postgresql-dump-<span class="nv">$THEDATE</span>.gz <span class="p">|</span> /opt/opscode/embedded/bin/psql -U <span class="s2">&quot;opscode-pgsql&quot;</span> -d postgres
</pre></div>
</div>
<p>Ignore the following error messages:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ERROR:</span> <span class="pre">current</span> <span class="pre">user</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">dropped</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ERROR:</span> <span class="pre">role</span> <span class="pre">&quot;opscode-pgsql&quot;</span> <span class="pre">already</span> <span class="pre">exists</span></tt></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Reconfigure the Chef server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl reconfigure
</pre></div>
</div>
</li>
<li><p class="first">Start the Chef server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl start
</pre></div>
</div>
</li>
<li><p class="first">Reconfigure the Chef management console:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ opscode-manage-ctl reconfigure
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="chef-server-ctl">
<h3>chef-server-ctl<a class="headerlink" href="#chef-server-ctl" title="Permalink to this headline"></a></h3>
<p>Use the following commands to manage backups of Chef server data, and then to restore those backups.</p>
<div class="section" id="id92">
<h4>backup<a class="headerlink" href="#id92" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">backup</span></tt> subcommand is used to back up all Chef server data. This subcommand:</p>
<ul class="simple">
<li>Requires rsync to be installed on the Chef server prior to running the command</li>
<li>Requires a <tt class="docutils literal"><span class="pre">chef-server-ctl</span> <span class="pre">reconfigure</span></tt> prior to running the command</li>
<li>Should not be run in a Chef server configuration with an external PostgreSQL database; <a class="reference external" href="https://github.com/chef/knife-ec-backup">use knife ec backup</a> instead</li>
<li>Puts the initial backup in the <tt class="docutils literal"><span class="pre">/var/opt/chef-backup</span></tt> directory as a tar.gz file; move this backup to a new location for safe keeping</li>
</ul>
<p><strong>Options</strong></p>
<p>This subcommand has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-y</span></tt>, <tt class="docutils literal"><span class="pre">--yes</span></tt></dt>
<dd>Use to specify if the Chef server can go offline during tar.gz-based backups.</dd>
</dl>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl backup
</pre></div>
</div>
</div>
<div class="section" id="id93">
<h4>restore<a class="headerlink" href="#id93" title="Permalink to this headline"></a></h4>
<p>The <tt class="docutils literal"><span class="pre">restore</span></tt> subcommand is used to restore Chef server data from a backup that was created by the <tt class="docutils literal"><span class="pre">backup</span></tt> subcommand. This subcommand may also be used to add Chef server data to a newly-installed server. This subcommand:</p>
<ul class="simple">
<li>Requires rsync to be installed on the Chef server prior to running the command</li>
<li>Requires a <tt class="docutils literal"><span class="pre">chef-server-ctl</span> <span class="pre">reconfigure</span></tt> prior to running the command</li>
<li>Should not be run in a Chef server configuration with an external PostgreSQL database; <a class="reference external" href="https://github.com/chef/knife-ec-backup">use knife ec backup</a> instead</li>
<li>May restore backed up data to any version of the Chef server that supports this command, starting with Chef server 12.2 (which is the first version of the Chef server in which the <tt class="docutils literal"><span class="pre">chef-server-ctl</span> <span class="pre">restore</span></tt> command is available)</li>
</ul>
<p><strong>Options</strong></p>
<p>This subcommand has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-c</span></tt>, <tt class="docutils literal"><span class="pre">--cleanse</span></tt></dt>
<dd>Use to remove all existing data on the Chef server; it will be replaced by the data in the backup archive.</dd>
<dt><tt class="docutils literal"><span class="pre">-d</span> <span class="pre">DIRECTORY</span></tt>, <tt class="docutils literal"><span class="pre">--staging-dir</span> <span class="pre">DIRECTORY</span></tt></dt>
<dd>Use to specify that the path to an empty directory to be used during the restore process. This directory must have enough disk space to expand all data in the backup archive.</dd>
</dl>
<p><strong>Syntax</strong></p>
<p>This subcommand has the following syntax:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restore PATH_TO_BACKUP <span class="o">(</span>options<span class="o">)</span>
</pre></div>
</div>
<p><strong>Examples</strong></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ chef-server-ctl restore /path/to/tar/archive.tar.gz
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>


          <div class="footer" role="contentinfo">
                &copy; Copyright: This work is licensed under a Creative Commons Attribution 3.0 Unported License.
              This page is about: current version of Chef.
            <a href="/feedback.html">Provide feedback on Chef documentation</a>.
            </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6369228-7', 'auto', {'legacyCookieDomain': '.chef.io', 'allowLinker': true});
  ga('send', 'pageview');

  var trackOutboundLink = function(url) {
    if (ga.q) {
     document.location = url;
    } else {
      ga('send', 'event', 'outbound', 'click', url, {'hitCallback':
        function () {
          document.location = url;
        }
      });
    }
  };
</script>
<!-- End of Async Google Analytics Code -->

<!-- Start of Marketo Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Marketo Analytics Code -->

<!-- Start of DemandBase Analytics Code -->
<script type="text/javascript">
	(function(d,b,a,s,e){ var t = b.createElement(a),
		fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e;
		t.src=('https:'==document.location.protocol ? 'https://' : 'http://') + s;
		fs.parentNode.insertBefore(t, fs); })
	(window,document,'script','scripts.demandbase.com/zH7sZrWR.min.js','demandbase_js_lib');
</script>
<!-- End of DemandBase Analytics Code -->

<!-- Start of Segment Analytics Code -->
<script type="text/javascript">
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
  analytics.load("RtyoRfLf1ZETiJcIfkKND3Wq1K1LhYHx");
  analytics.page();
  }}();
</script>
<!-- End of Segment Analytics Code -->


        </div>
      </div>

      <div class="clearer"></div>
    </div>

  </div>
  </body>
</html>